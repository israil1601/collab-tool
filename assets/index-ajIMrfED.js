(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var de=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function LC(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var iw={exports:{}},Vc={},sw={exports:{}},pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sa=Symbol.for("react.element"),FC=Symbol.for("react.portal"),UC=Symbol.for("react.fragment"),zC=Symbol.for("react.strict_mode"),VC=Symbol.for("react.profiler"),jC=Symbol.for("react.provider"),HC=Symbol.for("react.context"),$C=Symbol.for("react.forward_ref"),WC=Symbol.for("react.suspense"),qC=Symbol.for("react.memo"),KC=Symbol.for("react.lazy"),Im=Symbol.iterator;function GC(t){return t===null||typeof t!="object"?null:(t=Im&&t[Im]||t["@@iterator"],typeof t=="function"?t:null)}var ow={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},lw=Object.assign,aw={};function Po(t,e,n){this.props=t,this.context=e,this.refs=aw,this.updater=n||ow}Po.prototype.isReactComponent={};Po.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Po.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function uw(){}uw.prototype=Po.prototype;function Bp(t,e,n){this.props=t,this.context=e,this.refs=aw,this.updater=n||ow}var Pp=Bp.prototype=new uw;Pp.constructor=Bp;lw(Pp,Po.prototype);Pp.isPureReactComponent=!0;var Om=Array.isArray,cw=Object.prototype.hasOwnProperty,Lp={current:null},fw={key:!0,ref:!0,__self:!0,__source:!0};function hw(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)cw.call(e,r)&&!fw.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var a=Array(l),u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Sa,type:t,key:s,ref:o,props:i,_owner:Lp.current}}function JC(t,e){return{$$typeof:Sa,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Fp(t){return typeof t=="object"&&t!==null&&t.$$typeof===Sa}function YC(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Rm=/\/+/g;function If(t,e){return typeof t=="object"&&t!==null&&t.key!=null?YC(""+t.key):e.toString(36)}function gu(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Sa:case FC:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+If(o,0):r,Om(i)?(n="",t!=null&&(n=t.replace(Rm,"$&/")+"/"),gu(i,e,n,"",function(u){return u})):i!=null&&(Fp(i)&&(i=JC(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Rm,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Om(t))for(var l=0;l<t.length;l++){s=t[l];var a=r+If(s,l);o+=gu(s,e,n,a,i)}else if(a=GC(t),typeof a=="function")for(t=a.call(t),l=0;!(s=t.next()).done;)s=s.value,a=r+If(s,l++),o+=gu(s,e,n,a,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function za(t,e,n){if(t==null)return t;var r=[],i=0;return gu(t,r,"","",function(s){return e.call(n,s,i++)}),r}function QC(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Wt={current:null},mu={transition:null},ZC={ReactCurrentDispatcher:Wt,ReactCurrentBatchConfig:mu,ReactCurrentOwner:Lp};pe.Children={map:za,forEach:function(t,e,n){za(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return za(t,function(){e++}),e},toArray:function(t){return za(t,function(e){return e})||[]},only:function(t){if(!Fp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};pe.Component=Po;pe.Fragment=UC;pe.Profiler=VC;pe.PureComponent=Bp;pe.StrictMode=zC;pe.Suspense=WC;pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ZC;pe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=lw({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Lp.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(a in e)cw.call(e,a)&&!fw.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){l=Array(a);for(var u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Sa,type:t.type,key:i,ref:s,props:r,_owner:o}};pe.createContext=function(t){return t={$$typeof:HC,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:jC,_context:t},t.Consumer=t};pe.createElement=hw;pe.createFactory=function(t){var e=hw.bind(null,t);return e.type=t,e};pe.createRef=function(){return{current:null}};pe.forwardRef=function(t){return{$$typeof:$C,render:t}};pe.isValidElement=Fp;pe.lazy=function(t){return{$$typeof:KC,_payload:{_status:-1,_result:t},_init:QC}};pe.memo=function(t,e){return{$$typeof:qC,type:t,compare:e===void 0?null:e}};pe.startTransition=function(t){var e=mu.transition;mu.transition={};try{t()}finally{mu.transition=e}};pe.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};pe.useCallback=function(t,e){return Wt.current.useCallback(t,e)};pe.useContext=function(t){return Wt.current.useContext(t)};pe.useDebugValue=function(){};pe.useDeferredValue=function(t){return Wt.current.useDeferredValue(t)};pe.useEffect=function(t,e){return Wt.current.useEffect(t,e)};pe.useId=function(){return Wt.current.useId()};pe.useImperativeHandle=function(t,e,n){return Wt.current.useImperativeHandle(t,e,n)};pe.useInsertionEffect=function(t,e){return Wt.current.useInsertionEffect(t,e)};pe.useLayoutEffect=function(t,e){return Wt.current.useLayoutEffect(t,e)};pe.useMemo=function(t,e){return Wt.current.useMemo(t,e)};pe.useReducer=function(t,e,n){return Wt.current.useReducer(t,e,n)};pe.useRef=function(t){return Wt.current.useRef(t)};pe.useState=function(t){return Wt.current.useState(t)};pe.useSyncExternalStore=function(t,e,n){return Wt.current.useSyncExternalStore(t,e,n)};pe.useTransition=function(){return Wt.current.useTransition()};pe.version="18.2.0";sw.exports=pe;var rs=sw.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XC=rs,eb=Symbol.for("react.element"),tb=Symbol.for("react.fragment"),nb=Object.prototype.hasOwnProperty,rb=XC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ib={key:!0,ref:!0,__self:!0,__source:!0};function dw(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)nb.call(e,r)&&!ib.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:eb,type:t,key:s,ref:o,props:i,_owner:rb.current}}Vc.Fragment=tb;Vc.jsx=dw;Vc.jsxs=dw;iw.exports=Vc;var Jt=iw.exports,Kh={},pw={exports:{}},yn={},gw={exports:{}},mw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(K,te){var re=K.length;K.push(te);e:for(;0<re;){var se=re-1>>>1,oe=K[se];if(0<i(oe,te))K[se]=te,K[re]=oe,re=se;else break e}}function n(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var te=K[0],re=K.pop();if(re!==te){K[0]=re;e:for(var se=0,oe=K.length,ht=oe>>>1;se<ht;){var kt=2*(se+1)-1,Sn=K[kt],D=kt+1,M=K[D];if(0>i(Sn,re))D<oe&&0>i(M,Sn)?(K[se]=M,K[D]=re,se=D):(K[se]=Sn,K[kt]=re,se=kt);else if(D<oe&&0>i(M,re))K[se]=M,K[D]=re,se=D;else break e}}return te}function i(K,te){var re=K.sortIndex-te.sortIndex;return re!==0?re:K.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var a=[],u=[],c=1,f=null,h=3,p=!1,m=!1,v=!1,C=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(K){for(var te=n(u);te!==null;){if(te.callback===null)r(u);else if(te.startTime<=K)r(u),te.sortIndex=te.expirationTime,e(a,te);else break;te=n(u)}}function O(K){if(v=!1,x(K),!m)if(n(a)!==null)m=!0,vt(R);else{var te=n(u);te!==null&&qe(O,te.startTime-K)}}function R(K,te){m=!1,v&&(v=!1,y(V),V=-1),p=!0;var re=h;try{for(x(te),f=n(a);f!==null&&(!(f.expirationTime>te)||K&&!ye());){var se=f.callback;if(typeof se=="function"){f.callback=null,h=f.priorityLevel;var oe=se(f.expirationTime<=te);te=t.unstable_now(),typeof oe=="function"?f.callback=oe:f===n(a)&&r(a),x(te)}else r(a);f=n(a)}if(f!==null)var ht=!0;else{var kt=n(u);kt!==null&&qe(O,kt.startTime-te),ht=!1}return ht}finally{f=null,h=re,p=!1}}var P=!1,F=null,V=-1,z=5,Q=-1;function ye(){return!(t.unstable_now()-Q<z)}function nt(){if(F!==null){var K=t.unstable_now();Q=K;var te=!0;try{te=F(!0,K)}finally{te?We():(P=!1,F=null)}}else P=!1}var We;if(typeof _=="function")We=function(){_(nt)};else if(typeof MessageChannel<"u"){var rt=new MessageChannel,Kt=rt.port2;rt.port1.onmessage=nt,We=function(){Kt.postMessage(null)}}else We=function(){C(nt,0)};function vt(K){F=K,P||(P=!0,We())}function qe(K,te){V=C(function(){K(t.unstable_now())},te)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(K){K.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,vt(R))},t.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<K?Math.floor(1e3/K):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(a)},t.unstable_next=function(K){switch(h){case 1:case 2:case 3:var te=3;break;default:te=h}var re=h;h=te;try{return K()}finally{h=re}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(K,te){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var re=h;h=K;try{return te()}finally{h=re}},t.unstable_scheduleCallback=function(K,te,re){var se=t.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?se+re:se):re=se,K){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=re+oe,K={id:c++,callback:te,priorityLevel:K,startTime:re,expirationTime:oe,sortIndex:-1},re>se?(K.sortIndex=re,e(u,K),n(a)===null&&K===n(u)&&(v?(y(V),V=-1):v=!0,qe(O,re-se))):(K.sortIndex=oe,e(a,K),m||p||(m=!0,vt(R))),K},t.unstable_shouldYield=ye,t.unstable_wrapCallback=function(K){var te=h;return function(){var re=h;h=te;try{return K.apply(this,arguments)}finally{h=re}}}})(mw);gw.exports=mw;var sb=gw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yw=rs,mn=sb;function q(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ww=new Set,Dl={};function Rs(t,e){ko(t,e),ko(t+"Capture",e)}function ko(t,e){for(Dl[t]=e,t=0;t<e.length;t++)ww.add(e[t])}var Ur=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gh=Object.prototype.hasOwnProperty,ob=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Am={},Nm={};function lb(t){return Gh.call(Nm,t)?!0:Gh.call(Am,t)?!1:ob.test(t)?Nm[t]=!0:(Am[t]=!0,!1)}function ab(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function ub(t,e,n,r){if(e===null||typeof e>"u"||ab(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function qt(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var St={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){St[t]=new qt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];St[e]=new qt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){St[t]=new qt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){St[t]=new qt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){St[t]=new qt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){St[t]=new qt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){St[t]=new qt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){St[t]=new qt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){St[t]=new qt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Up=/[\-:]([a-z])/g;function zp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Up,zp);St[e]=new qt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Up,zp);St[e]=new qt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Up,zp);St[e]=new qt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){St[t]=new qt(t,1,!1,t.toLowerCase(),null,!1,!1)});St.xlinkHref=new qt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){St[t]=new qt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Vp(t,e,n,r){var i=St.hasOwnProperty(e)?St[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(ub(e,n,i,r)&&(n=null),r||i===null?lb(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var qr=yw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Va=Symbol.for("react.element"),$s=Symbol.for("react.portal"),Ws=Symbol.for("react.fragment"),jp=Symbol.for("react.strict_mode"),Jh=Symbol.for("react.profiler"),Sw=Symbol.for("react.provider"),vw=Symbol.for("react.context"),Hp=Symbol.for("react.forward_ref"),Yh=Symbol.for("react.suspense"),Qh=Symbol.for("react.suspense_list"),$p=Symbol.for("react.memo"),ei=Symbol.for("react.lazy"),kw=Symbol.for("react.offscreen"),Mm=Symbol.iterator;function Go(t){return t===null||typeof t!="object"?null:(t=Mm&&t[Mm]||t["@@iterator"],typeof t=="function"?t:null)}var je=Object.assign,Of;function il(t){if(Of===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Of=e&&e[1]||""}return`
`+Of+t}var Rf=!1;function Af(t,e){if(!t||Rf)return"";Rf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var a=`
`+i[o].replace(" at new "," at ");return t.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",t.displayName)),a}while(1<=o&&0<=l);break}}}finally{Rf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?il(t):""}function cb(t){switch(t.tag){case 5:return il(t.type);case 16:return il("Lazy");case 13:return il("Suspense");case 19:return il("SuspenseList");case 0:case 2:case 15:return t=Af(t.type,!1),t;case 11:return t=Af(t.type.render,!1),t;case 1:return t=Af(t.type,!0),t;default:return""}}function Zh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ws:return"Fragment";case $s:return"Portal";case Jh:return"Profiler";case jp:return"StrictMode";case Yh:return"Suspense";case Qh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case vw:return(t.displayName||"Context")+".Consumer";case Sw:return(t._context.displayName||"Context")+".Provider";case Hp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case $p:return e=t.displayName||null,e!==null?e:Zh(t.type)||"Memo";case ei:e=t._payload,t=t._init;try{return Zh(t(e))}catch{}}return null}function fb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Zh(e);case 8:return e===jp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ii(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function _w(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function hb(t){var e=_w(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ja(t){t._valueTracker||(t._valueTracker=hb(t))}function Ew(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=_w(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Uu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Xh(t,e){var n=e.checked;return je({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Dm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ii(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Cw(t,e){e=e.checked,e!=null&&Vp(t,"checked",e,!1)}function ed(t,e){Cw(t,e);var n=Ii(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?td(t,e.type,n):e.hasOwnProperty("defaultValue")&&td(t,e.type,Ii(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Bm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function td(t,e,n){(e!=="number"||Uu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var sl=Array.isArray;function oo(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ii(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function nd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(q(91));return je({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Pm(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(q(92));if(sl(n)){if(1<n.length)throw Error(q(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ii(n)}}function bw(t,e){var n=Ii(e.value),r=Ii(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Lm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function xw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?xw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ha,Tw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ha=Ha||document.createElement("div"),Ha.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ha.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Bl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var hl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},db=["Webkit","ms","Moz","O"];Object.keys(hl).forEach(function(t){db.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),hl[e]=hl[t]})});function Iw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||hl.hasOwnProperty(t)&&hl[t]?(""+e).trim():e+"px"}function Ow(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Iw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var pb=je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function id(t,e){if(e){if(pb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(q(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(q(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(q(61))}if(e.style!=null&&typeof e.style!="object")throw Error(q(62))}}function sd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var od=null;function Wp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ld=null,lo=null,ao=null;function Fm(t){if(t=_a(t)){if(typeof ld!="function")throw Error(q(280));var e=t.stateNode;e&&(e=qc(e),ld(t.stateNode,t.type,e))}}function Rw(t){lo?ao?ao.push(t):ao=[t]:lo=t}function Aw(){if(lo){var t=lo,e=ao;if(ao=lo=null,Fm(t),e)for(t=0;t<e.length;t++)Fm(e[t])}}function Nw(t,e){return t(e)}function Mw(){}var Nf=!1;function Dw(t,e,n){if(Nf)return t(e,n);Nf=!0;try{return Nw(t,e,n)}finally{Nf=!1,(lo!==null||ao!==null)&&(Mw(),Aw())}}function Pl(t,e){var n=t.stateNode;if(n===null)return null;var r=qc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(q(231,e,typeof n));return n}var ad=!1;if(Ur)try{var Jo={};Object.defineProperty(Jo,"passive",{get:function(){ad=!0}}),window.addEventListener("test",Jo,Jo),window.removeEventListener("test",Jo,Jo)}catch{ad=!1}function gb(t,e,n,r,i,s,o,l,a){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var dl=!1,zu=null,Vu=!1,ud=null,mb={onError:function(t){dl=!0,zu=t}};function yb(t,e,n,r,i,s,o,l,a){dl=!1,zu=null,gb.apply(mb,arguments)}function wb(t,e,n,r,i,s,o,l,a){if(yb.apply(this,arguments),dl){if(dl){var u=zu;dl=!1,zu=null}else throw Error(q(198));Vu||(Vu=!0,ud=u)}}function As(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Bw(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Um(t){if(As(t)!==t)throw Error(q(188))}function Sb(t){var e=t.alternate;if(!e){if(e=As(t),e===null)throw Error(q(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Um(i),t;if(s===r)return Um(i),e;s=s.sibling}throw Error(q(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(q(189))}}if(n.alternate!==r)throw Error(q(190))}if(n.tag!==3)throw Error(q(188));return n.stateNode.current===n?t:e}function Pw(t){return t=Sb(t),t!==null?Lw(t):null}function Lw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Lw(t);if(e!==null)return e;t=t.sibling}return null}var Fw=mn.unstable_scheduleCallback,zm=mn.unstable_cancelCallback,vb=mn.unstable_shouldYield,kb=mn.unstable_requestPaint,Ge=mn.unstable_now,_b=mn.unstable_getCurrentPriorityLevel,qp=mn.unstable_ImmediatePriority,Uw=mn.unstable_UserBlockingPriority,ju=mn.unstable_NormalPriority,Eb=mn.unstable_LowPriority,zw=mn.unstable_IdlePriority,jc=null,dr=null;function Cb(t){if(dr&&typeof dr.onCommitFiberRoot=="function")try{dr.onCommitFiberRoot(jc,t,void 0,(t.current.flags&128)===128)}catch{}}var Yn=Math.clz32?Math.clz32:Tb,bb=Math.log,xb=Math.LN2;function Tb(t){return t>>>=0,t===0?32:31-(bb(t)/xb|0)|0}var $a=64,Wa=4194304;function ol(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Hu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=ol(l):(s&=o,s!==0&&(r=ol(s)))}else o=n&~i,o!==0?r=ol(o):s!==0&&(r=ol(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Yn(e),i=1<<n,r|=t[n],e&=~i;return r}function Ib(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ob(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Yn(s),l=1<<o,a=i[o];a===-1?(!(l&n)||l&r)&&(i[o]=Ib(l,e)):a<=e&&(t.expiredLanes|=l),s&=~l}}function cd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Vw(){var t=$a;return $a<<=1,!($a&4194240)&&($a=64),t}function Mf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function va(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Yn(e),t[e]=n}function Rb(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Yn(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Kp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Yn(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ee=0;function jw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Hw,Gp,$w,Ww,qw,fd=!1,qa=[],gi=null,mi=null,yi=null,Ll=new Map,Fl=new Map,ii=[],Ab="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Vm(t,e){switch(t){case"focusin":case"focusout":gi=null;break;case"dragenter":case"dragleave":mi=null;break;case"mouseover":case"mouseout":yi=null;break;case"pointerover":case"pointerout":Ll.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fl.delete(e.pointerId)}}function Yo(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=_a(e),e!==null&&Gp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Nb(t,e,n,r,i){switch(e){case"focusin":return gi=Yo(gi,t,e,n,r,i),!0;case"dragenter":return mi=Yo(mi,t,e,n,r,i),!0;case"mouseover":return yi=Yo(yi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Ll.set(s,Yo(Ll.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Fl.set(s,Yo(Fl.get(s)||null,t,e,n,r,i)),!0}return!1}function Kw(t){var e=Qi(t.target);if(e!==null){var n=As(e);if(n!==null){if(e=n.tag,e===13){if(e=Bw(n),e!==null){t.blockedOn=e,qw(t.priority,function(){$w(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function yu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=hd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);od=r,n.target.dispatchEvent(r),od=null}else return e=_a(n),e!==null&&Gp(e),t.blockedOn=n,!1;e.shift()}return!0}function jm(t,e,n){yu(t)&&n.delete(e)}function Mb(){fd=!1,gi!==null&&yu(gi)&&(gi=null),mi!==null&&yu(mi)&&(mi=null),yi!==null&&yu(yi)&&(yi=null),Ll.forEach(jm),Fl.forEach(jm)}function Qo(t,e){t.blockedOn===e&&(t.blockedOn=null,fd||(fd=!0,mn.unstable_scheduleCallback(mn.unstable_NormalPriority,Mb)))}function Ul(t){function e(i){return Qo(i,t)}if(0<qa.length){Qo(qa[0],t);for(var n=1;n<qa.length;n++){var r=qa[n];r.blockedOn===t&&(r.blockedOn=null)}}for(gi!==null&&Qo(gi,t),mi!==null&&Qo(mi,t),yi!==null&&Qo(yi,t),Ll.forEach(e),Fl.forEach(e),n=0;n<ii.length;n++)r=ii[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ii.length&&(n=ii[0],n.blockedOn===null);)Kw(n),n.blockedOn===null&&ii.shift()}var uo=qr.ReactCurrentBatchConfig,$u=!0;function Db(t,e,n,r){var i=Ee,s=uo.transition;uo.transition=null;try{Ee=1,Jp(t,e,n,r)}finally{Ee=i,uo.transition=s}}function Bb(t,e,n,r){var i=Ee,s=uo.transition;uo.transition=null;try{Ee=4,Jp(t,e,n,r)}finally{Ee=i,uo.transition=s}}function Jp(t,e,n,r){if($u){var i=hd(t,e,n,r);if(i===null)Hf(t,e,r,Wu,n),Vm(t,r);else if(Nb(i,t,e,n,r))r.stopPropagation();else if(Vm(t,r),e&4&&-1<Ab.indexOf(t)){for(;i!==null;){var s=_a(i);if(s!==null&&Hw(s),s=hd(t,e,n,r),s===null&&Hf(t,e,r,Wu,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Hf(t,e,r,null,n)}}var Wu=null;function hd(t,e,n,r){if(Wu=null,t=Wp(r),t=Qi(t),t!==null)if(e=As(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Bw(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Wu=t,null}function Gw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_b()){case qp:return 1;case Uw:return 4;case ju:case Eb:return 16;case zw:return 536870912;default:return 16}default:return 16}}var ui=null,Yp=null,wu=null;function Jw(){if(wu)return wu;var t,e=Yp,n=e.length,r,i="value"in ui?ui.value:ui.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return wu=i.slice(t,1<r?1-r:void 0)}function Su(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ka(){return!0}function Hm(){return!1}function wn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ka:Hm,this.isPropagationStopped=Hm,this}return je(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ka)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ka)},persist:function(){},isPersistent:Ka}),e}var Lo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qp=wn(Lo),ka=je({},Lo,{view:0,detail:0}),Pb=wn(ka),Df,Bf,Zo,Hc=je({},ka,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Zo&&(Zo&&t.type==="mousemove"?(Df=t.screenX-Zo.screenX,Bf=t.screenY-Zo.screenY):Bf=Df=0,Zo=t),Df)},movementY:function(t){return"movementY"in t?t.movementY:Bf}}),$m=wn(Hc),Lb=je({},Hc,{dataTransfer:0}),Fb=wn(Lb),Ub=je({},ka,{relatedTarget:0}),Pf=wn(Ub),zb=je({},Lo,{animationName:0,elapsedTime:0,pseudoElement:0}),Vb=wn(zb),jb=je({},Lo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Hb=wn(jb),$b=je({},Lo,{data:0}),Wm=wn($b),Wb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Kb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gb(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Kb[t])?!!e[t]:!1}function Zp(){return Gb}var Jb=je({},ka,{key:function(t){if(t.key){var e=Wb[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Su(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?qb[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zp,charCode:function(t){return t.type==="keypress"?Su(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Su(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Yb=wn(Jb),Qb=je({},Hc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qm=wn(Qb),Zb=je({},ka,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zp}),Xb=wn(Zb),ex=je({},Lo,{propertyName:0,elapsedTime:0,pseudoElement:0}),tx=wn(ex),nx=je({},Hc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),rx=wn(nx),ix=[9,13,27,32],Xp=Ur&&"CompositionEvent"in window,pl=null;Ur&&"documentMode"in document&&(pl=document.documentMode);var sx=Ur&&"TextEvent"in window&&!pl,Yw=Ur&&(!Xp||pl&&8<pl&&11>=pl),Km=" ",Gm=!1;function Qw(t,e){switch(t){case"keyup":return ix.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var qs=!1;function ox(t,e){switch(t){case"compositionend":return Zw(e);case"keypress":return e.which!==32?null:(Gm=!0,Km);case"textInput":return t=e.data,t===Km&&Gm?null:t;default:return null}}function lx(t,e){if(qs)return t==="compositionend"||!Xp&&Qw(t,e)?(t=Jw(),wu=Yp=ui=null,qs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Yw&&e.locale!=="ko"?null:e.data;default:return null}}var ax={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!ax[t.type]:e==="textarea"}function Xw(t,e,n,r){Rw(r),e=qu(e,"onChange"),0<e.length&&(n=new Qp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var gl=null,zl=null;function ux(t){cS(t,0)}function $c(t){var e=Js(t);if(Ew(e))return t}function cx(t,e){if(t==="change")return e}var eS=!1;if(Ur){var Lf;if(Ur){var Ff="oninput"in document;if(!Ff){var Ym=document.createElement("div");Ym.setAttribute("oninput","return;"),Ff=typeof Ym.oninput=="function"}Lf=Ff}else Lf=!1;eS=Lf&&(!document.documentMode||9<document.documentMode)}function Qm(){gl&&(gl.detachEvent("onpropertychange",tS),zl=gl=null)}function tS(t){if(t.propertyName==="value"&&$c(zl)){var e=[];Xw(e,zl,t,Wp(t)),Dw(ux,e)}}function fx(t,e,n){t==="focusin"?(Qm(),gl=e,zl=n,gl.attachEvent("onpropertychange",tS)):t==="focusout"&&Qm()}function hx(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return $c(zl)}function dx(t,e){if(t==="click")return $c(e)}function px(t,e){if(t==="input"||t==="change")return $c(e)}function gx(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Xn=typeof Object.is=="function"?Object.is:gx;function Vl(t,e){if(Xn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Gh.call(e,i)||!Xn(t[i],e[i]))return!1}return!0}function Zm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Xm(t,e){var n=Zm(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Zm(n)}}function nS(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?nS(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function rS(){for(var t=window,e=Uu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Uu(t.document)}return e}function eg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function mx(t){var e=rS(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&nS(n.ownerDocument.documentElement,n)){if(r!==null&&eg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Xm(n,s);var o=Xm(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var yx=Ur&&"documentMode"in document&&11>=document.documentMode,Ks=null,dd=null,ml=null,pd=!1;function e0(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;pd||Ks==null||Ks!==Uu(r)||(r=Ks,"selectionStart"in r&&eg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ml&&Vl(ml,r)||(ml=r,r=qu(dd,"onSelect"),0<r.length&&(e=new Qp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ks)))}function Ga(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Gs={animationend:Ga("Animation","AnimationEnd"),animationiteration:Ga("Animation","AnimationIteration"),animationstart:Ga("Animation","AnimationStart"),transitionend:Ga("Transition","TransitionEnd")},Uf={},iS={};Ur&&(iS=document.createElement("div").style,"AnimationEvent"in window||(delete Gs.animationend.animation,delete Gs.animationiteration.animation,delete Gs.animationstart.animation),"TransitionEvent"in window||delete Gs.transitionend.transition);function Wc(t){if(Uf[t])return Uf[t];if(!Gs[t])return t;var e=Gs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in iS)return Uf[t]=e[n];return t}var sS=Wc("animationend"),oS=Wc("animationiteration"),lS=Wc("animationstart"),aS=Wc("transitionend"),uS=new Map,t0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pi(t,e){uS.set(t,e),Rs(e,[t])}for(var zf=0;zf<t0.length;zf++){var Vf=t0[zf],wx=Vf.toLowerCase(),Sx=Vf[0].toUpperCase()+Vf.slice(1);Pi(wx,"on"+Sx)}Pi(sS,"onAnimationEnd");Pi(oS,"onAnimationIteration");Pi(lS,"onAnimationStart");Pi("dblclick","onDoubleClick");Pi("focusin","onFocus");Pi("focusout","onBlur");Pi(aS,"onTransitionEnd");ko("onMouseEnter",["mouseout","mouseover"]);ko("onMouseLeave",["mouseout","mouseover"]);ko("onPointerEnter",["pointerout","pointerover"]);ko("onPointerLeave",["pointerout","pointerover"]);Rs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Rs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Rs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Rs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Rs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Rs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ll="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vx=new Set("cancel close invalid load scroll toggle".split(" ").concat(ll));function n0(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,wb(r,e,void 0,t),t.currentTarget=null}function cS(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],a=l.instance,u=l.currentTarget;if(l=l.listener,a!==s&&i.isPropagationStopped())break e;n0(i,l,u),s=a}else for(o=0;o<r.length;o++){if(l=r[o],a=l.instance,u=l.currentTarget,l=l.listener,a!==s&&i.isPropagationStopped())break e;n0(i,l,u),s=a}}}if(Vu)throw t=ud,Vu=!1,ud=null,t}function Me(t,e){var n=e[Sd];n===void 0&&(n=e[Sd]=new Set);var r=t+"__bubble";n.has(r)||(fS(e,t,2,!1),n.add(r))}function jf(t,e,n){var r=0;e&&(r|=4),fS(n,t,r,e)}var Ja="_reactListening"+Math.random().toString(36).slice(2);function jl(t){if(!t[Ja]){t[Ja]=!0,ww.forEach(function(n){n!=="selectionchange"&&(vx.has(n)||jf(n,!1,t),jf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ja]||(e[Ja]=!0,jf("selectionchange",!1,e))}}function fS(t,e,n,r){switch(Gw(e)){case 1:var i=Db;break;case 4:i=Bb;break;default:i=Jp}n=i.bind(null,e,n,t),i=void 0,!ad||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Hf(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var a=o.tag;if((a===3||a===4)&&(a=o.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Qi(l),o===null)return;if(a=o.tag,a===5||a===6){r=s=o;continue e}l=l.parentNode}}r=r.return}Dw(function(){var u=s,c=Wp(n),f=[];e:{var h=uS.get(t);if(h!==void 0){var p=Qp,m=t;switch(t){case"keypress":if(Su(n)===0)break e;case"keydown":case"keyup":p=Yb;break;case"focusin":m="focus",p=Pf;break;case"focusout":m="blur",p=Pf;break;case"beforeblur":case"afterblur":p=Pf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=$m;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Fb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Xb;break;case sS:case oS:case lS:p=Vb;break;case aS:p=tx;break;case"scroll":p=Pb;break;case"wheel":p=rx;break;case"copy":case"cut":case"paste":p=Hb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=qm}var v=(e&4)!==0,C=!v&&t==="scroll",y=v?h!==null?h+"Capture":null:h;v=[];for(var _=u,x;_!==null;){x=_;var O=x.stateNode;if(x.tag===5&&O!==null&&(x=O,y!==null&&(O=Pl(_,y),O!=null&&v.push(Hl(_,O,x)))),C)break;_=_.return}0<v.length&&(h=new p(h,m,null,n,c),f.push({event:h,listeners:v}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",h&&n!==od&&(m=n.relatedTarget||n.fromElement)&&(Qi(m)||m[zr]))break e;if((p||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,p?(m=n.relatedTarget||n.toElement,p=u,m=m?Qi(m):null,m!==null&&(C=As(m),m!==C||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=u),p!==m)){if(v=$m,O="onMouseLeave",y="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(v=qm,O="onPointerLeave",y="onPointerEnter",_="pointer"),C=p==null?h:Js(p),x=m==null?h:Js(m),h=new v(O,_+"leave",p,n,c),h.target=C,h.relatedTarget=x,O=null,Qi(c)===u&&(v=new v(y,_+"enter",m,n,c),v.target=x,v.relatedTarget=C,O=v),C=O,p&&m)t:{for(v=p,y=m,_=0,x=v;x;x=Bs(x))_++;for(x=0,O=y;O;O=Bs(O))x++;for(;0<_-x;)v=Bs(v),_--;for(;0<x-_;)y=Bs(y),x--;for(;_--;){if(v===y||y!==null&&v===y.alternate)break t;v=Bs(v),y=Bs(y)}v=null}else v=null;p!==null&&r0(f,h,p,v,!1),m!==null&&C!==null&&r0(f,C,m,v,!0)}}e:{if(h=u?Js(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var R=cx;else if(Jm(h))if(eS)R=px;else{R=hx;var P=fx}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(R=dx);if(R&&(R=R(t,u))){Xw(f,R,n,c);break e}P&&P(t,h,u),t==="focusout"&&(P=h._wrapperState)&&P.controlled&&h.type==="number"&&td(h,"number",h.value)}switch(P=u?Js(u):window,t){case"focusin":(Jm(P)||P.contentEditable==="true")&&(Ks=P,dd=u,ml=null);break;case"focusout":ml=dd=Ks=null;break;case"mousedown":pd=!0;break;case"contextmenu":case"mouseup":case"dragend":pd=!1,e0(f,n,c);break;case"selectionchange":if(yx)break;case"keydown":case"keyup":e0(f,n,c)}var F;if(Xp)e:{switch(t){case"compositionstart":var V="onCompositionStart";break e;case"compositionend":V="onCompositionEnd";break e;case"compositionupdate":V="onCompositionUpdate";break e}V=void 0}else qs?Qw(t,n)&&(V="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(V="onCompositionStart");V&&(Yw&&n.locale!=="ko"&&(qs||V!=="onCompositionStart"?V==="onCompositionEnd"&&qs&&(F=Jw()):(ui=c,Yp="value"in ui?ui.value:ui.textContent,qs=!0)),P=qu(u,V),0<P.length&&(V=new Wm(V,t,null,n,c),f.push({event:V,listeners:P}),F?V.data=F:(F=Zw(n),F!==null&&(V.data=F)))),(F=sx?ox(t,n):lx(t,n))&&(u=qu(u,"onBeforeInput"),0<u.length&&(c=new Wm("onBeforeInput","beforeinput",null,n,c),f.push({event:c,listeners:u}),c.data=F))}cS(f,e)})}function Hl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function qu(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Pl(t,n),s!=null&&r.unshift(Hl(t,s,i)),s=Pl(t,e),s!=null&&r.push(Hl(t,s,i))),t=t.return}return r}function Bs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function r0(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var l=n,a=l.alternate,u=l.stateNode;if(a!==null&&a===r)break;l.tag===5&&u!==null&&(l=u,i?(a=Pl(n,s),a!=null&&o.unshift(Hl(n,a,l))):i||(a=Pl(n,s),a!=null&&o.push(Hl(n,a,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var kx=/\r\n?/g,_x=/\u0000|\uFFFD/g;function i0(t){return(typeof t=="string"?t:""+t).replace(kx,`
`).replace(_x,"")}function Ya(t,e,n){if(e=i0(e),i0(t)!==e&&n)throw Error(q(425))}function Ku(){}var gd=null,md=null;function yd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var wd=typeof setTimeout=="function"?setTimeout:void 0,Ex=typeof clearTimeout=="function"?clearTimeout:void 0,s0=typeof Promise=="function"?Promise:void 0,Cx=typeof queueMicrotask=="function"?queueMicrotask:typeof s0<"u"?function(t){return s0.resolve(null).then(t).catch(bx)}:wd;function bx(t){setTimeout(function(){throw t})}function $f(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Ul(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ul(e)}function wi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function o0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Fo=Math.random().toString(36).slice(2),ur="__reactFiber$"+Fo,$l="__reactProps$"+Fo,zr="__reactContainer$"+Fo,Sd="__reactEvents$"+Fo,xx="__reactListeners$"+Fo,Tx="__reactHandles$"+Fo;function Qi(t){var e=t[ur];if(e)return e;for(var n=t.parentNode;n;){if(e=n[zr]||n[ur]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=o0(t);t!==null;){if(n=t[ur])return n;t=o0(t)}return e}t=n,n=t.parentNode}return null}function _a(t){return t=t[ur]||t[zr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Js(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(q(33))}function qc(t){return t[$l]||null}var vd=[],Ys=-1;function Li(t){return{current:t}}function De(t){0>Ys||(t.current=vd[Ys],vd[Ys]=null,Ys--)}function Re(t,e){Ys++,vd[Ys]=t.current,t.current=e}var Oi={},Rt=Li(Oi),tn=Li(!1),gs=Oi;function _o(t,e){var n=t.type.contextTypes;if(!n)return Oi;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function nn(t){return t=t.childContextTypes,t!=null}function Gu(){De(tn),De(Rt)}function l0(t,e,n){if(Rt.current!==Oi)throw Error(q(168));Re(Rt,e),Re(tn,n)}function hS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(q(108,fb(t)||"Unknown",i));return je({},n,r)}function Ju(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Oi,gs=Rt.current,Re(Rt,t),Re(tn,tn.current),!0}function a0(t,e,n){var r=t.stateNode;if(!r)throw Error(q(169));n?(t=hS(t,e,gs),r.__reactInternalMemoizedMergedChildContext=t,De(tn),De(Rt),Re(Rt,t)):De(tn),Re(tn,n)}var Ar=null,Kc=!1,Wf=!1;function dS(t){Ar===null?Ar=[t]:Ar.push(t)}function Ix(t){Kc=!0,dS(t)}function Fi(){if(!Wf&&Ar!==null){Wf=!0;var t=0,e=Ee;try{var n=Ar;for(Ee=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ar=null,Kc=!1}catch(i){throw Ar!==null&&(Ar=Ar.slice(t+1)),Fw(qp,Fi),i}finally{Ee=e,Wf=!1}}return null}var Qs=[],Zs=0,Yu=null,Qu=0,Cn=[],bn=0,ms=null,Mr=1,Dr="";function Ki(t,e){Qs[Zs++]=Qu,Qs[Zs++]=Yu,Yu=t,Qu=e}function pS(t,e,n){Cn[bn++]=Mr,Cn[bn++]=Dr,Cn[bn++]=ms,ms=t;var r=Mr;t=Dr;var i=32-Yn(r)-1;r&=~(1<<i),n+=1;var s=32-Yn(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Mr=1<<32-Yn(e)+i|n<<i|r,Dr=s+t}else Mr=1<<s|n<<i|r,Dr=t}function tg(t){t.return!==null&&(Ki(t,1),pS(t,1,0))}function ng(t){for(;t===Yu;)Yu=Qs[--Zs],Qs[Zs]=null,Qu=Qs[--Zs],Qs[Zs]=null;for(;t===ms;)ms=Cn[--bn],Cn[bn]=null,Dr=Cn[--bn],Cn[bn]=null,Mr=Cn[--bn],Cn[bn]=null}var fn=null,cn=null,Fe=!1,Wn=null;function gS(t,e){var n=An(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function u0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,fn=t,cn=wi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,fn=t,cn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ms!==null?{id:Mr,overflow:Dr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=An(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,fn=t,cn=null,!0):!1;default:return!1}}function kd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function _d(t){if(Fe){var e=cn;if(e){var n=e;if(!u0(t,e)){if(kd(t))throw Error(q(418));e=wi(n.nextSibling);var r=fn;e&&u0(t,e)?gS(r,n):(t.flags=t.flags&-4097|2,Fe=!1,fn=t)}}else{if(kd(t))throw Error(q(418));t.flags=t.flags&-4097|2,Fe=!1,fn=t}}}function c0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;fn=t}function Qa(t){if(t!==fn)return!1;if(!Fe)return c0(t),Fe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!yd(t.type,t.memoizedProps)),e&&(e=cn)){if(kd(t))throw mS(),Error(q(418));for(;e;)gS(t,e),e=wi(e.nextSibling)}if(c0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(q(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){cn=wi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}cn=null}}else cn=fn?wi(t.stateNode.nextSibling):null;return!0}function mS(){for(var t=cn;t;)t=wi(t.nextSibling)}function Eo(){cn=fn=null,Fe=!1}function rg(t){Wn===null?Wn=[t]:Wn.push(t)}var Ox=qr.ReactCurrentBatchConfig;function Hn(t,e){if(t&&t.defaultProps){e=je({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Zu=Li(null),Xu=null,Xs=null,ig=null;function sg(){ig=Xs=Xu=null}function og(t){var e=Zu.current;De(Zu),t._currentValue=e}function Ed(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function co(t,e){Xu=t,ig=Xs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Xt=!0),t.firstContext=null)}function Dn(t){var e=t._currentValue;if(ig!==t)if(t={context:t,memoizedValue:e,next:null},Xs===null){if(Xu===null)throw Error(q(308));Xs=t,Xu.dependencies={lanes:0,firstContext:t}}else Xs=Xs.next=t;return e}var Zi=null;function lg(t){Zi===null?Zi=[t]:Zi.push(t)}function yS(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,lg(e)):(n.next=i.next,i.next=n),e.interleaved=n,Vr(t,r)}function Vr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ti=!1;function ag(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Pr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Si(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,we&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Vr(t,n)}return i=r.interleaved,i===null?(e.next=e,lg(r)):(e.next=i.next,i.next=e),r.interleaved=e,Vr(t,n)}function vu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Kp(t,n)}}function f0(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ec(t,e,n,r){var i=t.updateQueue;ti=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var a=l,u=a.next;a.next=null,o===null?s=u:o.next=u,o=a;var c=t.alternate;c!==null&&(c=c.updateQueue,l=c.lastBaseUpdate,l!==o&&(l===null?c.firstBaseUpdate=u:l.next=u,c.lastBaseUpdate=a))}if(s!==null){var f=i.baseState;o=0,c=u=a=null,l=s;do{var h=l.lane,p=l.eventTime;if((r&h)===h){c!==null&&(c=c.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=t,v=l;switch(h=e,p=n,v.tag){case 1:if(m=v.payload,typeof m=="function"){f=m.call(p,f,h);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=v.payload,h=typeof m=="function"?m.call(p,f,h):m,h==null)break e;f=je({},f,h);break e;case 2:ti=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[l]:h.push(l))}else p={eventTime:p,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},c===null?(u=c=p,a=f):c=c.next=p,o|=h;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;h=l,l=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(c===null&&(a=f),i.baseState=a,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ws|=o,t.lanes=o,t.memoizedState=f}}function h0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(q(191,i));i.call(r)}}}var SS=new yw.Component().refs;function Cd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:je({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Gc={isMounted:function(t){return(t=t._reactInternals)?As(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=zt(),i=ki(t),s=Pr(r,i);s.payload=e,n!=null&&(s.callback=n),e=Si(t,s,i),e!==null&&(Qn(e,t,i,r),vu(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=zt(),i=ki(t),s=Pr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Si(t,s,i),e!==null&&(Qn(e,t,i,r),vu(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=zt(),r=ki(t),i=Pr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Si(t,i,r),e!==null&&(Qn(e,t,r,n),vu(e,t,r))}};function d0(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Vl(n,r)||!Vl(i,s):!0}function vS(t,e,n){var r=!1,i=Oi,s=e.contextType;return typeof s=="object"&&s!==null?s=Dn(s):(i=nn(e)?gs:Rt.current,r=e.contextTypes,s=(r=r!=null)?_o(t,i):Oi),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Gc,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function p0(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Gc.enqueueReplaceState(e,e.state,null)}function bd(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=SS,ag(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Dn(s):(s=nn(e)?gs:Rt.current,i.context=_o(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Cd(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Gc.enqueueReplaceState(i,i.state,null),ec(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Xo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(q(309));var r=n.stateNode}if(!r)throw Error(q(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;l===SS&&(l=i.refs={}),o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(q(284));if(!n._owner)throw Error(q(290,t))}return t}function Za(t,e){throw t=Object.prototype.toString.call(e),Error(q(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function g0(t){var e=t._init;return e(t._payload)}function kS(t){function e(y,_){if(t){var x=y.deletions;x===null?(y.deletions=[_],y.flags|=16):x.push(_)}}function n(y,_){if(!t)return null;for(;_!==null;)e(y,_),_=_.sibling;return null}function r(y,_){for(y=new Map;_!==null;)_.key!==null?y.set(_.key,_):y.set(_.index,_),_=_.sibling;return y}function i(y,_){return y=_i(y,_),y.index=0,y.sibling=null,y}function s(y,_,x){return y.index=x,t?(x=y.alternate,x!==null?(x=x.index,x<_?(y.flags|=2,_):x):(y.flags|=2,_)):(y.flags|=1048576,_)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function l(y,_,x,O){return _===null||_.tag!==6?(_=Zf(x,y.mode,O),_.return=y,_):(_=i(_,x),_.return=y,_)}function a(y,_,x,O){var R=x.type;return R===Ws?c(y,_,x.props.children,O,x.key):_!==null&&(_.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===ei&&g0(R)===_.type)?(O=i(_,x.props),O.ref=Xo(y,_,x),O.return=y,O):(O=xu(x.type,x.key,x.props,null,y.mode,O),O.ref=Xo(y,_,x),O.return=y,O)}function u(y,_,x,O){return _===null||_.tag!==4||_.stateNode.containerInfo!==x.containerInfo||_.stateNode.implementation!==x.implementation?(_=Xf(x,y.mode,O),_.return=y,_):(_=i(_,x.children||[]),_.return=y,_)}function c(y,_,x,O,R){return _===null||_.tag!==7?(_=ss(x,y.mode,O,R),_.return=y,_):(_=i(_,x),_.return=y,_)}function f(y,_,x){if(typeof _=="string"&&_!==""||typeof _=="number")return _=Zf(""+_,y.mode,x),_.return=y,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Va:return x=xu(_.type,_.key,_.props,null,y.mode,x),x.ref=Xo(y,null,_),x.return=y,x;case $s:return _=Xf(_,y.mode,x),_.return=y,_;case ei:var O=_._init;return f(y,O(_._payload),x)}if(sl(_)||Go(_))return _=ss(_,y.mode,x,null),_.return=y,_;Za(y,_)}return null}function h(y,_,x,O){var R=_!==null?_.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return R!==null?null:l(y,_,""+x,O);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Va:return x.key===R?a(y,_,x,O):null;case $s:return x.key===R?u(y,_,x,O):null;case ei:return R=x._init,h(y,_,R(x._payload),O)}if(sl(x)||Go(x))return R!==null?null:c(y,_,x,O,null);Za(y,x)}return null}function p(y,_,x,O,R){if(typeof O=="string"&&O!==""||typeof O=="number")return y=y.get(x)||null,l(_,y,""+O,R);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case Va:return y=y.get(O.key===null?x:O.key)||null,a(_,y,O,R);case $s:return y=y.get(O.key===null?x:O.key)||null,u(_,y,O,R);case ei:var P=O._init;return p(y,_,x,P(O._payload),R)}if(sl(O)||Go(O))return y=y.get(x)||null,c(_,y,O,R,null);Za(_,O)}return null}function m(y,_,x,O){for(var R=null,P=null,F=_,V=_=0,z=null;F!==null&&V<x.length;V++){F.index>V?(z=F,F=null):z=F.sibling;var Q=h(y,F,x[V],O);if(Q===null){F===null&&(F=z);break}t&&F&&Q.alternate===null&&e(y,F),_=s(Q,_,V),P===null?R=Q:P.sibling=Q,P=Q,F=z}if(V===x.length)return n(y,F),Fe&&Ki(y,V),R;if(F===null){for(;V<x.length;V++)F=f(y,x[V],O),F!==null&&(_=s(F,_,V),P===null?R=F:P.sibling=F,P=F);return Fe&&Ki(y,V),R}for(F=r(y,F);V<x.length;V++)z=p(F,y,V,x[V],O),z!==null&&(t&&z.alternate!==null&&F.delete(z.key===null?V:z.key),_=s(z,_,V),P===null?R=z:P.sibling=z,P=z);return t&&F.forEach(function(ye){return e(y,ye)}),Fe&&Ki(y,V),R}function v(y,_,x,O){var R=Go(x);if(typeof R!="function")throw Error(q(150));if(x=R.call(x),x==null)throw Error(q(151));for(var P=R=null,F=_,V=_=0,z=null,Q=x.next();F!==null&&!Q.done;V++,Q=x.next()){F.index>V?(z=F,F=null):z=F.sibling;var ye=h(y,F,Q.value,O);if(ye===null){F===null&&(F=z);break}t&&F&&ye.alternate===null&&e(y,F),_=s(ye,_,V),P===null?R=ye:P.sibling=ye,P=ye,F=z}if(Q.done)return n(y,F),Fe&&Ki(y,V),R;if(F===null){for(;!Q.done;V++,Q=x.next())Q=f(y,Q.value,O),Q!==null&&(_=s(Q,_,V),P===null?R=Q:P.sibling=Q,P=Q);return Fe&&Ki(y,V),R}for(F=r(y,F);!Q.done;V++,Q=x.next())Q=p(F,y,V,Q.value,O),Q!==null&&(t&&Q.alternate!==null&&F.delete(Q.key===null?V:Q.key),_=s(Q,_,V),P===null?R=Q:P.sibling=Q,P=Q);return t&&F.forEach(function(nt){return e(y,nt)}),Fe&&Ki(y,V),R}function C(y,_,x,O){if(typeof x=="object"&&x!==null&&x.type===Ws&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Va:e:{for(var R=x.key,P=_;P!==null;){if(P.key===R){if(R=x.type,R===Ws){if(P.tag===7){n(y,P.sibling),_=i(P,x.props.children),_.return=y,y=_;break e}}else if(P.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===ei&&g0(R)===P.type){n(y,P.sibling),_=i(P,x.props),_.ref=Xo(y,P,x),_.return=y,y=_;break e}n(y,P);break}else e(y,P);P=P.sibling}x.type===Ws?(_=ss(x.props.children,y.mode,O,x.key),_.return=y,y=_):(O=xu(x.type,x.key,x.props,null,y.mode,O),O.ref=Xo(y,_,x),O.return=y,y=O)}return o(y);case $s:e:{for(P=x.key;_!==null;){if(_.key===P)if(_.tag===4&&_.stateNode.containerInfo===x.containerInfo&&_.stateNode.implementation===x.implementation){n(y,_.sibling),_=i(_,x.children||[]),_.return=y,y=_;break e}else{n(y,_);break}else e(y,_);_=_.sibling}_=Xf(x,y.mode,O),_.return=y,y=_}return o(y);case ei:return P=x._init,C(y,_,P(x._payload),O)}if(sl(x))return m(y,_,x,O);if(Go(x))return v(y,_,x,O);Za(y,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,_!==null&&_.tag===6?(n(y,_.sibling),_=i(_,x),_.return=y,y=_):(n(y,_),_=Zf(x,y.mode,O),_.return=y,y=_),o(y)):n(y,_)}return C}var Co=kS(!0),_S=kS(!1),Ea={},pr=Li(Ea),Wl=Li(Ea),ql=Li(Ea);function Xi(t){if(t===Ea)throw Error(q(174));return t}function ug(t,e){switch(Re(ql,e),Re(Wl,t),Re(pr,Ea),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:rd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=rd(e,t)}De(pr),Re(pr,e)}function bo(){De(pr),De(Wl),De(ql)}function ES(t){Xi(ql.current);var e=Xi(pr.current),n=rd(e,t.type);e!==n&&(Re(Wl,t),Re(pr,n))}function cg(t){Wl.current===t&&(De(pr),De(Wl))}var ze=Li(0);function tc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var qf=[];function fg(){for(var t=0;t<qf.length;t++)qf[t]._workInProgressVersionPrimary=null;qf.length=0}var ku=qr.ReactCurrentDispatcher,Kf=qr.ReactCurrentBatchConfig,ys=0,Ve=null,et=null,at=null,nc=!1,yl=!1,Kl=0,Rx=0;function _t(){throw Error(q(321))}function hg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Xn(t[n],e[n]))return!1;return!0}function dg(t,e,n,r,i,s){if(ys=s,Ve=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ku.current=t===null||t.memoizedState===null?Dx:Bx,t=n(r,i),yl){s=0;do{if(yl=!1,Kl=0,25<=s)throw Error(q(301));s+=1,at=et=null,e.updateQueue=null,ku.current=Px,t=n(r,i)}while(yl)}if(ku.current=rc,e=et!==null&&et.next!==null,ys=0,at=et=Ve=null,nc=!1,e)throw Error(q(300));return t}function pg(){var t=Kl!==0;return Kl=0,t}function lr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return at===null?Ve.memoizedState=at=t:at=at.next=t,at}function Bn(){if(et===null){var t=Ve.alternate;t=t!==null?t.memoizedState:null}else t=et.next;var e=at===null?Ve.memoizedState:at.next;if(e!==null)at=e,et=t;else{if(t===null)throw Error(q(310));et=t,t={memoizedState:et.memoizedState,baseState:et.baseState,baseQueue:et.baseQueue,queue:et.queue,next:null},at===null?Ve.memoizedState=at=t:at=at.next=t}return at}function Gl(t,e){return typeof e=="function"?e(t):e}function Gf(t){var e=Bn(),n=e.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=t;var r=et,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,a=null,u=s;do{var c=u.lane;if((ys&c)===c)a!==null&&(a=a.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};a===null?(l=a=f,o=r):a=a.next=f,Ve.lanes|=c,ws|=c}u=u.next}while(u!==null&&u!==s);a===null?o=r:a.next=l,Xn(r,e.memoizedState)||(Xt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=a,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Ve.lanes|=s,ws|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Jf(t){var e=Bn(),n=e.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Xn(s,e.memoizedState)||(Xt=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function CS(){}function bS(t,e){var n=Ve,r=Bn(),i=e(),s=!Xn(r.memoizedState,i);if(s&&(r.memoizedState=i,Xt=!0),r=r.queue,gg(IS.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||at!==null&&at.memoizedState.tag&1){if(n.flags|=2048,Jl(9,TS.bind(null,n,r,i,e),void 0,null),ct===null)throw Error(q(349));ys&30||xS(n,e,i)}return i}function xS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ve.updateQueue,e===null?(e={lastEffect:null,stores:null},Ve.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function TS(t,e,n,r){e.value=n,e.getSnapshot=r,OS(e)&&RS(t)}function IS(t,e,n){return n(function(){OS(e)&&RS(t)})}function OS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Xn(t,n)}catch{return!0}}function RS(t){var e=Vr(t,1);e!==null&&Qn(e,t,1,-1)}function m0(t){var e=lr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gl,lastRenderedState:t},e.queue=t,t=t.dispatch=Mx.bind(null,Ve,t),[e.memoizedState,t]}function Jl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ve.updateQueue,e===null?(e={lastEffect:null,stores:null},Ve.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function AS(){return Bn().memoizedState}function _u(t,e,n,r){var i=lr();Ve.flags|=t,i.memoizedState=Jl(1|e,n,void 0,r===void 0?null:r)}function Jc(t,e,n,r){var i=Bn();r=r===void 0?null:r;var s=void 0;if(et!==null){var o=et.memoizedState;if(s=o.destroy,r!==null&&hg(r,o.deps)){i.memoizedState=Jl(e,n,s,r);return}}Ve.flags|=t,i.memoizedState=Jl(1|e,n,s,r)}function y0(t,e){return _u(8390656,8,t,e)}function gg(t,e){return Jc(2048,8,t,e)}function NS(t,e){return Jc(4,2,t,e)}function MS(t,e){return Jc(4,4,t,e)}function DS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function BS(t,e,n){return n=n!=null?n.concat([t]):null,Jc(4,4,DS.bind(null,e,t),n)}function mg(){}function PS(t,e){var n=Bn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&hg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function LS(t,e){var n=Bn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&hg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function FS(t,e,n){return ys&21?(Xn(n,e)||(n=Vw(),Ve.lanes|=n,ws|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Xt=!0),t.memoizedState=n)}function Ax(t,e){var n=Ee;Ee=n!==0&&4>n?n:4,t(!0);var r=Kf.transition;Kf.transition={};try{t(!1),e()}finally{Ee=n,Kf.transition=r}}function US(){return Bn().memoizedState}function Nx(t,e,n){var r=ki(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},zS(t))VS(e,n);else if(n=yS(t,e,n,r),n!==null){var i=zt();Qn(n,t,r,i),jS(n,e,r)}}function Mx(t,e,n){var r=ki(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(zS(t))VS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,n);if(i.hasEagerState=!0,i.eagerState=l,Xn(l,o)){var a=e.interleaved;a===null?(i.next=i,lg(e)):(i.next=a.next,a.next=i),e.interleaved=i;return}}catch{}finally{}n=yS(t,e,i,r),n!==null&&(i=zt(),Qn(n,t,r,i),jS(n,e,r))}}function zS(t){var e=t.alternate;return t===Ve||e!==null&&e===Ve}function VS(t,e){yl=nc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function jS(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Kp(t,n)}}var rc={readContext:Dn,useCallback:_t,useContext:_t,useEffect:_t,useImperativeHandle:_t,useInsertionEffect:_t,useLayoutEffect:_t,useMemo:_t,useReducer:_t,useRef:_t,useState:_t,useDebugValue:_t,useDeferredValue:_t,useTransition:_t,useMutableSource:_t,useSyncExternalStore:_t,useId:_t,unstable_isNewReconciler:!1},Dx={readContext:Dn,useCallback:function(t,e){return lr().memoizedState=[t,e===void 0?null:e],t},useContext:Dn,useEffect:y0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,_u(4194308,4,DS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return _u(4194308,4,t,e)},useInsertionEffect:function(t,e){return _u(4,2,t,e)},useMemo:function(t,e){var n=lr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=lr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Nx.bind(null,Ve,t),[r.memoizedState,t]},useRef:function(t){var e=lr();return t={current:t},e.memoizedState=t},useState:m0,useDebugValue:mg,useDeferredValue:function(t){return lr().memoizedState=t},useTransition:function(){var t=m0(!1),e=t[0];return t=Ax.bind(null,t[1]),lr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ve,i=lr();if(Fe){if(n===void 0)throw Error(q(407));n=n()}else{if(n=e(),ct===null)throw Error(q(349));ys&30||xS(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,y0(IS.bind(null,r,s,t),[t]),r.flags|=2048,Jl(9,TS.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=lr(),e=ct.identifierPrefix;if(Fe){var n=Dr,r=Mr;n=(r&~(1<<32-Yn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Kl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Rx++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Bx={readContext:Dn,useCallback:PS,useContext:Dn,useEffect:gg,useImperativeHandle:BS,useInsertionEffect:NS,useLayoutEffect:MS,useMemo:LS,useReducer:Gf,useRef:AS,useState:function(){return Gf(Gl)},useDebugValue:mg,useDeferredValue:function(t){var e=Bn();return FS(e,et.memoizedState,t)},useTransition:function(){var t=Gf(Gl)[0],e=Bn().memoizedState;return[t,e]},useMutableSource:CS,useSyncExternalStore:bS,useId:US,unstable_isNewReconciler:!1},Px={readContext:Dn,useCallback:PS,useContext:Dn,useEffect:gg,useImperativeHandle:BS,useInsertionEffect:NS,useLayoutEffect:MS,useMemo:LS,useReducer:Jf,useRef:AS,useState:function(){return Jf(Gl)},useDebugValue:mg,useDeferredValue:function(t){var e=Bn();return et===null?e.memoizedState=t:FS(e,et.memoizedState,t)},useTransition:function(){var t=Jf(Gl)[0],e=Bn().memoizedState;return[t,e]},useMutableSource:CS,useSyncExternalStore:bS,useId:US,unstable_isNewReconciler:!1};function xo(t,e){try{var n="",r=e;do n+=cb(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Yf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function xd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Lx=typeof WeakMap=="function"?WeakMap:Map;function HS(t,e,n){n=Pr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){sc||(sc=!0,Pd=r),xd(t,e)},n}function $S(t,e,n){n=Pr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){xd(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){xd(t,e),typeof r!="function"&&(vi===null?vi=new Set([this]):vi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function w0(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Lx;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=Qx.bind(null,t,e,n),e.then(t,t))}function S0(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function v0(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Pr(-1,1),e.tag=2,Si(n,e,1))),n.lanes|=1),t)}var Fx=qr.ReactCurrentOwner,Xt=!1;function Pt(t,e,n,r){e.child=t===null?_S(e,null,n,r):Co(e,t.child,n,r)}function k0(t,e,n,r,i){n=n.render;var s=e.ref;return co(e,i),r=dg(t,e,n,r,s,i),n=pg(),t!==null&&!Xt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,jr(t,e,i)):(Fe&&n&&tg(e),e.flags|=1,Pt(t,e,r,i),e.child)}function _0(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Cg(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,WS(t,e,s,r,i)):(t=xu(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Vl,n(o,r)&&t.ref===e.ref)return jr(t,e,i)}return e.flags|=1,t=_i(s,r),t.ref=e.ref,t.return=e,e.child=t}function WS(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Vl(s,r)&&t.ref===e.ref)if(Xt=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Xt=!0);else return e.lanes=t.lanes,jr(t,e,i)}return Td(t,e,n,r,i)}function qS(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Re(to,an),an|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Re(to,an),an|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Re(to,an),an|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Re(to,an),an|=r;return Pt(t,e,i,n),e.child}function KS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Td(t,e,n,r,i){var s=nn(n)?gs:Rt.current;return s=_o(e,s),co(e,i),n=dg(t,e,n,r,s,i),r=pg(),t!==null&&!Xt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,jr(t,e,i)):(Fe&&r&&tg(e),e.flags|=1,Pt(t,e,n,i),e.child)}function E0(t,e,n,r,i){if(nn(n)){var s=!0;Ju(e)}else s=!1;if(co(e,i),e.stateNode===null)Eu(t,e),vS(e,n,r),bd(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var a=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Dn(u):(u=nn(n)?gs:Rt.current,u=_o(e,u));var c=n.getDerivedStateFromProps,f=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||a!==u)&&p0(e,o,r,u),ti=!1;var h=e.memoizedState;o.state=h,ec(e,r,o,i),a=e.memoizedState,l!==r||h!==a||tn.current||ti?(typeof c=="function"&&(Cd(e,n,c,r),a=e.memoizedState),(l=ti||d0(e,n,l,r,h,a,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),o.props=r,o.state=a,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,wS(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Hn(e.type,l),o.props=u,f=e.pendingProps,h=o.context,a=n.contextType,typeof a=="object"&&a!==null?a=Dn(a):(a=nn(n)?gs:Rt.current,a=_o(e,a));var p=n.getDerivedStateFromProps;(c=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||h!==a)&&p0(e,o,r,a),ti=!1,h=e.memoizedState,o.state=h,ec(e,r,o,i);var m=e.memoizedState;l!==f||h!==m||tn.current||ti?(typeof p=="function"&&(Cd(e,n,p,r),m=e.memoizedState),(u=ti||d0(e,n,u,r,h,m,a)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,m,a),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,m,a)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),o.props=r,o.state=m,o.context=a,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Id(t,e,n,r,s,i)}function Id(t,e,n,r,i,s){KS(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&a0(e,n,!1),jr(t,e,s);r=e.stateNode,Fx.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Co(e,t.child,null,s),e.child=Co(e,null,l,s)):Pt(t,e,l,s),e.memoizedState=r.state,i&&a0(e,n,!0),e.child}function GS(t){var e=t.stateNode;e.pendingContext?l0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&l0(t,e.context,!1),ug(t,e.containerInfo)}function C0(t,e,n,r,i){return Eo(),rg(i),e.flags|=256,Pt(t,e,n,r),e.child}var Od={dehydrated:null,treeContext:null,retryLane:0};function Rd(t){return{baseLanes:t,cachePool:null,transitions:null}}function JS(t,e,n){var r=e.pendingProps,i=ze.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Re(ze,i&1),t===null)return _d(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Zc(o,r,0,null),t=ss(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Rd(n),e.memoizedState=Od,t):yg(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return Ux(t,e,o,r,l,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,l=i.sibling;var a={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=_i(i,a),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=_i(l,s):(s=ss(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Rd(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Od,r}return s=t.child,t=s.sibling,r=_i(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function yg(t,e){return e=Zc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Xa(t,e,n,r){return r!==null&&rg(r),Co(e,t.child,null,n),t=yg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Ux(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Yf(Error(q(422))),Xa(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Zc({mode:"visible",children:r.children},i,0,null),s=ss(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Co(e,t.child,null,o),e.child.memoizedState=Rd(o),e.memoizedState=Od,s);if(!(e.mode&1))return Xa(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(q(419)),r=Yf(s,r,void 0),Xa(t,e,o,r)}if(l=(o&t.childLanes)!==0,Xt||l){if(r=ct,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Vr(t,i),Qn(r,t,i,-1))}return Eg(),r=Yf(Error(q(421))),Xa(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=Zx.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,cn=wi(i.nextSibling),fn=e,Fe=!0,Wn=null,t!==null&&(Cn[bn++]=Mr,Cn[bn++]=Dr,Cn[bn++]=ms,Mr=t.id,Dr=t.overflow,ms=e),e=yg(e,r.children),e.flags|=4096,e)}function b0(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Ed(t.return,e,n)}function Qf(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function YS(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Pt(t,e,r.children,n),r=ze.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&b0(t,n,e);else if(t.tag===19)b0(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Re(ze,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&tc(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Qf(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&tc(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Qf(e,!0,n,null,s);break;case"together":Qf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Eu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function jr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ws|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(q(153));if(e.child!==null){for(t=e.child,n=_i(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=_i(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function zx(t,e,n){switch(e.tag){case 3:GS(e),Eo();break;case 5:ES(e);break;case 1:nn(e.type)&&Ju(e);break;case 4:ug(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Re(Zu,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Re(ze,ze.current&1),e.flags|=128,null):n&e.child.childLanes?JS(t,e,n):(Re(ze,ze.current&1),t=jr(t,e,n),t!==null?t.sibling:null);Re(ze,ze.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return YS(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Re(ze,ze.current),r)break;return null;case 22:case 23:return e.lanes=0,qS(t,e,n)}return jr(t,e,n)}var QS,Ad,ZS,XS;QS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Ad=function(){};ZS=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Xi(pr.current);var s=null;switch(n){case"input":i=Xh(t,i),r=Xh(t,r),s=[];break;case"select":i=je({},i,{value:void 0}),r=je({},r,{value:void 0}),s=[];break;case"textarea":i=nd(t,i),r=nd(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ku)}id(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Dl.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var a=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&a!==l&&(a!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||a&&a.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in a)a.hasOwnProperty(o)&&l[o]!==a[o]&&(n||(n={}),n[o]=a[o])}else n||(s||(s=[]),s.push(u,n)),n=a;else u==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(s=s||[]).push(u,a)):u==="children"?typeof a!="string"&&typeof a!="number"||(s=s||[]).push(u,""+a):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Dl.hasOwnProperty(u)?(a!=null&&u==="onScroll"&&Me("scroll",t),s||l===a||(s=[])):(s=s||[]).push(u,a))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};XS=function(t,e,n,r){n!==r&&(e.flags|=4)};function el(t,e){if(!Fe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Et(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Vx(t,e,n){var r=e.pendingProps;switch(ng(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(e),null;case 1:return nn(e.type)&&Gu(),Et(e),null;case 3:return r=e.stateNode,bo(),De(tn),De(Rt),fg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Qa(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Wn!==null&&(Ud(Wn),Wn=null))),Ad(t,e),Et(e),null;case 5:cg(e);var i=Xi(ql.current);if(n=e.type,t!==null&&e.stateNode!=null)ZS(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(q(166));return Et(e),null}if(t=Xi(pr.current),Qa(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[ur]=e,r[$l]=s,t=(e.mode&1)!==0,n){case"dialog":Me("cancel",r),Me("close",r);break;case"iframe":case"object":case"embed":Me("load",r);break;case"video":case"audio":for(i=0;i<ll.length;i++)Me(ll[i],r);break;case"source":Me("error",r);break;case"img":case"image":case"link":Me("error",r),Me("load",r);break;case"details":Me("toggle",r);break;case"input":Dm(r,s),Me("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Me("invalid",r);break;case"textarea":Pm(r,s),Me("invalid",r)}id(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&Ya(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Ya(r.textContent,l,t),i=["children",""+l]):Dl.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Me("scroll",r)}switch(n){case"input":ja(r),Bm(r,s,!0);break;case"textarea":ja(r),Lm(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Ku)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=xw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[ur]=e,t[$l]=r,QS(t,e,!1,!1),e.stateNode=t;e:{switch(o=sd(n,r),n){case"dialog":Me("cancel",t),Me("close",t),i=r;break;case"iframe":case"object":case"embed":Me("load",t),i=r;break;case"video":case"audio":for(i=0;i<ll.length;i++)Me(ll[i],t);i=r;break;case"source":Me("error",t),i=r;break;case"img":case"image":case"link":Me("error",t),Me("load",t),i=r;break;case"details":Me("toggle",t),i=r;break;case"input":Dm(t,r),i=Xh(t,r),Me("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=je({},r,{value:void 0}),Me("invalid",t);break;case"textarea":Pm(t,r),i=nd(t,r),Me("invalid",t);break;default:i=r}id(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var a=l[s];s==="style"?Ow(t,a):s==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&Tw(t,a)):s==="children"?typeof a=="string"?(n!=="textarea"||a!=="")&&Bl(t,a):typeof a=="number"&&Bl(t,""+a):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Dl.hasOwnProperty(s)?a!=null&&s==="onScroll"&&Me("scroll",t):a!=null&&Vp(t,s,a,o))}switch(n){case"input":ja(t),Bm(t,r,!1);break;case"textarea":ja(t),Lm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ii(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?oo(t,!!r.multiple,s,!1):r.defaultValue!=null&&oo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Ku)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Et(e),null;case 6:if(t&&e.stateNode!=null)XS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(q(166));if(n=Xi(ql.current),Xi(pr.current),Qa(e)){if(r=e.stateNode,n=e.memoizedProps,r[ur]=e,(s=r.nodeValue!==n)&&(t=fn,t!==null))switch(t.tag){case 3:Ya(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ya(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ur]=e,e.stateNode=r}return Et(e),null;case 13:if(De(ze),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Fe&&cn!==null&&e.mode&1&&!(e.flags&128))mS(),Eo(),e.flags|=98560,s=!1;else if(s=Qa(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(q(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(q(317));s[ur]=e}else Eo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Et(e),s=!1}else Wn!==null&&(Ud(Wn),Wn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ze.current&1?tt===0&&(tt=3):Eg())),e.updateQueue!==null&&(e.flags|=4),Et(e),null);case 4:return bo(),Ad(t,e),t===null&&jl(e.stateNode.containerInfo),Et(e),null;case 10:return og(e.type._context),Et(e),null;case 17:return nn(e.type)&&Gu(),Et(e),null;case 19:if(De(ze),s=e.memoizedState,s===null)return Et(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)el(s,!1);else{if(tt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=tc(t),o!==null){for(e.flags|=128,el(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Re(ze,ze.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ge()>To&&(e.flags|=128,r=!0,el(s,!1),e.lanes=4194304)}else{if(!r)if(t=tc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),el(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Fe)return Et(e),null}else 2*Ge()-s.renderingStartTime>To&&n!==1073741824&&(e.flags|=128,r=!0,el(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ge(),e.sibling=null,n=ze.current,Re(ze,r?n&1|2:n&1),e):(Et(e),null);case 22:case 23:return _g(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?an&1073741824&&(Et(e),e.subtreeFlags&6&&(e.flags|=8192)):Et(e),null;case 24:return null;case 25:return null}throw Error(q(156,e.tag))}function jx(t,e){switch(ng(e),e.tag){case 1:return nn(e.type)&&Gu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return bo(),De(tn),De(Rt),fg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return cg(e),null;case 13:if(De(ze),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(q(340));Eo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return De(ze),null;case 4:return bo(),null;case 10:return og(e.type._context),null;case 22:case 23:return _g(),null;case 24:return null;default:return null}}var eu=!1,xt=!1,Hx=typeof WeakSet=="function"?WeakSet:Set,X=null;function eo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){He(t,e,r)}else n.current=null}function Nd(t,e,n){try{n()}catch(r){He(t,e,r)}}var x0=!1;function $x(t,e){if(gd=$u,t=rS(),eg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,l=-1,a=-1,u=0,c=0,f=t,h=null;t:for(;;){for(var p;f!==n||i!==0&&f.nodeType!==3||(l=o+i),f!==s||r!==0&&f.nodeType!==3||(a=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===t)break t;if(h===n&&++u===i&&(l=o),h===s&&++c===r&&(a=o),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}n=l===-1||a===-1?null:{start:l,end:a}}else n=null}n=n||{start:0,end:0}}else n=null;for(md={focusedElem:t,selectionRange:n},$u=!1,X=e;X!==null;)if(e=X,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,X=t;else for(;X!==null;){e=X;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var v=m.memoizedProps,C=m.memoizedState,y=e.stateNode,_=y.getSnapshotBeforeUpdate(e.elementType===e.type?v:Hn(e.type,v),C);y.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(q(163))}}catch(O){He(e,e.return,O)}if(t=e.sibling,t!==null){t.return=e.return,X=t;break}X=e.return}return m=x0,x0=!1,m}function wl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Nd(e,n,s)}i=i.next}while(i!==r)}}function Yc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Md(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function ev(t){var e=t.alternate;e!==null&&(t.alternate=null,ev(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ur],delete e[$l],delete e[Sd],delete e[xx],delete e[Tx])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function tv(t){return t.tag===5||t.tag===3||t.tag===4}function T0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||tv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Dd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ku));else if(r!==4&&(t=t.child,t!==null))for(Dd(t,e,n),t=t.sibling;t!==null;)Dd(t,e,n),t=t.sibling}function Bd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Bd(t,e,n),t=t.sibling;t!==null;)Bd(t,e,n),t=t.sibling}var dt=null,$n=!1;function Zr(t,e,n){for(n=n.child;n!==null;)nv(t,e,n),n=n.sibling}function nv(t,e,n){if(dr&&typeof dr.onCommitFiberUnmount=="function")try{dr.onCommitFiberUnmount(jc,n)}catch{}switch(n.tag){case 5:xt||eo(n,e);case 6:var r=dt,i=$n;dt=null,Zr(t,e,n),dt=r,$n=i,dt!==null&&($n?(t=dt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):dt.removeChild(n.stateNode));break;case 18:dt!==null&&($n?(t=dt,n=n.stateNode,t.nodeType===8?$f(t.parentNode,n):t.nodeType===1&&$f(t,n),Ul(t)):$f(dt,n.stateNode));break;case 4:r=dt,i=$n,dt=n.stateNode.containerInfo,$n=!0,Zr(t,e,n),dt=r,$n=i;break;case 0:case 11:case 14:case 15:if(!xt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Nd(n,e,o),i=i.next}while(i!==r)}Zr(t,e,n);break;case 1:if(!xt&&(eo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){He(n,e,l)}Zr(t,e,n);break;case 21:Zr(t,e,n);break;case 22:n.mode&1?(xt=(r=xt)||n.memoizedState!==null,Zr(t,e,n),xt=r):Zr(t,e,n);break;default:Zr(t,e,n)}}function I0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Hx),e.forEach(function(r){var i=Xx.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Vn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:dt=l.stateNode,$n=!1;break e;case 3:dt=l.stateNode.containerInfo,$n=!0;break e;case 4:dt=l.stateNode.containerInfo,$n=!0;break e}l=l.return}if(dt===null)throw Error(q(160));nv(s,o,i),dt=null,$n=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(u){He(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)rv(e,t),e=e.sibling}function rv(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Vn(e,t),sr(t),r&4){try{wl(3,t,t.return),Yc(3,t)}catch(v){He(t,t.return,v)}try{wl(5,t,t.return)}catch(v){He(t,t.return,v)}}break;case 1:Vn(e,t),sr(t),r&512&&n!==null&&eo(n,n.return);break;case 5:if(Vn(e,t),sr(t),r&512&&n!==null&&eo(n,n.return),t.flags&32){var i=t.stateNode;try{Bl(i,"")}catch(v){He(t,t.return,v)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,l=t.type,a=t.updateQueue;if(t.updateQueue=null,a!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&Cw(i,s),sd(l,o);var u=sd(l,s);for(o=0;o<a.length;o+=2){var c=a[o],f=a[o+1];c==="style"?Ow(i,f):c==="dangerouslySetInnerHTML"?Tw(i,f):c==="children"?Bl(i,f):Vp(i,c,f,u)}switch(l){case"input":ed(i,s);break;case"textarea":bw(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?oo(i,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?oo(i,!!s.multiple,s.defaultValue,!0):oo(i,!!s.multiple,s.multiple?[]:"",!1))}i[$l]=s}catch(v){He(t,t.return,v)}}break;case 6:if(Vn(e,t),sr(t),r&4){if(t.stateNode===null)throw Error(q(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(v){He(t,t.return,v)}}break;case 3:if(Vn(e,t),sr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ul(e.containerInfo)}catch(v){He(t,t.return,v)}break;case 4:Vn(e,t),sr(t);break;case 13:Vn(e,t),sr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(vg=Ge())),r&4&&I0(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(xt=(u=xt)||c,Vn(e,t),xt=u):Vn(e,t),sr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(X=t,c=t.child;c!==null;){for(f=X=c;X!==null;){switch(h=X,p=h.child,h.tag){case 0:case 11:case 14:case 15:wl(4,h,h.return);break;case 1:eo(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(v){He(r,n,v)}}break;case 5:eo(h,h.return);break;case 22:if(h.memoizedState!==null){R0(f);continue}}p!==null?(p.return=h,X=p):R0(f)}c=c.sibling}e:for(c=null,f=t;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,a=f.memoizedProps.style,o=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=Iw("display",o))}catch(v){He(t,t.return,v)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(v){He(t,t.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Vn(e,t),sr(t),r&4&&I0(t);break;case 21:break;default:Vn(e,t),sr(t)}}function sr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(tv(n)){var r=n;break e}n=n.return}throw Error(q(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Bl(i,""),r.flags&=-33);var s=T0(t);Bd(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=T0(t);Dd(t,l,o);break;default:throw Error(q(161))}}catch(a){He(t,t.return,a)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Wx(t,e,n){X=t,iv(t)}function iv(t,e,n){for(var r=(t.mode&1)!==0;X!==null;){var i=X,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||eu;if(!o){var l=i.alternate,a=l!==null&&l.memoizedState!==null||xt;l=eu;var u=xt;if(eu=o,(xt=a)&&!u)for(X=i;X!==null;)o=X,a=o.child,o.tag===22&&o.memoizedState!==null?A0(i):a!==null?(a.return=o,X=a):A0(i);for(;s!==null;)X=s,iv(s),s=s.sibling;X=i,eu=l,xt=u}O0(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,X=s):O0(t)}}function O0(t){for(;X!==null;){var e=X;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:xt||Yc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!xt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Hn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&h0(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}h0(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&n.focus();break;case"img":a.src&&(n.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&Ul(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(q(163))}xt||e.flags&512&&Md(e)}catch(h){He(e,e.return,h)}}if(e===t){X=null;break}if(n=e.sibling,n!==null){n.return=e.return,X=n;break}X=e.return}}function R0(t){for(;X!==null;){var e=X;if(e===t){X=null;break}var n=e.sibling;if(n!==null){n.return=e.return,X=n;break}X=e.return}}function A0(t){for(;X!==null;){var e=X;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Yc(4,e)}catch(a){He(e,n,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(a){He(e,i,a)}}var s=e.return;try{Md(e)}catch(a){He(e,s,a)}break;case 5:var o=e.return;try{Md(e)}catch(a){He(e,o,a)}}}catch(a){He(e,e.return,a)}if(e===t){X=null;break}var l=e.sibling;if(l!==null){l.return=e.return,X=l;break}X=e.return}}var qx=Math.ceil,ic=qr.ReactCurrentDispatcher,wg=qr.ReactCurrentOwner,Nn=qr.ReactCurrentBatchConfig,we=0,ct=null,Ye=null,mt=0,an=0,to=Li(0),tt=0,Yl=null,ws=0,Qc=0,Sg=0,Sl=null,Yt=null,vg=0,To=1/0,Or=null,sc=!1,Pd=null,vi=null,tu=!1,ci=null,oc=0,vl=0,Ld=null,Cu=-1,bu=0;function zt(){return we&6?Ge():Cu!==-1?Cu:Cu=Ge()}function ki(t){return t.mode&1?we&2&&mt!==0?mt&-mt:Ox.transition!==null?(bu===0&&(bu=Vw()),bu):(t=Ee,t!==0||(t=window.event,t=t===void 0?16:Gw(t.type)),t):1}function Qn(t,e,n,r){if(50<vl)throw vl=0,Ld=null,Error(q(185));va(t,n,r),(!(we&2)||t!==ct)&&(t===ct&&(!(we&2)&&(Qc|=n),tt===4&&si(t,mt)),rn(t,r),n===1&&we===0&&!(e.mode&1)&&(To=Ge()+500,Kc&&Fi()))}function rn(t,e){var n=t.callbackNode;Ob(t,e);var r=Hu(t,t===ct?mt:0);if(r===0)n!==null&&zm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&zm(n),e===1)t.tag===0?Ix(N0.bind(null,t)):dS(N0.bind(null,t)),Cx(function(){!(we&6)&&Fi()}),n=null;else{switch(jw(r)){case 1:n=qp;break;case 4:n=Uw;break;case 16:n=ju;break;case 536870912:n=zw;break;default:n=ju}n=hv(n,sv.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function sv(t,e){if(Cu=-1,bu=0,we&6)throw Error(q(327));var n=t.callbackNode;if(fo()&&t.callbackNode!==n)return null;var r=Hu(t,t===ct?mt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=lc(t,r);else{e=r;var i=we;we|=2;var s=lv();(ct!==t||mt!==e)&&(Or=null,To=Ge()+500,is(t,e));do try{Jx();break}catch(l){ov(t,l)}while(!0);sg(),ic.current=s,we=i,Ye!==null?e=0:(ct=null,mt=0,e=tt)}if(e!==0){if(e===2&&(i=cd(t),i!==0&&(r=i,e=Fd(t,i))),e===1)throw n=Yl,is(t,0),si(t,r),rn(t,Ge()),n;if(e===6)si(t,r);else{if(i=t.current.alternate,!(r&30)&&!Kx(i)&&(e=lc(t,r),e===2&&(s=cd(t),s!==0&&(r=s,e=Fd(t,s))),e===1))throw n=Yl,is(t,0),si(t,r),rn(t,Ge()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(q(345));case 2:Gi(t,Yt,Or);break;case 3:if(si(t,r),(r&130023424)===r&&(e=vg+500-Ge(),10<e)){if(Hu(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){zt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=wd(Gi.bind(null,t,Yt,Or),e);break}Gi(t,Yt,Or);break;case 4:if(si(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Yn(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Ge()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*qx(r/1960))-r,10<r){t.timeoutHandle=wd(Gi.bind(null,t,Yt,Or),r);break}Gi(t,Yt,Or);break;case 5:Gi(t,Yt,Or);break;default:throw Error(q(329))}}}return rn(t,Ge()),t.callbackNode===n?sv.bind(null,t):null}function Fd(t,e){var n=Sl;return t.current.memoizedState.isDehydrated&&(is(t,e).flags|=256),t=lc(t,e),t!==2&&(e=Yt,Yt=n,e!==null&&Ud(e)),t}function Ud(t){Yt===null?Yt=t:Yt.push.apply(Yt,t)}function Kx(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Xn(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function si(t,e){for(e&=~Sg,e&=~Qc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Yn(e),r=1<<n;t[n]=-1,e&=~r}}function N0(t){if(we&6)throw Error(q(327));fo();var e=Hu(t,0);if(!(e&1))return rn(t,Ge()),null;var n=lc(t,e);if(t.tag!==0&&n===2){var r=cd(t);r!==0&&(e=r,n=Fd(t,r))}if(n===1)throw n=Yl,is(t,0),si(t,e),rn(t,Ge()),n;if(n===6)throw Error(q(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Gi(t,Yt,Or),rn(t,Ge()),null}function kg(t,e){var n=we;we|=1;try{return t(e)}finally{we=n,we===0&&(To=Ge()+500,Kc&&Fi())}}function Ss(t){ci!==null&&ci.tag===0&&!(we&6)&&fo();var e=we;we|=1;var n=Nn.transition,r=Ee;try{if(Nn.transition=null,Ee=1,t)return t()}finally{Ee=r,Nn.transition=n,we=e,!(we&6)&&Fi()}}function _g(){an=to.current,De(to)}function is(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Ex(n)),Ye!==null)for(n=Ye.return;n!==null;){var r=n;switch(ng(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Gu();break;case 3:bo(),De(tn),De(Rt),fg();break;case 5:cg(r);break;case 4:bo();break;case 13:De(ze);break;case 19:De(ze);break;case 10:og(r.type._context);break;case 22:case 23:_g()}n=n.return}if(ct=t,Ye=t=_i(t.current,null),mt=an=e,tt=0,Yl=null,Sg=Qc=ws=0,Yt=Sl=null,Zi!==null){for(e=0;e<Zi.length;e++)if(n=Zi[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Zi=null}return t}function ov(t,e){do{var n=Ye;try{if(sg(),ku.current=rc,nc){for(var r=Ve.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}nc=!1}if(ys=0,at=et=Ve=null,yl=!1,Kl=0,wg.current=null,n===null||n.return===null){tt=1,Yl=e,Ye=null;break}e:{var s=t,o=n.return,l=n,a=e;if(e=mt,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var u=a,c=l,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=S0(o);if(p!==null){p.flags&=-257,v0(p,o,l,s,e),p.mode&1&&w0(s,u,e),e=p,a=u;var m=e.updateQueue;if(m===null){var v=new Set;v.add(a),e.updateQueue=v}else m.add(a);break e}else{if(!(e&1)){w0(s,u,e),Eg();break e}a=Error(q(426))}}else if(Fe&&l.mode&1){var C=S0(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),v0(C,o,l,s,e),rg(xo(a,l));break e}}s=a=xo(a,l),tt!==4&&(tt=2),Sl===null?Sl=[s]:Sl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=HS(s,a,e);f0(s,y);break e;case 1:l=a;var _=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(vi===null||!vi.has(x)))){s.flags|=65536,e&=-e,s.lanes|=e;var O=$S(s,l,e);f0(s,O);break e}}s=s.return}while(s!==null)}uv(n)}catch(R){e=R,Ye===n&&n!==null&&(Ye=n=n.return);continue}break}while(!0)}function lv(){var t=ic.current;return ic.current=rc,t===null?rc:t}function Eg(){(tt===0||tt===3||tt===2)&&(tt=4),ct===null||!(ws&268435455)&&!(Qc&268435455)||si(ct,mt)}function lc(t,e){var n=we;we|=2;var r=lv();(ct!==t||mt!==e)&&(Or=null,is(t,e));do try{Gx();break}catch(i){ov(t,i)}while(!0);if(sg(),we=n,ic.current=r,Ye!==null)throw Error(q(261));return ct=null,mt=0,tt}function Gx(){for(;Ye!==null;)av(Ye)}function Jx(){for(;Ye!==null&&!vb();)av(Ye)}function av(t){var e=fv(t.alternate,t,an);t.memoizedProps=t.pendingProps,e===null?uv(t):Ye=e,wg.current=null}function uv(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=jx(n,e),n!==null){n.flags&=32767,Ye=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{tt=6,Ye=null;return}}else if(n=Vx(n,e,an),n!==null){Ye=n;return}if(e=e.sibling,e!==null){Ye=e;return}Ye=e=t}while(e!==null);tt===0&&(tt=5)}function Gi(t,e,n){var r=Ee,i=Nn.transition;try{Nn.transition=null,Ee=1,Yx(t,e,n,r)}finally{Nn.transition=i,Ee=r}return null}function Yx(t,e,n,r){do fo();while(ci!==null);if(we&6)throw Error(q(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(q(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(Rb(t,s),t===ct&&(Ye=ct=null,mt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||tu||(tu=!0,hv(ju,function(){return fo(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Nn.transition,Nn.transition=null;var o=Ee;Ee=1;var l=we;we|=4,wg.current=null,$x(t,n),rv(n,t),mx(md),$u=!!gd,md=gd=null,t.current=n,Wx(n),kb(),we=l,Ee=o,Nn.transition=s}else t.current=n;if(tu&&(tu=!1,ci=t,oc=i),s=t.pendingLanes,s===0&&(vi=null),Cb(n.stateNode),rn(t,Ge()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(sc)throw sc=!1,t=Pd,Pd=null,t;return oc&1&&t.tag!==0&&fo(),s=t.pendingLanes,s&1?t===Ld?vl++:(vl=0,Ld=t):vl=0,Fi(),null}function fo(){if(ci!==null){var t=jw(oc),e=Nn.transition,n=Ee;try{if(Nn.transition=null,Ee=16>t?16:t,ci===null)var r=!1;else{if(t=ci,ci=null,oc=0,we&6)throw Error(q(331));var i=we;for(we|=4,X=t.current;X!==null;){var s=X,o=s.child;if(X.flags&16){var l=s.deletions;if(l!==null){for(var a=0;a<l.length;a++){var u=l[a];for(X=u;X!==null;){var c=X;switch(c.tag){case 0:case 11:case 15:wl(8,c,s)}var f=c.child;if(f!==null)f.return=c,X=f;else for(;X!==null;){c=X;var h=c.sibling,p=c.return;if(ev(c),c===u){X=null;break}if(h!==null){h.return=p,X=h;break}X=p}}}var m=s.alternate;if(m!==null){var v=m.child;if(v!==null){m.child=null;do{var C=v.sibling;v.sibling=null,v=C}while(v!==null)}}X=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,X=o;else e:for(;X!==null;){if(s=X,s.flags&2048)switch(s.tag){case 0:case 11:case 15:wl(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,X=y;break e}X=s.return}}var _=t.current;for(X=_;X!==null;){o=X;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,X=x;else e:for(o=_;X!==null;){if(l=X,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Yc(9,l)}}catch(R){He(l,l.return,R)}if(l===o){X=null;break e}var O=l.sibling;if(O!==null){O.return=l.return,X=O;break e}X=l.return}}if(we=i,Fi(),dr&&typeof dr.onPostCommitFiberRoot=="function")try{dr.onPostCommitFiberRoot(jc,t)}catch{}r=!0}return r}finally{Ee=n,Nn.transition=e}}return!1}function M0(t,e,n){e=xo(n,e),e=HS(t,e,1),t=Si(t,e,1),e=zt(),t!==null&&(va(t,1,e),rn(t,e))}function He(t,e,n){if(t.tag===3)M0(t,t,n);else for(;e!==null;){if(e.tag===3){M0(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(vi===null||!vi.has(r))){t=xo(n,t),t=$S(e,t,1),e=Si(e,t,1),t=zt(),e!==null&&(va(e,1,t),rn(e,t));break}}e=e.return}}function Qx(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=zt(),t.pingedLanes|=t.suspendedLanes&n,ct===t&&(mt&n)===n&&(tt===4||tt===3&&(mt&130023424)===mt&&500>Ge()-vg?is(t,0):Sg|=n),rn(t,e)}function cv(t,e){e===0&&(t.mode&1?(e=Wa,Wa<<=1,!(Wa&130023424)&&(Wa=4194304)):e=1);var n=zt();t=Vr(t,e),t!==null&&(va(t,e,n),rn(t,n))}function Zx(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),cv(t,n)}function Xx(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(q(314))}r!==null&&r.delete(e),cv(t,n)}var fv;fv=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||tn.current)Xt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Xt=!1,zx(t,e,n);Xt=!!(t.flags&131072)}else Xt=!1,Fe&&e.flags&1048576&&pS(e,Qu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Eu(t,e),t=e.pendingProps;var i=_o(e,Rt.current);co(e,n),i=dg(null,e,r,t,i,n);var s=pg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,nn(r)?(s=!0,Ju(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,ag(e),i.updater=Gc,e.stateNode=i,i._reactInternals=e,bd(e,r,t,n),e=Id(null,e,r,!0,s,n)):(e.tag=0,Fe&&s&&tg(e),Pt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Eu(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=tT(r),t=Hn(r,t),i){case 0:e=Td(null,e,r,t,n);break e;case 1:e=E0(null,e,r,t,n);break e;case 11:e=k0(null,e,r,t,n);break e;case 14:e=_0(null,e,r,Hn(r.type,t),n);break e}throw Error(q(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hn(r,i),Td(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hn(r,i),E0(t,e,r,i,n);case 3:e:{if(GS(e),t===null)throw Error(q(387));r=e.pendingProps,s=e.memoizedState,i=s.element,wS(t,e),ec(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=xo(Error(q(423)),e),e=C0(t,e,r,n,i);break e}else if(r!==i){i=xo(Error(q(424)),e),e=C0(t,e,r,n,i);break e}else for(cn=wi(e.stateNode.containerInfo.firstChild),fn=e,Fe=!0,Wn=null,n=_S(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Eo(),r===i){e=jr(t,e,n);break e}Pt(t,e,r,n)}e=e.child}return e;case 5:return ES(e),t===null&&_d(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,yd(r,i)?o=null:s!==null&&yd(r,s)&&(e.flags|=32),KS(t,e),Pt(t,e,o,n),e.child;case 6:return t===null&&_d(e),null;case 13:return JS(t,e,n);case 4:return ug(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Co(e,null,r,n):Pt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hn(r,i),k0(t,e,r,i,n);case 7:return Pt(t,e,e.pendingProps,n),e.child;case 8:return Pt(t,e,e.pendingProps.children,n),e.child;case 12:return Pt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Re(Zu,r._currentValue),r._currentValue=o,s!==null)if(Xn(s.value,o)){if(s.children===i.children&&!tn.current){e=jr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var a=l.firstContext;a!==null;){if(a.context===r){if(s.tag===1){a=Pr(-1,n&-n),a.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?a.next=a:(a.next=c.next,c.next=a),u.pending=a}}s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),Ed(s.return,n,e),l.lanes|=n;break}a=a.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(q(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Ed(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Pt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,co(e,n),i=Dn(i),r=r(i),e.flags|=1,Pt(t,e,r,n),e.child;case 14:return r=e.type,i=Hn(r,e.pendingProps),i=Hn(r.type,i),_0(t,e,r,i,n);case 15:return WS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Hn(r,i),Eu(t,e),e.tag=1,nn(r)?(t=!0,Ju(e)):t=!1,co(e,n),vS(e,r,i),bd(e,r,i,n),Id(null,e,r,!0,t,n);case 19:return YS(t,e,n);case 22:return qS(t,e,n)}throw Error(q(156,e.tag))};function hv(t,e){return Fw(t,e)}function eT(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function An(t,e,n,r){return new eT(t,e,n,r)}function Cg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function tT(t){if(typeof t=="function")return Cg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Hp)return 11;if(t===$p)return 14}return 2}function _i(t,e){var n=t.alternate;return n===null?(n=An(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function xu(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Cg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ws:return ss(n.children,i,s,e);case jp:o=8,i|=8;break;case Jh:return t=An(12,n,e,i|2),t.elementType=Jh,t.lanes=s,t;case Yh:return t=An(13,n,e,i),t.elementType=Yh,t.lanes=s,t;case Qh:return t=An(19,n,e,i),t.elementType=Qh,t.lanes=s,t;case kw:return Zc(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Sw:o=10;break e;case vw:o=9;break e;case Hp:o=11;break e;case $p:o=14;break e;case ei:o=16,r=null;break e}throw Error(q(130,t==null?t:typeof t,""))}return e=An(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function ss(t,e,n,r){return t=An(7,t,r,e),t.lanes=n,t}function Zc(t,e,n,r){return t=An(22,t,r,e),t.elementType=kw,t.lanes=n,t.stateNode={isHidden:!1},t}function Zf(t,e,n){return t=An(6,t,null,e),t.lanes=n,t}function Xf(t,e,n){return e=An(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function nT(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Mf(0),this.expirationTimes=Mf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mf(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function bg(t,e,n,r,i,s,o,l,a){return t=new nT(t,e,n,l,a),e===1?(e=1,s===!0&&(e|=8)):e=0,s=An(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ag(s),t}function rT(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$s,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function dv(t){if(!t)return Oi;t=t._reactInternals;e:{if(As(t)!==t||t.tag!==1)throw Error(q(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(nn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(q(171))}if(t.tag===1){var n=t.type;if(nn(n))return hS(t,n,e)}return e}function pv(t,e,n,r,i,s,o,l,a){return t=bg(n,r,!0,t,i,s,o,l,a),t.context=dv(null),n=t.current,r=zt(),i=ki(n),s=Pr(r,i),s.callback=e??null,Si(n,s,i),t.current.lanes=i,va(t,i,r),rn(t,r),t}function Xc(t,e,n,r){var i=e.current,s=zt(),o=ki(i);return n=dv(n),e.context===null?e.context=n:e.pendingContext=n,e=Pr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Si(i,e,o),t!==null&&(Qn(t,i,o,s),vu(t,i,o)),o}function ac(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function D0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function xg(t,e){D0(t,e),(t=t.alternate)&&D0(t,e)}function iT(){return null}var gv=typeof reportError=="function"?reportError:function(t){console.error(t)};function Tg(t){this._internalRoot=t}ef.prototype.render=Tg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(q(409));Xc(t,e,null,null)};ef.prototype.unmount=Tg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ss(function(){Xc(null,t,null,null)}),e[zr]=null}};function ef(t){this._internalRoot=t}ef.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ww();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ii.length&&e!==0&&e<ii[n].priority;n++);ii.splice(n,0,t),n===0&&Kw(t)}};function Ig(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function tf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function B0(){}function sT(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=ac(o);s.call(u)}}var o=pv(e,r,t,0,null,!1,!1,"",B0);return t._reactRootContainer=o,t[zr]=o.current,jl(t.nodeType===8?t.parentNode:t),Ss(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=ac(a);l.call(u)}}var a=bg(t,0,!1,null,null,!1,!1,"",B0);return t._reactRootContainer=a,t[zr]=a.current,jl(t.nodeType===8?t.parentNode:t),Ss(function(){Xc(e,a,n,r)}),a}function nf(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var a=ac(o);l.call(a)}}Xc(e,o,t,i)}else o=sT(n,e,t,i,r);return ac(o)}Hw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ol(e.pendingLanes);n!==0&&(Kp(e,n|1),rn(e,Ge()),!(we&6)&&(To=Ge()+500,Fi()))}break;case 13:Ss(function(){var r=Vr(t,1);if(r!==null){var i=zt();Qn(r,t,1,i)}}),xg(t,1)}};Gp=function(t){if(t.tag===13){var e=Vr(t,134217728);if(e!==null){var n=zt();Qn(e,t,134217728,n)}xg(t,134217728)}};$w=function(t){if(t.tag===13){var e=ki(t),n=Vr(t,e);if(n!==null){var r=zt();Qn(n,t,e,r)}xg(t,e)}};Ww=function(){return Ee};qw=function(t,e){var n=Ee;try{return Ee=t,e()}finally{Ee=n}};ld=function(t,e,n){switch(e){case"input":if(ed(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=qc(r);if(!i)throw Error(q(90));Ew(r),ed(r,i)}}}break;case"textarea":bw(t,n);break;case"select":e=n.value,e!=null&&oo(t,!!n.multiple,e,!1)}};Nw=kg;Mw=Ss;var oT={usingClientEntryPoint:!1,Events:[_a,Js,qc,Rw,Aw,kg]},tl={findFiberByHostInstance:Qi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},lT={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:qr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Pw(t),t===null?null:t.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||iT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{jc=nu.inject(lT),dr=nu}catch{}}yn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oT;yn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ig(e))throw Error(q(200));return rT(t,e,null,n)};yn.createRoot=function(t,e){if(!Ig(t))throw Error(q(299));var n=!1,r="",i=gv;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=bg(t,1,!1,null,null,n,!1,r,i),t[zr]=e.current,jl(t.nodeType===8?t.parentNode:t),new Tg(e)};yn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(q(188)):(t=Object.keys(t).join(","),Error(q(268,t)));return t=Pw(e),t=t===null?null:t.stateNode,t};yn.flushSync=function(t){return Ss(t)};yn.hydrate=function(t,e,n){if(!tf(e))throw Error(q(200));return nf(null,t,e,!0,n)};yn.hydrateRoot=function(t,e,n){if(!Ig(t))throw Error(q(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=gv;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=pv(e,null,t,1,n??null,i,!1,s,o),t[zr]=e.current,jl(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new ef(e)};yn.render=function(t,e,n){if(!tf(e))throw Error(q(200));return nf(null,t,e,!1,n)};yn.unmountComponentAtNode=function(t){if(!tf(t))throw Error(q(40));return t._reactRootContainer?(Ss(function(){nf(null,null,t,!1,function(){t._reactRootContainer=null,t[zr]=null})}),!0):!1};yn.unstable_batchedUpdates=kg;yn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!tf(n))throw Error(q(200));if(t==null||t._reactInternals===void 0)throw Error(q(38));return nf(t,e,n,!1,r)};yn.version="18.2.0-next-9e3b772b8-20220608";function mv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(mv)}catch(t){console.error(t)}}mv(),pw.exports=yn;var aT=pw.exports,P0=aT;Kh.createRoot=P0.createRoot,Kh.hydrateRoot=P0.hydrateRoot;const Vt=()=>new Map,zd=t=>{const e=Vt();return t.forEach((n,r)=>{e.set(r,n)}),e},vr=(t,e,n)=>{let r=t.get(e);return r===void 0&&t.set(e,r=n()),r},uT=(t,e)=>{const n=[];for(const[r,i]of t)n.push(e(i,r));return n},cT=(t,e)=>{for(const[n,r]of t)if(e(r,n))return!0;return!1},Ri=()=>new Set,eh=t=>t[t.length-1],fT=(t,e)=>{for(let n=0;n<e.length;n++)t.push(e[n])},Hr=Array.from,hT=(t,e)=>{for(let n=0;n<t.length;n++)if(e(t[n],n,t))return!0;return!1},Vd=Array.isArray;class Og{constructor(){this._observers=Vt()}on(e,n){return vr(this._observers,e,Ri).add(n),n}once(e,n){const r=(...i)=>{this.off(e,r),n(...i)};this.on(e,r)}off(e,n){const r=this._observers.get(e);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(e))}emit(e,n){return Hr((this._observers.get(e)||Vt()).values()).forEach(r=>r(...n))}destroy(){this._observers=Vt()}}class dT{constructor(){this._observers=Vt()}on(e,n){vr(this._observers,e,Ri).add(n)}once(e,n){const r=(...i)=>{this.off(e,r),n(...i)};this.on(e,r)}off(e,n){const r=this._observers.get(e);r!==void 0&&(r.delete(n),r.size===0&&this._observers.delete(e))}emit(e,n){return Hr((this._observers.get(e)||Vt()).values()).forEach(r=>r(...n))}destroy(){this._observers=Vt()}}const gr=Math.floor,Tu=Math.abs,ls=(t,e)=>t<e?t:e,$r=(t,e)=>t>e?t:e,yv=t=>t!==0?t<0:1/t<0,L0=1,F0=2,th=4,nh=8,Ql=32,Lr=64,hn=128,rf=31,jd=63,as=127,pT=2147483647,wv=Number.MAX_SAFE_INTEGER,gT=Number.isInteger||(t=>typeof t=="number"&&isFinite(t)&&gr(t)===t),mT=t=>t.toLowerCase(),yT=/^\s*/g,wT=t=>t.replace(yT,""),ST=/([A-Z])/g,U0=(t,e)=>wT(t.replace(ST,n=>`${e}${mT(n)}`)),vT=t=>{const e=unescape(encodeURIComponent(t)),n=e.length,r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=e.codePointAt(i);return r},Zl=typeof TextEncoder<"u"?new TextEncoder:null,kT=t=>Zl.encode(t),_T=Zl?kT:vT;let kl=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});kl&&kl.decode(new Uint8Array).length===1&&(kl=null);class Ca{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const mr=()=>new Ca,Sv=t=>{let e=t.cpos;for(let n=0;n<t.bufs.length;n++)e+=t.bufs[n].length;return e},Ot=t=>{const e=new Uint8Array(Sv(t));let n=0;for(let r=0;r<t.bufs.length;r++){const i=t.bufs[r];e.set(i,n),n+=i.length}return e.set(new Uint8Array(t.cbuf.buffer,0,t.cpos),n),e},ET=(t,e)=>{const n=t.cbuf.length;n-t.cpos<e&&(t.bufs.push(new Uint8Array(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array($r(n,e)*2),t.cpos=0)},lt=(t,e)=>{const n=t.cbuf.length;t.cpos===n&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(n*2),t.cpos=0),t.cbuf[t.cpos++]=e},Hd=lt,ie=(t,e)=>{for(;e>as;)lt(t,hn|as&e),e=gr(e/128);lt(t,as&e)},Rg=(t,e)=>{const n=yv(e);for(n&&(e=-e),lt(t,(e>jd?hn:0)|(n?Lr:0)|jd&e),e=gr(e/64);e>0;)lt(t,(e>as?hn:0)|as&e),e=gr(e/128)},$d=new Uint8Array(3e4),CT=$d.length/3,bT=(t,e)=>{if(e.length<CT){const n=Zl.encodeInto(e,$d).written||0;ie(t,n);for(let r=0;r<n;r++)lt(t,$d[r])}else Xe(t,_T(e))},xT=(t,e)=>{const n=unescape(encodeURIComponent(e)),r=n.length;ie(t,r);for(let i=0;i<r;i++)lt(t,n.codePointAt(i))},us=Zl&&Zl.encodeInto?bT:xT,sf=(t,e)=>{const n=t.cbuf.length,r=t.cpos,i=ls(n-r,e.length),s=e.length-i;t.cbuf.set(e.subarray(0,i),r),t.cpos+=i,s>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array($r(n*2,s)),t.cbuf.set(e.subarray(i)),t.cpos=s)},Xe=(t,e)=>{ie(t,e.byteLength),sf(t,e)},Ag=(t,e)=>{ET(t,e);const n=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,n},TT=(t,e)=>Ag(t,4).setFloat32(0,e,!1),IT=(t,e)=>Ag(t,8).setFloat64(0,e,!1),OT=(t,e)=>Ag(t,8).setBigInt64(0,e,!1),z0=new DataView(new ArrayBuffer(4)),RT=t=>(z0.setFloat32(0,t),z0.getFloat32(0)===t),Xl=(t,e)=>{switch(typeof e){case"string":lt(t,119),us(t,e);break;case"number":gT(e)&&Tu(e)<=pT?(lt(t,125),Rg(t,e)):RT(e)?(lt(t,124),TT(t,e)):(lt(t,123),IT(t,e));break;case"bigint":lt(t,122),OT(t,e);break;case"object":if(e===null)lt(t,126);else if(Vd(e)){lt(t,117),ie(t,e.length);for(let n=0;n<e.length;n++)Xl(t,e[n])}else if(e instanceof Uint8Array)lt(t,116),Xe(t,e);else{lt(t,118);const n=Object.keys(e);ie(t,n.length);for(let r=0;r<n.length;r++){const i=n[r];us(t,i),Xl(t,e[i])}}break;case"boolean":lt(t,e?120:121);break;default:lt(t,127)}};class V0 extends Ca{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&ie(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const j0=t=>{t.count>0&&(Rg(t.encoder,t.count===1?t.s:-t.s),t.count>1&&ie(t.encoder,t.count-2))};class Iu{constructor(){this.encoder=new Ca,this.s=0,this.count=0}write(e){this.s===e?this.count++:(j0(this),this.count=1,this.s=e)}toUint8Array(){return j0(this),Ot(this.encoder)}}const H0=t=>{if(t.count>0){const e=t.diff*2+(t.count===1?0:1);Rg(t.encoder,e),t.count>1&&ie(t.encoder,t.count-2)}};class rh{constructor(){this.encoder=new Ca,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(H0(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return H0(this),Ot(this.encoder)}}class AT{constructor(){this.sarr=[],this.s="",this.lensE=new Iu}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new Ca;return this.sarr.push(this.s),this.s="",us(e,this.sarr.join("")),sf(e,this.lensE.toUint8Array()),Ot(e)}}const Ai=t=>new Error(t),Zn=()=>{throw Ai("Method unimplemented")},Pn=()=>{throw Ai("Unexpected case")},vv=Ai("Unexpected end of array"),kv=Ai("Integer out of Range");class of{constructor(e){this.arr=e,this.pos=0}}const Ui=t=>new of(t),NT=t=>t.pos!==t.arr.length,MT=(t,e)=>{const n=new Uint8Array(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,n},Ct=t=>MT(t,le(t)),Io=t=>t.arr[t.pos++],le=t=>{let e=0,n=1;const r=t.arr.length;for(;t.pos<r;){const i=t.arr[t.pos++];if(e=e+(i&as)*n,n*=128,i<hn)return e;if(e>wv)throw kv}throw vv},Ng=t=>{let e=t.arr[t.pos++],n=e&jd,r=64;const i=(e&Lr)>0?-1:1;if(!(e&hn))return i*n;const s=t.arr.length;for(;t.pos<s;){if(e=t.arr[t.pos++],n=n+(e&as)*r,r*=128,e<hn)return i*n;if(n>wv)throw kv}throw vv},DT=t=>{let e=le(t);if(e===0)return"";{let n=String.fromCodePoint(Io(t));if(--e<100)for(;e--;)n+=String.fromCodePoint(Io(t));else for(;e>0;){const r=e<1e4?e:1e4,i=t.arr.subarray(t.pos,t.pos+r);t.pos+=r,n+=String.fromCodePoint.apply(null,i),e-=r}return decodeURIComponent(escape(n))}},BT=t=>kl.decode(Ct(t)),Ei=kl?BT:DT,Mg=(t,e)=>{const n=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,n},PT=t=>Mg(t,4).getFloat32(0,!1),LT=t=>Mg(t,8).getFloat64(0,!1),FT=t=>Mg(t,8).getBigInt64(0,!1),UT=[t=>{},t=>null,Ng,PT,LT,FT,t=>!1,t=>!0,Ei,t=>{const e=le(t),n={};for(let r=0;r<e;r++){const i=Ei(t);n[i]=ea(t)}return n},t=>{const e=le(t),n=[];for(let r=0;r<e;r++)n.push(ea(t));return n},Ct],ea=t=>UT[127-Io(t)](t);class $0 extends of{constructor(e,n){super(e),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),NT(this)?this.count=le(this)+1:this.count=-1),this.count--,this.s}}class Ou extends of{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=Ng(this);const e=yv(this.s);this.count=1,e&&(this.s=-this.s,this.count=le(this)+2)}return this.count--,this.s}}class ih extends of{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=Ng(this),n=e&1;this.diff=gr(e/2),this.count=1,n&&(this.count=le(this)+2)}return this.s+=this.diff,this.count--,this.s}}class zT{constructor(e){this.decoder=new Ou(e),this.str=Ei(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),n=this.str.slice(this.spos,e);return this.spos=e,n}}const VT=crypto.getRandomValues.bind(crypto),jT=Math.random,_v=()=>VT(new Uint32Array(1))[0],HT=t=>t[gr(jT()*t.length)],$T="10000000-1000-4000-8000"+-1e11,WT=()=>$T.replace(/[018]/g,t=>(t^_v()&15>>t/4).toString(16)),Ni=Date.now,W0=t=>new Promise(t);Promise.all.bind(Promise);const q0=t=>t===void 0?null:t;class qT{constructor(){this.map=new Map}setItem(e,n){this.map.set(e,n)}getItem(e){return this.map.get(e)}}let Ev=new qT,KT=!0;try{typeof localStorage<"u"&&localStorage&&(Ev=localStorage,KT=!1)}catch{}const GT=Ev,JT=Object.assign,Cv=Object.keys,YT=(t,e)=>{for(const n in t)e(t[n],n)},uc=t=>Cv(t).length,QT=t=>{for(const e in t)return!1;return!0},ZT=(t,e)=>{for(const n in t)if(!e(t[n],n))return!1;return!0},bv=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),XT=(t,e)=>t===e||uc(t)===uc(e)&&ZT(t,(n,r)=>(n!==void 0||bv(e,r))&&e[r]===n),Dg=(t,e,n=0)=>{try{for(;n<t.length;n++)t[n](...e)}finally{n<t.length&&Dg(t,e,n+1)}},eI=t=>t,tI=(t,e)=>t===e,_l=(t,e)=>{if(t==null||e==null)return tI(t,e);if(t.constructor!==e.constructor)return!1;if(t===e)return!0;switch(t.constructor){case ArrayBuffer:t=new Uint8Array(t),e=new Uint8Array(e);case Uint8Array:{if(t.byteLength!==e.byteLength)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;break}case Set:{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;break}case Map:{if(t.size!==e.size)return!1;for(const n of t.keys())if(!e.has(n)||!_l(t.get(n),e.get(n)))return!1;break}case Object:if(uc(t)!==uc(e))return!1;for(const n in t)if(!bv(t,n)||!_l(t[n],e[n]))return!1;break;case Array:if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!_l(t[n],e[n]))return!1;break;default:return!1}return!0},nI=(t,e)=>e.includes(t);var xv={};const Mi=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name)&&Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",rI=typeof window<"u"&&typeof document<"u"&&!Mi;let or;const iI=()=>{if(or===void 0)if(Mi){or=Vt();const t=process.argv;let e=null;for(let n=0;n<t.length;n++){const r=t[n];r[0]==="-"?(e!==null&&or.set(e,""),e=r):e!==null&&(or.set(e,r),e=null)}e!==null&&or.set(e,"")}else typeof location=="object"?(or=Vt(),(location.search||"?").slice(1).split("&").forEach(t=>{if(t.length!==0){const[e,n]=t.split("=");or.set(`--${U0(e,"-")}`,n),or.set(`-${U0(e,"-")}`,n)}})):or=Vt();return or},Wd=t=>iI().has(t),qd=t=>q0(Mi?xv[t.toUpperCase().replaceAll("-","_")]:GT.getItem(t)),sI=t=>Wd("--"+t)||qd(t)!==null;sI("production");const K0=Mi&&nI(xv.FORCE_COLOR,["true","1","2"]),oI=!Wd("no-colors")&&(!Mi||process.stdout.isTTY||K0)&&(!Mi||Wd("color")||K0||qd("COLORTERM")!==null||(qd("TERM")||"").includes("color")),lI=t=>new Uint8Array(t),aI=t=>{const e=lI(t.byteLength);return e.set(t),e};class uI{constructor(e,n){this.left=e,this.right=n}}const br=(t,e)=>new uI(t,e),cI=typeof document<"u"?document:{};typeof DOMParser<"u"&&new DOMParser;const fI=t=>uT(t,(e,n)=>`${n}:${e};`).join(""),hI=t=>class{constructor(n){this._=n}destroy(){t(this._)}},dI=hI(clearTimeout),cc=(t,e)=>new dI(setTimeout(e,t)),Kr=Symbol,Tv=Kr(),Iv=Kr(),pI=Kr(),gI=Kr(),mI=Kr(),Ov=Kr(),yI=Kr(),Bg=Kr(),wI=Kr(),SI=t=>{var r;t.length===1&&((r=t[0])==null?void 0:r.constructor)===Function&&(t=t[0]());const e=[];let n=0;for(;n<t.length;n++){const i=t[n];i===void 0||i.constructor===String||i.constructor===Number||i.constructor===Object&&e.push(JSON.stringify(i))}return e},vI={[Tv]:br("font-weight","bold"),[Iv]:br("font-weight","normal"),[pI]:br("color","blue"),[mI]:br("color","green"),[gI]:br("color","grey"),[Ov]:br("color","red"),[yI]:br("color","purple"),[Bg]:br("color","orange"),[wI]:br("color","black")},kI=t=>{var o;t.length===1&&((o=t[0])==null?void 0:o.constructor)===Function&&(t=t[0]());const e=[],n=[],r=Vt();let i=[],s=0;for(;s<t.length;s++){const l=t[s],a=vI[l];if(a!==void 0)r.set(a.left,a.right);else{if(l===void 0)break;if(l.constructor===String||l.constructor===Number){const u=fI(r);s>0||u.length>0?(e.push("%c"+l),n.push(u)):e.push(l)}else break}}for(s>0&&(i=n,i.unshift(e.join("")));s<t.length;s++){const l=t[s];l instanceof Symbol||i.push(l)}return i},Rv=oI?kI:SI,_I=(...t)=>{console.log(...Rv(t)),Av.forEach(e=>e.print(t))},EI=(...t)=>{console.warn(...Rv(t)),t.unshift(Bg),Av.forEach(e=>e.print(t))},Av=Ri(),Nv=t=>({[Symbol.iterator](){return this},next:t}),CI=(t,e)=>Nv(()=>{let n;do n=t.next();while(!n.done&&!e(n.value));return n}),sh=(t,e)=>Nv(()=>{const{done:n,value:r}=t.next();return{done:n,value:n?void 0:e(r)}});class Pg{constructor(e,n){this.clock=e,this.len=n}}class Uo{constructor(){this.clients=new Map}}const Di=(t,e,n)=>e.clients.forEach((r,i)=>{const s=t.doc.store.clients.get(i);for(let o=0;o<r.length;o++){const l=r[o];Kv(t,s,l.clock,l.len,n)}}),bI=(t,e)=>{let n=0,r=t.length-1;for(;n<=r;){const i=gr((n+r)/2),s=t[i],o=s.clock;if(o<=e){if(e<o+s.len)return i;n=i+1}else r=i-1}return null},zo=(t,e)=>{const n=t.clients.get(e.client);return n!==void 0&&bI(n,e.clock)!==null},Lg=t=>{t.clients.forEach(e=>{e.sort((i,s)=>i.clock-s.clock);let n,r;for(n=1,r=1;n<e.length;n++){const i=e[r-1],s=e[n];i.clock+i.len>=s.clock?i.len=$r(i.len,s.clock+s.len-i.clock):(r<n&&(e[r]=s),r++)}e.length=r})},Kd=t=>{const e=new Uo;for(let n=0;n<t.length;n++)t[n].clients.forEach((r,i)=>{if(!e.clients.has(i)){const s=r.slice();for(let o=n+1;o<t.length;o++)fT(s,t[o].clients.get(i)||[]);e.clients.set(i,s)}});return Lg(e),e},ta=(t,e,n,r)=>{vr(t.clients,e,()=>[]).push(new Pg(n,r))},Mv=()=>new Uo,Dv=t=>{const e=Mv();return t.clients.forEach((n,r)=>{const i=[];for(let s=0;s<n.length;s++){const o=n[s];if(o.deleted){const l=o.id.clock;let a=o.length;if(s+1<n.length)for(let u=n[s+1];s+1<n.length&&u.deleted;u=n[++s+1])a+=u.length;i.push(new Pg(l,a))}}i.length>0&&e.clients.set(r,i)}),e},Vo=(t,e)=>{ie(t.restEncoder,e.clients.size),Hr(e.clients.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{t.resetDsCurVal(),ie(t.restEncoder,n);const i=r.length;ie(t.restEncoder,i);for(let s=0;s<i;s++){const o=r[s];t.writeDsClock(o.clock),t.writeDsLen(o.len)}})},Fg=t=>{const e=new Uo,n=le(t.restDecoder);for(let r=0;r<n;r++){t.resetDsCurVal();const i=le(t.restDecoder),s=le(t.restDecoder);if(s>0){const o=vr(e.clients,i,()=>[]);for(let l=0;l<s;l++)o.push(new Pg(t.readDsClock(),t.readDsLen()))}}return e},G0=(t,e,n)=>{const r=new Uo,i=le(t.restDecoder);for(let s=0;s<i;s++){t.resetDsCurVal();const o=le(t.restDecoder),l=le(t.restDecoder),a=n.clients.get(o)||[],u=Je(n,o);for(let c=0;c<l;c++){const f=t.readDsClock(),h=f+t.readDsLen();if(f<u){u<h&&ta(r,o,u,h-u);let p=yr(a,f),m=a[p];for(!m.deleted&&m.id.clock<f&&(a.splice(p+1,0,mc(e,m,f-m.id.clock)),p++);p<a.length&&(m=a[p++],m.id.clock<h);)m.deleted||(h<m.id.clock+m.length&&a.splice(p,0,mc(e,m,h-m.id.clock)),m.delete(e))}else ta(r,o,f,h-f)}}if(r.clients.size>0){const s=new vs;return ie(s.restEncoder,0),Vo(s,r),s.toUint8Array()}return null},Bv=_v;class jo extends Og{constructor({guid:e=WT(),collectionid:n=null,gc:r=!0,gcFilter:i=()=>!0,meta:s=null,autoLoad:o=!1,shouldLoad:l=!0}={}){super(),this.gc=r,this.gcFilter=i,this.clientID=Bv(),this.guid=e,this.collectionid=n,this.share=new Map,this.store=new Wv,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=l,this.autoLoad=o,this.meta=s,this.isLoaded=!1,this.isSynced=!1,this.whenLoaded=W0(u=>{this.on("load",()=>{this.isLoaded=!0,u(this)})});const a=()=>W0(u=>{const c=f=>{(f===void 0||f===!0)&&(this.off("sync",c),u())};this.on("sync",c)});this.on("sync",u=>{u===!1&&this.isSynced&&(this.whenSynced=a()),this.isSynced=u===void 0||u===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=a()}load(){const e=this._item;e!==null&&!this.shouldLoad&&Te(e.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Hr(this.subdocs).map(e=>e.guid))}transact(e,n=null){return Te(this,e,n)}get(e,n=yt){const r=vr(this.share,e,()=>{const s=new n;return s._integrate(this,null),s}),i=r.constructor;if(n!==yt&&i!==n)if(i===yt){const s=new n;s._map=r._map,r._map.forEach(o=>{for(;o!==null;o=o.left)o.parent=s}),s._start=r._start;for(let o=s._start;o!==null;o=o.right)o.parent=s;return s._length=r._length,this.share.set(e,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return r}getArray(e=""){return this.get(e,po)}getText(e=""){return this.get(e,ks)}getMap(e=""){return this.get(e,Ro)}getXmlElement(e=""){return this.get(e,Ut)}getXmlFragment(e=""){return this.get(e,_s)}toJSON(){const e={};return this.share.forEach((n,r)=>{e[r]=n.toJSON()}),e}destroy(){Hr(this.subdocs).forEach(n=>n.destroy());const e=this._item;if(e!==null){this._item=null;const n=e.content;n.doc=new jo({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=e,Te(e.parent.doc,r=>{const i=n.doc;e.deleted||r.subdocsAdded.add(i),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class Pv{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return le(this.restDecoder)}readDsLen(){return le(this.restDecoder)}}class Lv extends Pv{readLeftID(){return ae(le(this.restDecoder),le(this.restDecoder))}readRightID(){return ae(le(this.restDecoder),le(this.restDecoder))}readClient(){return le(this.restDecoder)}readInfo(){return Io(this.restDecoder)}readString(){return Ei(this.restDecoder)}readParentInfo(){return le(this.restDecoder)===1}readTypeRef(){return le(this.restDecoder)}readLen(){return le(this.restDecoder)}readAny(){return ea(this.restDecoder)}readBuf(){return aI(Ct(this.restDecoder))}readJSON(){return JSON.parse(Ei(this.restDecoder))}readKey(){return Ei(this.restDecoder)}}class xI{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=le(this.restDecoder),this.dsCurrVal}readDsLen(){const e=le(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class Oo extends xI{constructor(e){super(e),this.keys=[],le(e),this.keyClockDecoder=new ih(Ct(e)),this.clientDecoder=new Ou(Ct(e)),this.leftClockDecoder=new ih(Ct(e)),this.rightClockDecoder=new ih(Ct(e)),this.infoDecoder=new $0(Ct(e),Io),this.stringDecoder=new zT(Ct(e)),this.parentInfoDecoder=new $0(Ct(e),Io),this.typeRefDecoder=new Ou(Ct(e)),this.lenDecoder=new Ou(Ct(e))}readLeftID(){return new ho(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new ho(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return ea(this.restDecoder)}readBuf(){return Ct(this.restDecoder)}readJSON(){return ea(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const n=this.stringDecoder.read();return this.keys.push(n),n}}}class Fv{constructor(){this.restEncoder=mr()}toUint8Array(){return Ot(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){ie(this.restEncoder,e)}writeDsLen(e){ie(this.restEncoder,e)}}class ba extends Fv{writeLeftID(e){ie(this.restEncoder,e.client),ie(this.restEncoder,e.clock)}writeRightID(e){ie(this.restEncoder,e.client),ie(this.restEncoder,e.clock)}writeClient(e){ie(this.restEncoder,e)}writeInfo(e){Hd(this.restEncoder,e)}writeString(e){us(this.restEncoder,e)}writeParentInfo(e){ie(this.restEncoder,e?1:0)}writeTypeRef(e){ie(this.restEncoder,e)}writeLen(e){ie(this.restEncoder,e)}writeAny(e){Xl(this.restEncoder,e)}writeBuf(e){Xe(this.restEncoder,e)}writeJSON(e){us(this.restEncoder,JSON.stringify(e))}writeKey(e){us(this.restEncoder,e)}}class Uv{constructor(){this.restEncoder=mr(),this.dsCurrVal=0}toUint8Array(){return Ot(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const n=e-this.dsCurrVal;this.dsCurrVal=e,ie(this.restEncoder,n)}writeDsLen(e){e===0&&Pn(),ie(this.restEncoder,e-1),this.dsCurrVal+=e}}class vs extends Uv{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new rh,this.clientEncoder=new Iu,this.leftClockEncoder=new rh,this.rightClockEncoder=new rh,this.infoEncoder=new V0(Hd),this.stringEncoder=new AT,this.parentInfoEncoder=new V0(Hd),this.typeRefEncoder=new Iu,this.lenEncoder=new Iu}toUint8Array(){const e=mr();return ie(e,0),Xe(e,this.keyClockEncoder.toUint8Array()),Xe(e,this.clientEncoder.toUint8Array()),Xe(e,this.leftClockEncoder.toUint8Array()),Xe(e,this.rightClockEncoder.toUint8Array()),Xe(e,Ot(this.infoEncoder)),Xe(e,this.stringEncoder.toUint8Array()),Xe(e,Ot(this.parentInfoEncoder)),Xe(e,this.typeRefEncoder.toUint8Array()),Xe(e,this.lenEncoder.toUint8Array()),sf(e,Ot(this.restEncoder)),Ot(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){Xl(this.restEncoder,e)}writeBuf(e){Xe(this.restEncoder,e)}writeJSON(e){Xl(this.restEncoder,e)}writeKey(e){const n=this.keyMap.get(e);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(n)}}const TI=(t,e,n,r)=>{r=$r(r,e[0].id.clock);const i=yr(e,r);ie(t.restEncoder,e.length-i),t.writeClient(n),ie(t.restEncoder,r);const s=e[i];s.write(t,r-s.id.clock);for(let o=i+1;o<e.length;o++)e[o].write(t,0)},Ug=(t,e,n)=>{const r=new Map;n.forEach((i,s)=>{Je(e,s)>i&&r.set(s,i)}),xa(e).forEach((i,s)=>{n.has(s)||r.set(s,0)}),ie(t.restEncoder,r.size),Hr(r.entries()).sort((i,s)=>s[0]-i[0]).forEach(([i,s])=>{TI(t,e.clients.get(i),i,s)})},II=(t,e)=>{const n=Vt(),r=le(t.restDecoder);for(let i=0;i<r;i++){const s=le(t.restDecoder),o=new Array(s),l=t.readClient();let a=le(t.restDecoder);n.set(l,{i:0,refs:o});for(let u=0;u<s;u++){const c=t.readInfo();switch(rf&c){case 0:{const f=t.readLen();o[u]=new Tn(ae(l,a),f),a+=f;break}case 10:{const f=le(t.restDecoder);o[u]=new In(ae(l,a),f),a+=f;break}default:{const f=(c&(Lr|hn))===0,h=new Ae(ae(l,a),null,(c&hn)===hn?t.readLeftID():null,null,(c&Lr)===Lr?t.readRightID():null,f?t.readParentInfo()?e.get(t.readString()):t.readLeftID():null,f&&(c&Ql)===Ql?t.readString():null,gk(t,c));o[u]=h,a+=h.length}}}}return n},OI=(t,e,n)=>{const r=[];let i=Hr(n.keys()).sort((p,m)=>p-m);if(i.length===0)return null;const s=()=>{if(i.length===0)return null;let p=n.get(i[i.length-1]);for(;p.refs.length===p.i;)if(i.pop(),i.length>0)p=n.get(i[i.length-1]);else return null;return p};let o=s();if(o===null)return null;const l=new Wv,a=new Map,u=(p,m)=>{const v=a.get(p);(v==null||v>m)&&a.set(p,m)};let c=o.refs[o.i++];const f=new Map,h=()=>{for(const p of r){const m=p.id.client,v=n.get(m);v?(v.i--,l.clients.set(m,v.refs.slice(v.i)),n.delete(m),v.i=0,v.refs=[]):l.clients.set(m,[p]),i=i.filter(C=>C!==m)}r.length=0};for(;;){if(c.constructor!==In){const m=vr(f,c.id.client,()=>Je(e,c.id.client))-c.id.clock;if(m<0)r.push(c),u(c.id.client,c.id.clock-1),h();else{const v=c.getMissing(t,e);if(v!==null){r.push(c);const C=n.get(v)||{refs:[],i:0};if(C.refs.length===C.i)u(v,Je(e,v)),h();else{c=C.refs[C.i++];continue}}else(m===0||m<c.length)&&(c.integrate(t,m),f.set(c.id.client,c.id.clock+c.length))}}if(r.length>0)c=r.pop();else if(o!==null&&o.i<o.refs.length)c=o.refs[o.i++];else{if(o=s(),o===null)break;c=o.refs[o.i++]}}if(l.clients.size>0){const p=new vs;return Ug(p,l,new Map),ie(p.restEncoder,0),{missing:a,update:p.toUint8Array()}}return null},RI=(t,e)=>Ug(t,e.doc.store,e.beforeState),AI=(t,e,n,r=new Oo(t))=>Te(e,i=>{i.local=!1;let s=!1;const o=i.doc,l=o.store,a=II(r,o),u=OI(i,l,a),c=l.pendingStructs;if(c){for(const[h,p]of c.missing)if(p<Je(l,h)){s=!0;break}if(u){for(const[h,p]of u.missing){const m=c.missing.get(h);(m==null||m>p)&&c.missing.set(h,p)}c.update=fc([c.update,u.update])}}else l.pendingStructs=u;const f=G0(r,i,l);if(l.pendingDs){const h=new Oo(Ui(l.pendingDs));le(h.restDecoder);const p=G0(h,i,l);f&&p?l.pendingDs=fc([f,p]):l.pendingDs=f||p}else l.pendingDs=f;if(s){const h=l.pendingStructs.update;l.pendingStructs=null,zv(i.doc,h)}},n,!1),zv=(t,e,n,r=Oo)=>{const i=Ui(e);AI(i,t,n,new r(i))},NI=(t,e,n)=>zv(t,e,n,Lv),MI=(t,e,n=new Map)=>{Ug(t,e.store,n),Vo(t,Dv(e.store))},DI=(t,e=new Uint8Array([0]),n=new vs)=>{const r=Vv(e);MI(n,t,r);const i=[n.toUint8Array()];if(t.store.pendingDs&&i.push(t.store.pendingDs),t.store.pendingStructs&&i.push(eO(t.store.pendingStructs.update,e)),i.length>1){if(n.constructor===ba)return ZI(i.map((s,o)=>o===0?s:nO(s)));if(n.constructor===vs)return fc(i)}return i[0]},BI=(t,e)=>DI(t,e,new ba),PI=t=>{const e=new Map,n=le(t.restDecoder);for(let r=0;r<n;r++){const i=le(t.restDecoder),s=le(t.restDecoder);e.set(i,s)}return e},Vv=t=>PI(new Pv(Ui(t))),jv=(t,e)=>(ie(t.restEncoder,e.size),Hr(e.entries()).sort((n,r)=>r[0]-n[0]).forEach(([n,r])=>{ie(t.restEncoder,n),ie(t.restEncoder,r)}),t),LI=(t,e)=>jv(t,xa(e.store)),FI=(t,e=new Uv)=>(t instanceof Map?jv(e,t):LI(e,t),e.toUint8Array()),UI=t=>FI(t,new Fv);class zI{constructor(){this.l=[]}}const J0=()=>new zI,Y0=(t,e)=>t.l.push(e),Q0=(t,e)=>{const n=t.l,r=n.length;t.l=n.filter(i=>e!==i),r===t.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},Hv=(t,e,n)=>Dg(t.l,[e,n]);class ho{constructor(e,n){this.client=e,this.clock=n}}const no=(t,e)=>t===e||t!==null&&e!==null&&t.client===e.client&&t.clock===e.clock,ae=(t,e)=>new ho(t,e),na=t=>{for(const[e,n]of t.doc.share.entries())if(n===t)return e;throw Pn()},ra=(t,e)=>{for(;e!==null;){if(e.parent===t)return!0;e=e.parent._item}return!1};class ia{constructor(e,n,r,i=0){this.type=e,this.tname=n,this.item=r,this.assoc=i}}const El=t=>new ia(t.type==null?null:ae(t.type.client,t.type.clock),t.tname||null,t.item==null?null:ae(t.item.client,t.item.clock),t.assoc==null?0:t.assoc);class VI{constructor(e,n,r=0){this.type=e,this.index=n,this.assoc=r}}const jI=(t,e,n=0)=>new VI(t,e,n),ru=(t,e,n)=>{let r=null,i=null;return t._item===null?i=na(t):r=ae(t._item.id.client,t._item.id.clock),new ia(r,i,e,n)},oh=(t,e,n=0)=>{let r=t._start;if(n<0){if(e===0)return ru(t,null,n);e--}for(;r!==null;){if(!r.deleted&&r.countable){if(r.length>e)return ru(t,ae(r.id.client,r.id.clock+e),n);e-=r.length}if(r.right===null&&n<0)return ru(t,r.lastId,n);r=r.right}return ru(t,null,n)},HI=(t,e)=>{const n=e.store,r=t.item,i=t.type,s=t.tname,o=t.assoc;let l=null,a=0;if(r!==null){if(Je(n,r.client)<=r.clock)return null;const u=Qd(n,r),c=u.item;if(!(c instanceof Ae))return null;if(l=c.parent,l._item===null||!l._item.deleted){a=c.deleted||!c.countable?0:u.diff+(o>=0?0:1);let f=c.left;for(;f!==null;)!f.deleted&&f.countable&&(a+=f.length),f=f.left}}else{if(s!==null)l=e.get(s);else if(i!==null){if(Je(n,i.client)<=i.clock)return null;const{item:u}=Qd(n,i);if(u instanceof Ae&&u.content instanceof nr)l=u.content.type;else return null}else throw Pn();o>=0?a=l._length:a=0}return jI(l,a,t.assoc)},Z0=(t,e)=>t===e||t!==null&&e!==null&&t.tname===e.tname&&no(t.item,e.item)&&no(t.type,e.type)&&t.assoc===e.assoc;class zg{constructor(e,n){this.ds=e,this.sv=n}}const $v=(t,e)=>new zg(t,e),$I=t=>$v(Dv(t.store),xa(t.store)),Ji=(t,e)=>e===void 0?!t.deleted:e.sv.has(t.id.client)&&(e.sv.get(t.id.client)||0)>t.id.clock&&!zo(e.ds,t.id),Gd=(t,e)=>{const n=vr(t.meta,Gd,Ri),r=t.doc.store;n.has(e)||(e.sv.forEach((i,s)=>{i<Je(r,s)&&Qt(t,ae(s,i))}),Di(t,e.ds,i=>{}),n.add(e))};class Wv{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const xa=t=>{const e=new Map;return t.clients.forEach((n,r)=>{const i=n[n.length-1];e.set(r,i.id.clock+i.length)}),e},Je=(t,e)=>{const n=t.clients.get(e);if(n===void 0)return 0;const r=n[n.length-1];return r.id.clock+r.length},qv=(t,e)=>{let n=t.clients.get(e.id.client);if(n===void 0)n=[],t.clients.set(e.id.client,n);else{const r=n[n.length-1];if(r.id.clock+r.length!==e.id.clock)throw Pn()}n.push(e)},yr=(t,e)=>{let n=0,r=t.length-1,i=t[r],s=i.id.clock;if(s===e)return r;let o=gr(e/(s+i.length-1)*r);for(;n<=r;){if(i=t[o],s=i.id.clock,s<=e){if(e<s+i.length)return o;n=o+1}else r=o-1;o=gr((n+r)/2)}throw Pn()},WI=(t,e)=>{const n=t.clients.get(e.client);return n[yr(n,e.clock)]},Ru=WI,Jd=(t,e,n)=>{const r=yr(e,n),i=e[r];return i.id.clock<n&&i instanceof Ae?(e.splice(r+1,0,mc(t,i,n-i.id.clock)),r+1):r},Qt=(t,e)=>{const n=t.doc.store.clients.get(e.client);return n[Jd(t,n,e.clock)]},X0=(t,e,n)=>{const r=e.clients.get(n.client),i=yr(r,n.clock),s=r[i];return n.clock!==s.id.clock+s.length-1&&s.constructor!==Tn&&r.splice(i+1,0,mc(t,s,n.clock-s.id.clock+1)),s},qI=(t,e,n)=>{const r=t.clients.get(e.id.client);r[yr(r,e.id.clock)]=n},Kv=(t,e,n,r,i)=>{if(r===0)return;const s=n+r;let o=Jd(t,e,n),l;do l=e[o++],s<l.id.clock+l.length&&Jd(t,e,s),i(l);while(o<e.length&&e[o].id.clock<s)};let KI=class{constructor(e,n,r){this.doc=e,this.deleteSet=new Uo,this.beforeState=xa(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}};const ey=(t,e)=>e.deleteSet.clients.size===0&&!cT(e.afterState,(n,r)=>e.beforeState.get(r)!==n)?!1:(Lg(e.deleteSet),RI(t,e),Vo(t,e.deleteSet),!0),ty=(t,e,n)=>{const r=e._item;(r===null||r.id.clock<(t.beforeState.get(r.id.client)||0)&&!r.deleted)&&vr(t.changed,e,Ri).add(n)},Au=(t,e)=>{let n=t[e],r=t[e-1],i=e;for(;i>0;n=r,r=t[--i-1]){if(r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n)){n instanceof Ae&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);continue}break}const s=e-i;return s&&t.splice(e+1-s,s),s},GI=(t,e,n)=>{for(const[r,i]of t.clients.entries()){const s=e.clients.get(r);for(let o=i.length-1;o>=0;o--){const l=i[o],a=l.clock+l.len;for(let u=yr(s,l.clock),c=s[u];u<s.length&&c.id.clock<a;c=s[++u]){const f=s[u];if(l.clock+l.len<=f.id.clock)break;f instanceof Ae&&f.deleted&&!f.keep&&n(f)&&f.gc(e,!1)}}}},JI=(t,e)=>{t.clients.forEach((n,r)=>{const i=e.clients.get(r);for(let s=n.length-1;s>=0;s--){const o=n[s],l=ls(i.length-1,1+yr(i,o.clock+o.len-1));for(let a=l,u=i[a];a>0&&u.id.clock>=o.clock;u=i[a])a-=1+Au(i,a)}})},Gv=(t,e)=>{if(e<t.length){const n=t[e],r=n.doc,i=r.store,s=n.deleteSet,o=n._mergeStructs;try{Lg(s),n.afterState=xa(n.doc.store),r.emit("beforeObserverCalls",[n,r]);const l=[];n.changed.forEach((a,u)=>l.push(()=>{(u._item===null||!u._item.deleted)&&u._callObserver(n,a)})),l.push(()=>{n.changedParentTypes.forEach((a,u)=>{u._dEH.l.length>0&&(u._item===null||!u._item.deleted)&&(a=a.filter(c=>c.target._item===null||!c.target._item.deleted),a.forEach(c=>{c.currentTarget=u,c._path=null}),a.sort((c,f)=>c.path.length-f.path.length),Hv(u._dEH,a,n))})}),l.push(()=>r.emit("afterTransaction",[n,r])),Dg(l,[]),n._needFormattingCleanup&&mO(n)}finally{r.gc&&GI(s,i,r.gcFilter),JI(s,i),n.afterState.forEach((c,f)=>{const h=n.beforeState.get(f)||0;if(h!==c){const p=i.clients.get(f),m=$r(yr(p,h),1);for(let v=p.length-1;v>=m;)v-=1+Au(p,v)}});for(let c=o.length-1;c>=0;c--){const{client:f,clock:h}=o[c].id,p=i.clients.get(f),m=yr(p,h);m+1<p.length&&Au(p,m+1)>1||m>0&&Au(p,m)}if(!n.local&&n.afterState.get(r.clientID)!==n.beforeState.get(r.clientID)&&(_I(Bg,Tv,"[yjs] ",Iv,Ov,"Changed the client-id because another client seems to be using it."),r.clientID=Bv()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const c=new ba;ey(c,n)&&r.emit("update",[c.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){const c=new vs;ey(c,n)&&r.emit("updateV2",[c.toUint8Array(),n.origin,r,n])}const{subdocsAdded:l,subdocsLoaded:a,subdocsRemoved:u}=n;(l.size>0||u.size>0||a.size>0)&&(l.forEach(c=>{c.clientID=r.clientID,c.collectionid==null&&(c.collectionid=r.collectionid),r.subdocs.add(c)}),u.forEach(c=>r.subdocs.delete(c)),r.emit("subdocs",[{loaded:a,added:l,removed:u},r,n]),u.forEach(c=>c.destroy())),t.length<=e+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,t])):Gv(t,e+1)}}},Te=(t,e,n=null,r=!0)=>{const i=t._transactionCleanups;let s=!1,o=null;t._transaction===null&&(s=!0,t._transaction=new KI(t,n,r),i.push(t._transaction),i.length===1&&t.emit("beforeAllTransactions",[t]),t.emit("beforeTransaction",[t._transaction,t]));try{o=e(t._transaction)}finally{if(s){const l=t._transaction===i[0];t._transaction=null,l&&Gv(i,0)}}return o};class YI{constructor(e,n){this.insertions=n,this.deletions=e,this.meta=new Map}}const ny=(t,e,n)=>{Di(t,n.deletions,r=>{r instanceof Ae&&e.scope.some(i=>ra(i,r))&&Gg(r,!1)})},ry=(t,e,n)=>{let r=null;const i=t.doc,s=t.scope;if(Te(i,o=>{for(;e.length>0&&t.currStackItem===null;){const l=i.store,a=e.pop(),u=new Set,c=[];let f=!1;Di(o,a.insertions,h=>{if(h instanceof Ae){if(h.redone!==null){let{item:p,diff:m}=Qd(l,h.id);m>0&&(p=Qt(o,ae(p.id.client,p.id.clock+m))),h=p}!h.deleted&&s.some(p=>ra(p,h))&&c.push(h)}}),Di(o,a.deletions,h=>{h instanceof Ae&&s.some(p=>ra(p,h))&&!zo(a.insertions,h.id)&&u.add(h)}),u.forEach(h=>{f=pk(o,h,u,a.insertions,t.ignoreRemoteMapChanges,t)!==null||f});for(let h=c.length-1;h>=0;h--){const p=c[h];t.deleteFilter(p)&&(p.delete(o),f=!0)}t.currStackItem=f?a:null}o.changed.forEach((l,a)=>{l.has(null)&&a._searchMarker&&(a._searchMarker.length=0)}),r=o},t),t.currStackItem!=null){const o=r.changedParentTypes;t.emit("stack-item-popped",[{stackItem:t.currStackItem,type:n,changedParentTypes:o,origin:t},t]),t.currStackItem=null}return t.currStackItem};class Jv extends Og{constructor(e,{captureTimeout:n=500,captureTransaction:r=a=>!0,deleteFilter:i=()=>!0,trackedOrigins:s=new Set([null]),ignoreRemoteMapChanges:o=!1,doc:l=Vd(e)?e[0].doc:e.doc}={}){super(),this.scope=[],this.doc=l,this.addToScope(e),this.deleteFilter=i,s.add(this),this.trackedOrigins=s,this.captureTransaction=r,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=o,this.captureTimeout=n,this.afterTransactionHandler=a=>{if(!this.captureTransaction(a)||!this.scope.some(C=>a.changedParentTypes.has(C))||!this.trackedOrigins.has(a.origin)&&(!a.origin||!this.trackedOrigins.has(a.origin.constructor)))return;const u=this.undoing,c=this.redoing,f=u?this.redoStack:this.undoStack;u?this.stopCapturing():c||this.clear(!1,!0);const h=new Uo;a.afterState.forEach((C,y)=>{const _=a.beforeState.get(y)||0,x=C-_;x>0&&ta(h,y,_,x)});const p=Ni();let m=!1;if(this.lastChange>0&&p-this.lastChange<this.captureTimeout&&f.length>0&&!u&&!c){const C=f[f.length-1];C.deletions=Kd([C.deletions,a.deleteSet]),C.insertions=Kd([C.insertions,h])}else f.push(new YI(a.deleteSet,h)),m=!0;!u&&!c&&(this.lastChange=p),Di(a,a.deleteSet,C=>{C instanceof Ae&&this.scope.some(y=>ra(y,C))&&Gg(C,!0)});const v=[{stackItem:f[f.length-1],origin:a.origin,type:u?"redo":"undo",changedParentTypes:a.changedParentTypes},this];m?this.emit("stack-item-added",v):this.emit("stack-item-updated",v)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(e){e=Vd(e)?e:[e],e.forEach(n=>{this.scope.every(r=>r!==n)&&(n.doc!==this.doc&&EI("[yjs#509] Not same Y.Doc"),this.scope.push(n))})}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(e=!0,n=!0){(e&&this.canUndo()||n&&this.canRedo())&&this.doc.transact(r=>{e&&(this.undoStack.forEach(i=>ny(r,this,i)),this.undoStack=[]),n&&(this.redoStack.forEach(i=>ny(r,this,i)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:n}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let e;try{e=ry(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){this.redoing=!0;let e;try{e=ry(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*QI(t){const e=le(t.restDecoder);for(let n=0;n<e;n++){const r=le(t.restDecoder),i=t.readClient();let s=le(t.restDecoder);for(let o=0;o<r;o++){const l=t.readInfo();if(l===10){const a=le(t.restDecoder);yield new In(ae(i,s),a),s+=a}else if(rf&l){const a=(l&(Lr|hn))===0,u=new Ae(ae(i,s),null,(l&hn)===hn?t.readLeftID():null,null,(l&Lr)===Lr?t.readRightID():null,a?t.readParentInfo()?t.readString():t.readLeftID():null,a&&(l&Ql)===Ql?t.readString():null,gk(t,l));yield u,s+=u.length}else{const a=t.readLen();yield new Tn(ae(i,s),a),s+=a}}}}class Vg{constructor(e,n){this.gen=QI(e),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===In);return this.curr}}class jg{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const ZI=t=>fc(t,Lv,ba),XI=(t,e)=>{if(t.constructor===Tn){const{client:n,clock:r}=t.id;return new Tn(ae(n,r+e),t.length-e)}else if(t.constructor===In){const{client:n,clock:r}=t.id;return new In(ae(n,r+e),t.length-e)}else{const n=t,{client:r,clock:i}=n.id;return new Ae(ae(r,i+e),null,ae(r,i+e-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(e))}},fc=(t,e=Oo,n=vs)=>{if(t.length===1)return t[0];const r=t.map(c=>new e(Ui(c)));let i=r.map(c=>new Vg(c,!0)),s=null;const o=new n,l=new jg(o);for(;i=i.filter(h=>h.curr!==null),i.sort((h,p)=>{if(h.curr.id.client===p.curr.id.client){const m=h.curr.id.clock-p.curr.id.clock;return m===0?h.curr.constructor===p.curr.constructor?0:h.curr.constructor===In?1:-1:m}else return p.curr.id.client-h.curr.id.client}),i.length!==0;){const c=i[0],f=c.curr.id.client;if(s!==null){let h=c.curr,p=!1;for(;h!==null&&h.id.clock+h.length<=s.struct.id.clock+s.struct.length&&h.id.client>=s.struct.id.client;)h=c.next(),p=!0;if(h===null||h.id.client!==f||p&&h.id.clock>s.struct.id.clock+s.struct.length)continue;if(f!==s.struct.id.client)oi(l,s.struct,s.offset),s={struct:h,offset:0},c.next();else if(s.struct.id.clock+s.struct.length<h.id.clock)if(s.struct.constructor===In)s.struct.length=h.id.clock+h.length-s.struct.id.clock;else{oi(l,s.struct,s.offset);const m=h.id.clock-s.struct.id.clock-s.struct.length;s={struct:new In(ae(f,s.struct.id.clock+s.struct.length),m),offset:0}}else{const m=s.struct.id.clock+s.struct.length-h.id.clock;m>0&&(s.struct.constructor===In?s.struct.length-=m:h=XI(h,m)),s.struct.mergeWith(h)||(oi(l,s.struct,s.offset),s={struct:h,offset:0},c.next())}}else s={struct:c.curr,offset:0},c.next();for(let h=c.curr;h!==null&&h.id.client===f&&h.id.clock===s.struct.id.clock+s.struct.length&&h.constructor!==In;h=c.next())oi(l,s.struct,s.offset),s={struct:h,offset:0}}s!==null&&(oi(l,s.struct,s.offset),s=null),Hg(l);const a=r.map(c=>Fg(c)),u=Kd(a);return Vo(o,u),o.toUint8Array()},eO=(t,e,n=Oo,r=vs)=>{const i=Vv(e),s=new r,o=new jg(s),l=new n(Ui(t)),a=new Vg(l,!1);for(;a.curr;){const c=a.curr,f=c.id.client,h=i.get(f)||0;if(a.curr.constructor===In){a.next();continue}if(c.id.clock+c.length>h)for(oi(o,c,$r(h-c.id.clock,0)),a.next();a.curr&&a.curr.id.client===f;)oi(o,a.curr,0),a.next();else for(;a.curr&&a.curr.id.client===f&&a.curr.id.clock+a.curr.length<=h;)a.next()}Hg(o);const u=Fg(l);return Vo(s,u),s.toUint8Array()},Yv=t=>{t.written>0&&(t.clientStructs.push({written:t.written,restEncoder:Ot(t.encoder.restEncoder)}),t.encoder.restEncoder=mr(),t.written=0)},oi=(t,e,n)=>{t.written>0&&t.currClient!==e.id.client&&Yv(t),t.written===0&&(t.currClient=e.id.client,t.encoder.writeClient(e.id.client),ie(t.encoder.restEncoder,e.id.clock+n)),e.write(t.encoder,n),t.written++},Hg=t=>{Yv(t);const e=t.encoder.restEncoder;ie(e,t.clientStructs.length);for(let n=0;n<t.clientStructs.length;n++){const r=t.clientStructs[n];ie(e,r.written),sf(e,r.restEncoder)}},tO=(t,e,n,r)=>{const i=new n(Ui(t)),s=new Vg(i,!1),o=new r,l=new jg(o);for(let u=s.curr;u!==null;u=s.next())oi(l,e(u),0);Hg(l);const a=Fg(i);return Vo(o,a),o.toUint8Array()},nO=t=>tO(t,eI,Oo,ba),iy="You must not compute changes after the event-handler fired.";class lf{constructor(e,n){this.target=e,this.currentTarget=e,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=rO(this.currentTarget,this.target))}deletes(e){return zo(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw Ai(iy);const e=new Map,n=this.target;this.transaction.changed.get(n).forEach(i=>{if(i!==null){const s=n._map.get(i);let o,l;if(this.adds(s)){let a=s.left;for(;a!==null&&this.adds(a);)a=a.left;if(this.deletes(s))if(a!==null&&this.deletes(a))o="delete",l=eh(a.content.getContent());else return;else a!==null&&this.deletes(a)?(o="update",l=eh(a.content.getContent())):(o="add",l=void 0)}else if(this.deletes(s))o="delete",l=eh(s.content.getContent());else return;e.set(i,{action:o,oldValue:l})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw Ai(iy);const n=this.target,r=Ri(),i=Ri(),s=[];if(e={added:r,deleted:i,delta:s,keys:this.keys},this.transaction.changed.get(n).has(null)){let l=null;const a=()=>{l&&s.push(l)};for(let u=n._start;u!==null;u=u.right)u.deleted?this.deletes(u)&&!this.adds(u)&&((l===null||l.delete===void 0)&&(a(),l={delete:0}),l.delete+=u.length,i.add(u)):this.adds(u)?((l===null||l.insert===void 0)&&(a(),l={insert:[]}),l.insert=l.insert.concat(u.content.getContent()),r.add(u)):((l===null||l.retain===void 0)&&(a(),l={retain:0}),l.retain+=u.length);l!==null&&l.retain===void 0&&a()}this._changes=e}return e}}const rO=(t,e)=>{const n=[];for(;e._item!==null&&e!==t;){if(e._item.parentSub!==null)n.unshift(e._item.parentSub);else{let r=0,i=e._item.parent._start;for(;i!==e._item&&i!==null;)i.deleted||r++,i=i.right;n.unshift(r)}e=e._item.parent}return n},Qv=80;let $g=0;class iO{constructor(e,n){e.marker=!0,this.p=e,this.index=n,this.timestamp=$g++}}const sO=t=>{t.timestamp=$g++},Zv=(t,e,n)=>{t.p.marker=!1,t.p=e,e.marker=!0,t.index=n,t.timestamp=$g++},oO=(t,e,n)=>{if(t.length>=Qv){const r=t.reduce((i,s)=>i.timestamp<s.timestamp?i:s);return Zv(r,e,n),r}else{const r=new iO(e,n);return t.push(r),r}},af=(t,e)=>{if(t._start===null||e===0||t._searchMarker===null)return null;const n=t._searchMarker.length===0?null:t._searchMarker.reduce((s,o)=>Tu(e-s.index)<Tu(e-o.index)?s:o);let r=t._start,i=0;for(n!==null&&(r=n.p,i=n.index,sO(n));r.right!==null&&i<e;){if(!r.deleted&&r.countable){if(e<i+r.length)break;i+=r.length}r=r.right}for(;r.left!==null&&i>e;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);return n!==null&&Tu(n.index-i)<r.parent.length/Qv?(Zv(n,r,i),n):oO(t._searchMarker,r,i)},sa=(t,e,n)=>{for(let r=t.length-1;r>=0;r--){const i=t[r];if(n>0){let s=i.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(i.index-=s.length);if(s===null||s.marker===!0){t.splice(r,1);continue}i.p=s,s.marker=!0}(e<i.index||n>0&&e===i.index)&&(i.index=$r(e,i.index+n))}},uf=(t,e,n)=>{const r=t,i=e.changedParentTypes;for(;vr(i,t,()=>[]).push(n),t._item!==null;)t=t._item.parent;Hv(r._eH,n,e)};class yt{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=J0(),this._dEH=J0(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,n){this.doc=e,this._item=n}_copy(){throw Zn()}clone(){throw Zn()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,n){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){Y0(this._eH,e)}observeDeep(e){Y0(this._dEH,e)}unobserve(e){Q0(this._eH,e)}unobserveDeep(e){Q0(this._dEH,e)}toJSON(){}}const Xv=(t,e,n)=>{e<0&&(e=t._length+e),n<0&&(n=t._length+n);let r=n-e;const i=[];let s=t._start;for(;s!==null&&r>0;){if(s.countable&&!s.deleted){const o=s.content.getContent();if(o.length<=e)e-=o.length;else{for(let l=e;l<o.length&&r>0;l++)i.push(o[l]),r--;e=0}}s=s.right}return i},ek=t=>{const e=[];let n=t._start;for(;n!==null;){if(n.countable&&!n.deleted){const r=n.content.getContent();for(let i=0;i<r.length;i++)e.push(r[i])}n=n.right}return e},tk=(t,e)=>{const n=[];let r=t._start;for(;r!==null;){if(r.countable&&Ji(r,e)){const i=r.content.getContent();for(let s=0;s<i.length;s++)n.push(i[s])}r=r.right}return n},oa=(t,e)=>{let n=0,r=t._start;for(;r!==null;){if(r.countable&&!r.deleted){const i=r.content.getContent();for(let s=0;s<i.length;s++)e(i[s],n++,t)}r=r.right}},nk=(t,e)=>{const n=[];return oa(t,(r,i)=>{n.push(e(r,i,t))}),n},lO=t=>{let e=t._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};n=e.content.getContent(),r=0,e=e.right}const i=n[r++];return n.length<=r&&(n=null),{done:!1,value:i}}}},rk=(t,e)=>{const n=af(t,e);let r=t._start;for(n!==null&&(r=n.p,e-=n.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(e<r.length)return r.content.getContent()[e];e-=r.length}},hc=(t,e,n,r)=>{let i=n;const s=t.doc,o=s.clientID,l=s.store,a=n===null?e._start:n.right;let u=[];const c=()=>{u.length>0&&(i=new Ae(ae(o,Je(l,o)),i,i&&i.lastId,a,a&&a.id,e,null,new Es(u)),i.integrate(t,0),u=[])};r.forEach(f=>{if(f===null)u.push(f);else switch(f.constructor){case Number:case Object:case Boolean:case Array:case String:u.push(f);break;default:switch(c(),f.constructor){case Uint8Array:case ArrayBuffer:i=new Ae(ae(o,Je(l,o)),i,i&&i.lastId,a,a&&a.id,e,null,new Ta(new Uint8Array(f))),i.integrate(t,0);break;case jo:i=new Ae(ae(o,Je(l,o)),i,i&&i.lastId,a,a&&a.id,e,null,new Ia(f)),i.integrate(t,0);break;default:if(f instanceof yt)i=new Ae(ae(o,Je(l,o)),i,i&&i.lastId,a,a&&a.id,e,null,new nr(f)),i.integrate(t,0);else throw new Error("Unexpected content type in insert operation")}}}),c()},ik=()=>Ai("Length exceeded!"),sk=(t,e,n,r)=>{if(n>e._length)throw ik();if(n===0)return e._searchMarker&&sa(e._searchMarker,n,r.length),hc(t,e,null,r);const i=n,s=af(e,n);let o=e._start;for(s!==null&&(o=s.p,n-=s.index,n===0&&(o=o.prev,n+=o&&o.countable&&!o.deleted?o.length:0));o!==null;o=o.right)if(!o.deleted&&o.countable){if(n<=o.length){n<o.length&&Qt(t,ae(o.id.client,o.id.clock+n));break}n-=o.length}return e._searchMarker&&sa(e._searchMarker,i,r.length),hc(t,e,o,r)},aO=(t,e,n)=>{let i=(e._searchMarker||[]).reduce((s,o)=>o.index>s.index?o:s,{index:0,p:e._start}).p;if(i)for(;i.right;)i=i.right;return hc(t,e,i,n)},ok=(t,e,n,r)=>{if(r===0)return;const i=n,s=r,o=af(e,n);let l=e._start;for(o!==null&&(l=o.p,n-=o.index);l!==null&&n>0;l=l.right)!l.deleted&&l.countable&&(n<l.length&&Qt(t,ae(l.id.client,l.id.clock+n)),n-=l.length);for(;r>0&&l!==null;)l.deleted||(r<l.length&&Qt(t,ae(l.id.client,l.id.clock+r)),l.delete(t),r-=l.length),l=l.right;if(r>0)throw ik();e._searchMarker&&sa(e._searchMarker,i,-s+r)},dc=(t,e,n)=>{const r=e._map.get(n);r!==void 0&&r.delete(t)},Wg=(t,e,n,r)=>{const i=e._map.get(n)||null,s=t.doc,o=s.clientID;let l;if(r==null)l=new Es([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:l=new Es([r]);break;case Uint8Array:l=new Ta(r);break;case jo:l=new Ia(r);break;default:if(r instanceof yt)l=new nr(r);else throw new Error("Unexpected content type")}new Ae(ae(o,Je(s.store,o)),i,i&&i.lastId,null,null,e,n,l).integrate(t,0)},qg=(t,e)=>{const n=t._map.get(e);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},lk=t=>{const e={};return t._map.forEach((n,r)=>{n.deleted||(e[r]=n.content.getContent()[n.length-1])}),e},ak=(t,e)=>{const n=t._map.get(e);return n!==void 0&&!n.deleted},uO=(t,e)=>{const n={};return t._map.forEach((r,i)=>{let s=r;for(;s!==null&&(!e.sv.has(s.id.client)||s.id.clock>=(e.sv.get(s.id.client)||0));)s=s.left;s!==null&&Ji(s,e)&&(n[i]=s.content.getContent()[s.length-1])}),n},iu=t=>CI(t.entries(),e=>!e[1].deleted);class cO extends lf{constructor(e,n){super(e,n),this._transaction=n}}class po extends yt{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const n=new po;return n.push(e),n}_integrate(e,n){super._integrate(e,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new po}clone(){const e=new po;return e.insert(0,this.toArray().map(n=>n instanceof yt?n.clone():n)),e}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(e,n){super._callObserver(e,n),uf(this,e,new cO(this,e))}insert(e,n){this.doc!==null?Te(this.doc,r=>{sk(r,this,e,n)}):this._prelimContent.splice(e,0,...n)}push(e){this.doc!==null?Te(this.doc,n=>{aO(n,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,n=1){this.doc!==null?Te(this.doc,r=>{ok(r,this,e,n)}):this._prelimContent.splice(e,n)}get(e){return rk(this,e)}toArray(){return ek(this)}slice(e=0,n=this.length){return Xv(this,e,n)}toJSON(){return this.map(e=>e instanceof yt?e.toJSON():e)}map(e){return nk(this,e)}forEach(e){oa(this,e)}[Symbol.iterator](){return lO(this)}_write(e){e.writeTypeRef(DO)}}const fO=t=>new po;class hO extends lf{constructor(e,n,r){super(e,n),this.keysChanged=r}}class Ro extends yt{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,n){super._integrate(e,n),this._prelimContent.forEach((r,i)=>{this.set(i,r)}),this._prelimContent=null}_copy(){return new Ro}clone(){const e=new Ro;return this.forEach((n,r)=>{e.set(r,n instanceof yt?n.clone():n)}),e}_callObserver(e,n){uf(this,e,new hO(this,e,n))}toJSON(){const e={};return this._map.forEach((n,r)=>{if(!n.deleted){const i=n.content.getContent()[n.length-1];e[r]=i instanceof yt?i.toJSON():i}}),e}get size(){return[...iu(this._map)].length}keys(){return sh(iu(this._map),e=>e[0])}values(){return sh(iu(this._map),e=>e[1].content.getContent()[e[1].length-1])}entries(){return sh(iu(this._map),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this._map.forEach((n,r)=>{n.deleted||e(n.content.getContent()[n.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?Te(this.doc,n=>{dc(n,this,e)}):this._prelimContent.delete(e)}set(e,n){return this.doc!==null?Te(this.doc,r=>{Wg(r,this,e,n)}):this._prelimContent.set(e,n),n}get(e){return qg(this,e)}has(e){return ak(this,e)}clear(){this.doc!==null?Te(this.doc,e=>{this.forEach(function(n,r,i){dc(e,i,r)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(BO)}}const dO=t=>new Ro,fi=(t,e)=>t===e||typeof t=="object"&&typeof e=="object"&&t&&e&&XT(t,e);class Yd{constructor(e,n,r,i){this.left=e,this.right=n,this.index=r,this.currentAttributes=i}forward(){switch(this.right===null&&Pn(),this.right.content.constructor){case Ze:this.right.deleted||Ho(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const sy=(t,e,n)=>{for(;e.right!==null&&n>0;){switch(e.right.content.constructor){case Ze:e.right.deleted||Ho(e.currentAttributes,e.right.content);break;default:e.right.deleted||(n<e.right.length&&Qt(t,ae(e.right.id.client,e.right.id.clock+n)),e.index+=e.right.length,n-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},su=(t,e,n,r)=>{const i=new Map,s=r?af(e,n):null;if(s){const o=new Yd(s.p.left,s.p,s.index,i);return sy(t,o,n-s.index)}else{const o=new Yd(null,e._start,0,i);return sy(t,o,n)}},uk=(t,e,n,r)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===Ze&&fi(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();const i=t.doc,s=i.clientID;r.forEach((o,l)=>{const a=n.left,u=n.right,c=new Ae(ae(s,Je(i.store,s)),a,a&&a.lastId,u,u&&u.id,e,null,new Ze(l,o));c.integrate(t,0),n.right=c,n.forward()})},Ho=(t,e)=>{const{key:n,value:r}=e;r===null?t.delete(n):t.set(n,r)},ck=(t,e)=>{for(;t.right!==null;){if(!(t.right.deleted||t.right.content.constructor===Ze&&fi(e[t.right.content.key]??null,t.right.content.value)))break;t.forward()}},fk=(t,e,n,r)=>{const i=t.doc,s=i.clientID,o=new Map;for(const l in r){const a=r[l],u=n.currentAttributes.get(l)??null;if(!fi(u,a)){o.set(l,u);const{left:c,right:f}=n;n.right=new Ae(ae(s,Je(i.store,s)),c,c&&c.lastId,f,f&&f.id,e,null,new Ze(l,a)),n.right.integrate(t,0),n.forward()}}return o},lh=(t,e,n,r,i)=>{n.currentAttributes.forEach((h,p)=>{i[p]===void 0&&(i[p]=null)});const s=t.doc,o=s.clientID;ck(n,i);const l=fk(t,e,n,i),a=r.constructor===String?new er(r):r instanceof yt?new nr(r):new Ns(r);let{left:u,right:c,index:f}=n;e._searchMarker&&sa(e._searchMarker,n.index,a.getLength()),c=new Ae(ae(o,Je(s.store,o)),u,u&&u.lastId,c,c&&c.id,e,null,a),c.integrate(t,0),n.right=c,n.index=f,n.forward(),uk(t,e,n,l)},oy=(t,e,n,r,i)=>{const s=t.doc,o=s.clientID;ck(n,i);const l=fk(t,e,n,i);e:for(;n.right!==null&&(r>0||l.size>0&&(n.right.deleted||n.right.content.constructor===Ze));){if(!n.right.deleted)switch(n.right.content.constructor){case Ze:{const{key:a,value:u}=n.right.content,c=i[a];if(c!==void 0){if(fi(c,u))l.delete(a);else{if(r===0)break e;l.set(a,u)}n.right.delete(t)}else n.currentAttributes.set(a,u);break}default:r<n.right.length&&Qt(t,ae(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;break}n.forward()}if(r>0){let a="";for(;r>0;r--)a+=`
`;n.right=new Ae(ae(o,Je(s.store,o)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,e,null,new er(a)),n.right.integrate(t,0),n.forward()}uk(t,e,n,l)},hk=(t,e,n,r,i)=>{let s=e;const o=Vt();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===Ze){const u=s.content;o.set(u.key,u)}s=s.right}let l=0,a=!1;for(;e!==s;){if(n===e&&(a=!0),!e.deleted){const u=e.content;switch(u.constructor){case Ze:{const{key:c,value:f}=u,h=r.get(c)??null;(o.get(c)!==u||h===f)&&(e.delete(t),l++,!a&&(i.get(c)??null)===f&&h!==f&&(h===null?i.delete(c):i.set(c,h))),!a&&!e.deleted&&Ho(i,u);break}}}e=e.right}return l},pO=(t,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const n=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===Ze){const r=e.content.key;n.has(r)?e.delete(t):n.add(r)}e=e.left}},gO=t=>{let e=0;return Te(t.doc,n=>{let r=t._start,i=t._start,s=Vt();const o=zd(s);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case Ze:Ho(o,i.content);break;default:e+=hk(n,r,i,s,o),s=zd(o),r=i;break}i=i.right}}),e},mO=t=>{const e=new Set,n=t.doc;for(const[r,i]of t.afterState.entries()){const s=t.beforeState.get(r)||0;i!==s&&Kv(t,n.store.clients.get(r),s,i,o=>{!o.deleted&&o.content.constructor===Ze&&o.constructor!==Tn&&e.add(o.parent)})}Te(n,r=>{Di(t,t.deleteSet,i=>{if(i instanceof Tn||!i.parent._hasFormatting||e.has(i.parent))return;const s=i.parent;i.content.constructor===Ze?e.add(s):pO(r,i)});for(const i of e)gO(i)})},ly=(t,e,n)=>{const r=n,i=zd(e.currentAttributes),s=e.right;for(;n>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case nr:case Ns:case er:n<e.right.length&&Qt(t,ae(e.right.id.client,e.right.id.clock+n)),n-=e.right.length,e.right.delete(t);break}e.forward()}s&&hk(t,s,e.right,i,e.currentAttributes);const o=(e.left||e.right).parent;return o._searchMarker&&sa(o._searchMarker,e.index,-r+n),e};class yO extends lf{constructor(e,n,r){super(e,n),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,n=[];Te(e,r=>{const i=new Map,s=new Map;let o=this.target._start,l=null;const a={};let u="",c=0,f=0;const h=()=>{if(l!==null){let p=null;switch(l){case"delete":f>0&&(p={delete:f}),f=0;break;case"insert":(typeof u=="object"||u.length>0)&&(p={insert:u},i.size>0&&(p.attributes={},i.forEach((m,v)=>{m!==null&&(p.attributes[v]=m)}))),u="";break;case"retain":c>0&&(p={retain:c},QT(a)||(p.attributes=JT({},a))),c=0;break}p&&n.push(p),l=null}};for(;o!==null;){switch(o.content.constructor){case nr:case Ns:this.adds(o)?this.deletes(o)||(h(),l="insert",u=o.content.getContent()[0],h()):this.deletes(o)?(l!=="delete"&&(h(),l="delete"),f+=1):o.deleted||(l!=="retain"&&(h(),l="retain"),c+=1);break;case er:this.adds(o)?this.deletes(o)||(l!=="insert"&&(h(),l="insert"),u+=o.content.str):this.deletes(o)?(l!=="delete"&&(h(),l="delete"),f+=o.length):o.deleted||(l!=="retain"&&(h(),l="retain"),c+=o.length);break;case Ze:{const{key:p,value:m}=o.content;if(this.adds(o)){if(!this.deletes(o)){const v=i.get(p)??null;fi(v,m)?m!==null&&o.delete(r):(l==="retain"&&h(),fi(m,s.get(p)??null)?delete a[p]:a[p]=m)}}else if(this.deletes(o)){s.set(p,m);const v=i.get(p)??null;fi(v,m)||(l==="retain"&&h(),a[p]=v)}else if(!o.deleted){s.set(p,m);const v=a[p];v!==void 0&&(fi(v,m)?v!==null&&o.delete(r):(l==="retain"&&h(),m===null?delete a[p]:a[p]=m))}o.deleted||(l==="insert"&&h(),Ho(i,o.content));break}}o=o.right}for(h();n.length>0;){const p=n[n.length-1];if(p.retain!==void 0&&p.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}}class ks extends yt{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this._length}_integrate(e,n){super._integrate(e,n);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new ks}clone(){const e=new ks;return e.applyDelta(this.toDelta()),e}_callObserver(e,n){super._callObserver(e,n);const r=new yO(this,e,n);uf(this,e,r),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){let e="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===er&&(e+=n.content.str),n=n.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:n=!0}={}){this.doc!==null?Te(this.doc,r=>{const i=new Yd(null,this._start,0,new Map);for(let s=0;s<e.length;s++){const o=e[s];if(o.insert!==void 0){const l=!n&&typeof o.insert=="string"&&s===e.length-1&&i.right===null&&o.insert.slice(-1)===`
`?o.insert.slice(0,-1):o.insert;(typeof l!="string"||l.length>0)&&lh(r,this,i,l,o.attributes||{})}else o.retain!==void 0?oy(r,this,i,o.retain,o.attributes||{}):o.delete!==void 0&&ly(r,i,o.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,n,r){const i=[],s=new Map,o=this.doc;let l="",a=this._start;function u(){if(l.length>0){const f={};let h=!1;s.forEach((m,v)=>{h=!0,f[v]=m});const p={insert:l};h&&(p.attributes=f),i.push(p),l=""}}const c=()=>{for(;a!==null;){if(Ji(a,e)||n!==void 0&&Ji(a,n))switch(a.content.constructor){case er:{const f=s.get("ychange");e!==void 0&&!Ji(a,e)?(f===void 0||f.user!==a.id.client||f.type!=="removed")&&(u(),s.set("ychange",r?r("removed",a.id):{type:"removed"})):n!==void 0&&!Ji(a,n)?(f===void 0||f.user!==a.id.client||f.type!=="added")&&(u(),s.set("ychange",r?r("added",a.id):{type:"added"})):f!==void 0&&(u(),s.delete("ychange")),l+=a.content.str;break}case nr:case Ns:{u();const f={insert:a.content.getContent()[0]};if(s.size>0){const h={};f.attributes=h,s.forEach((p,m)=>{h[m]=p})}i.push(f);break}case Ze:Ji(a,e)&&(u(),Ho(s,a.content));break}a=a.right}u()};return e||n?Te(o,f=>{e&&Gd(f,e),n&&Gd(f,n),c()},"cleanup"):c(),i}insert(e,n,r){if(n.length<=0)return;const i=this.doc;i!==null?Te(i,s=>{const o=su(s,this,e,!r);r||(r={},o.currentAttributes.forEach((l,a)=>{r[a]=l})),lh(s,this,o,n,r)}):this._pending.push(()=>this.insert(e,n,r))}insertEmbed(e,n,r){const i=this.doc;i!==null?Te(i,s=>{const o=su(s,this,e,!r);lh(s,this,o,n,r||{})}):this._pending.push(()=>this.insertEmbed(e,n,r||{}))}delete(e,n){if(n===0)return;const r=this.doc;r!==null?Te(r,i=>{ly(i,su(i,this,e,!0),n)}):this._pending.push(()=>this.delete(e,n))}format(e,n,r){if(n===0)return;const i=this.doc;i!==null?Te(i,s=>{const o=su(s,this,e,!1);o.right!==null&&oy(s,this,o,n,r)}):this._pending.push(()=>this.format(e,n,r))}removeAttribute(e){this.doc!==null?Te(this.doc,n=>{dc(n,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,n){this.doc!==null?Te(this.doc,r=>{Wg(r,this,e,n)}):this._pending.push(()=>this.setAttribute(e,n))}getAttribute(e){return qg(this,e)}getAttributes(){return lk(this)}_write(e){e.writeTypeRef(PO)}}const wO=t=>new ks;class ah{constructor(e,n=()=>!0){this._filter=n,this._root=e,this._currentNode=e._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let e=this._currentNode,n=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(n)))do if(n=e.content.type,!e.deleted&&(n.constructor===Ut||n.constructor===_s)&&n._start!==null)e=n._start;else for(;e!==null;)if(e.right!==null){e=e.right;break}else e.parent===this._root?e=null:e=e.parent._item;while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class _s extends yt{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,n){super._integrate(e,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new _s}clone(){const e=new _s;return e.insert(0,this.toArray().map(n=>n instanceof yt?n.clone():n)),e}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new ah(this,e)}querySelector(e){e=e.toUpperCase();const r=new ah(this,i=>i.nodeName&&i.nodeName.toUpperCase()===e).next();return r.done?null:r.value}querySelectorAll(e){return e=e.toUpperCase(),Hr(new ah(this,n=>n.nodeName&&n.nodeName.toUpperCase()===e))}_callObserver(e,n){uf(this,e,new kO(this,n,e))}toString(){return nk(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,n={},r){const i=e.createDocumentFragment();return r!==void 0&&r._createAssociation(i,this),oa(this,s=>{i.insertBefore(s.toDOM(e,n,r),null)}),i}insert(e,n){this.doc!==null?Te(this.doc,r=>{sk(r,this,e,n)}):this._prelimContent.splice(e,0,...n)}insertAfter(e,n){if(this.doc!==null)Te(this.doc,r=>{const i=e&&e instanceof yt?e._item:e;hc(r,this,i,n)});else{const r=this._prelimContent,i=e===null?0:r.findIndex(s=>s===e)+1;if(i===0&&e!==null)throw Ai("Reference item not found");r.splice(i,0,...n)}}delete(e,n=1){this.doc!==null?Te(this.doc,r=>{ok(r,this,e,n)}):this._prelimContent.splice(e,n)}toArray(){return ek(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return rk(this,e)}slice(e=0,n=this.length){return Xv(this,e,n)}forEach(e){oa(this,e)}_write(e){e.writeTypeRef(FO)}}const SO=t=>new _s;class Ut extends _s{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,n){super._integrate(e,n),this._prelimAttrs.forEach((r,i)=>{this.setAttribute(i,r)}),this._prelimAttrs=null}_copy(){return new Ut(this.nodeName)}clone(){const e=new Ut(this.nodeName),n=this.getAttributes();return YT(n,(r,i)=>{typeof r=="string"&&e.setAttribute(i,r)}),e.insert(0,this.toArray().map(r=>r instanceof yt?r.clone():r)),e}toString(){const e=this.getAttributes(),n=[],r=[];for(const l in e)r.push(l);r.sort();const i=r.length;for(let l=0;l<i;l++){const a=r[l];n.push(a+'="'+e[a]+'"')}const s=this.nodeName.toLocaleLowerCase(),o=n.length>0?" "+n.join(" "):"";return`<${s}${o}>${super.toString()}</${s}>`}removeAttribute(e){this.doc!==null?Te(this.doc,n=>{dc(n,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,n){this.doc!==null?Te(this.doc,r=>{Wg(r,this,e,n)}):this._prelimAttrs.set(e,n)}getAttribute(e){return qg(this,e)}hasAttribute(e){return ak(this,e)}getAttributes(e){return e?uO(this,e):lk(this)}toDOM(e=document,n={},r){const i=e.createElement(this.nodeName),s=this.getAttributes();for(const o in s){const l=s[o];typeof l=="string"&&i.setAttribute(o,l)}return oa(this,o=>{i.appendChild(o.toDOM(e,n,r))}),r!==void 0&&r._createAssociation(i,this),i}_write(e){e.writeTypeRef(LO),e.writeKey(this.nodeName)}}const vO=t=>new Ut(t.readKey());class kO extends lf{constructor(e,n,r){super(e,r),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}}class pc extends Ro{constructor(e){super(),this.hookName=e}_copy(){return new pc(this.hookName)}clone(){const e=new pc(this.hookName);return this.forEach((n,r)=>{e.set(r,n)}),e}toDOM(e=document,n={},r){const i=n[this.hookName];let s;return i!==void 0?s=i.createDom(this):s=document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(s,this),s}_write(e){e.writeTypeRef(UO),e.writeKey(this.hookName)}}const _O=t=>new pc(t.readKey());class dn extends ks{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new dn}clone(){const e=new dn;return e.applyDelta(this.toDelta()),e}toDOM(e=document,n,r){const i=e.createTextNode(this.toString());return r!==void 0&&r._createAssociation(i,this),i}toString(){return this.toDelta().map(e=>{const n=[];for(const i in e.attributes){const s=[];for(const o in e.attributes[i])s.push({key:o,value:e.attributes[i][o]});s.sort((o,l)=>o.key<l.key?-1:1),n.push({nodeName:i,attrs:s})}n.sort((i,s)=>i.nodeName<s.nodeName?-1:1);let r="";for(let i=0;i<n.length;i++){const s=n[i];r+=`<${s.nodeName}`;for(let o=0;o<s.attrs.length;o++){const l=s.attrs[o];r+=` ${l.key}="${l.value}"`}r+=">"}r+=e.insert;for(let i=n.length-1;i>=0;i--)r+=`</${n[i].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(zO)}}const EO=t=>new dn;class Kg{constructor(e,n){this.id=e,this.length=n}get deleted(){throw Zn()}mergeWith(e){return!1}write(e,n,r){throw Zn()}integrate(e,n){throw Zn()}}const CO=0;class Tn extends Kg{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,n){n>0&&(this.id.clock+=n,this.length-=n),qv(e.doc.store,this)}write(e,n){e.writeInfo(CO),e.writeLen(this.length-n)}getMissing(e,n){return null}}class Ta{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Ta(this.content)}splice(e){throw Zn()}mergeWith(e){return!1}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeBuf(this.content)}getRef(){return 3}}const bO=t=>new Ta(t.readBuf());class la{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new la(this.len)}splice(e){const n=new la(this.len-e);return this.len=e,n}mergeWith(e){return this.len+=e.len,!0}integrate(e,n){ta(e.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(e){}gc(e){}write(e,n){e.writeLen(this.len-n)}getRef(){return 1}}const xO=t=>new la(t.readLen()),dk=(t,e)=>new jo({guid:t,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class Ia{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const n={};this.opts=n,e.gc||(n.gc=!1),e.autoLoad&&(n.autoLoad=!0),e.meta!==null&&(n.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Ia(dk(this.doc.guid,this.opts))}splice(e){throw Zn()}mergeWith(e){return!1}integrate(e,n){this.doc._item=n,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,n){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const TO=t=>new Ia(dk(t.readString(),t.readAny()));class Ns{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new Ns(this.embed)}splice(e){throw Zn()}mergeWith(e){return!1}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeJSON(this.embed)}getRef(){return 5}}const IO=t=>new Ns(t.readJSON());class Ze{constructor(e,n){this.key=e,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Ze(this.key,this.value)}splice(e){throw Zn()}mergeWith(e){return!1}integrate(e,n){const r=n.parent;r._searchMarker=null,r._hasFormatting=!0}delete(e){}gc(e){}write(e,n){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const OO=t=>new Ze(t.readKey(),t.readJSON());class gc{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new gc(this.arr)}splice(e){const n=new gc(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){const r=this.arr.length;e.writeLen(r-n);for(let i=n;i<r;i++){const s=this.arr[i];e.writeString(s===void 0?"undefined":JSON.stringify(s))}}getRef(){return 2}}const RO=t=>{const e=t.readLen(),n=[];for(let r=0;r<e;r++){const i=t.readString();i==="undefined"?n.push(void 0):n.push(JSON.parse(i))}return new gc(n)};class Es{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Es(this.arr)}splice(e){const n=new Es(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){const r=this.arr.length;e.writeLen(r-n);for(let i=n;i<r;i++){const s=this.arr[i];e.writeAny(s)}}getRef(){return 8}}const AO=t=>{const e=t.readLen(),n=[];for(let r=0;r<e;r++)n.push(t.readAny());return new Es(n)};class er{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new er(this.str)}splice(e){const n=new er(this.str.slice(e));this.str=this.str.slice(0,e);const r=this.str.charCodeAt(e-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,e-1)+"",n.str=""+n.str.slice(1)),n}mergeWith(e){return this.str+=e.str,!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}}const NO=t=>new er(t.readString()),MO=[fO,dO,wO,vO,SO,_O,EO],DO=0,BO=1,PO=2,LO=3,FO=4,UO=5,zO=6;class nr{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new nr(this.type._copy())}splice(e){throw Zn()}mergeWith(e){return!1}integrate(e,n){this.type._integrate(e.doc,n)}delete(e){let n=this.type._start;for(;n!==null;)n.deleted?n.id.clock<(e.beforeState.get(n.id.client)||0)&&e._mergeStructs.push(n):n.delete(e),n=n.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(e.beforeState.get(r.id.client)||0)&&e._mergeStructs.push(r):r.delete(e)}),e.changed.delete(this.type)}gc(e){let n=this.type._start;for(;n!==null;)n.gc(e,!0),n=n.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(e,!0),r=r.left}),this.type._map=new Map}write(e,n){this.type._write(e)}getRef(){return 7}}const VO=t=>new nr(MO[t.readTypeRef()](t)),Qd=(t,e)=>{let n=e,r=0,i;do r>0&&(n=ae(n.client,n.clock+r)),i=Ru(t,n),r=n.clock-i.id.clock,n=i.redone;while(n!==null&&i instanceof Ae);return{item:i,diff:r}},Gg=(t,e)=>{for(;t!==null&&t.keep!==e;)t.keep=e,t=t.parent._item},mc=(t,e,n)=>{const{client:r,clock:i}=e.id,s=new Ae(ae(r,i+n),e,ae(r,i+n-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(n));return e.deleted&&s.markDeleted(),e.keep&&(s.keep=!0),e.redone!==null&&(s.redone=ae(e.redone.client,e.redone.clock+n)),e.right=s,s.right!==null&&(s.right.left=s),t._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),e.length=n,s},ay=(t,e)=>hT(t,n=>zo(n.deletions,e)),pk=(t,e,n,r,i,s)=>{const o=t.doc,l=o.store,a=o.clientID,u=e.redone;if(u!==null)return Qt(t,u);let c=e.parent._item,f=null,h;if(c!==null&&c.deleted===!0){if(c.redone===null&&(!n.has(c)||pk(t,c,n,r,i,s)===null))return null;for(;c.redone!==null;)c=Qt(t,c.redone)}const p=c===null?e.parent:c.content.type;if(e.parentSub===null){for(f=e.left,h=e;f!==null;){let y=f;for(;y!==null&&y.parent._item!==c;)y=y.redone===null?null:Qt(t,y.redone);if(y!==null&&y.parent._item===c){f=y;break}f=f.left}for(;h!==null;){let y=h;for(;y!==null&&y.parent._item!==c;)y=y.redone===null?null:Qt(t,y.redone);if(y!==null&&y.parent._item===c){h=y;break}h=h.right}}else if(h=null,e.right&&!i){for(f=e;f!==null&&f.right!==null&&(f.right.redone||zo(r,f.right.id)||ay(s.undoStack,f.right.id)||ay(s.redoStack,f.right.id));)for(f=f.right;f.redone;)f=Qt(t,f.redone);if(f&&f.right!==null)return null}else f=p._map.get(e.parentSub)||null;const m=Je(l,a),v=ae(a,m),C=new Ae(v,f,f&&f.lastId,h,h&&h.id,p,e.parentSub,e.content.copy());return e.redone=v,Gg(C,!0),C.integrate(t,0),C};let Ae=class Zd extends Kg{constructor(e,n,r,i,s,o,l,a){super(e,a.getLength()),this.origin=r,this.left=n,this.right=i,this.rightOrigin=s,this.parent=o,this.parentSub=l,this.redone=null,this.content=a,this.info=this.content.isCountable()?F0:0}set marker(e){(this.info&nh)>0!==e&&(this.info^=nh)}get marker(){return(this.info&nh)>0}get keep(){return(this.info&L0)>0}set keep(e){this.keep!==e&&(this.info^=L0)}get countable(){return(this.info&F0)>0}get deleted(){return(this.info&th)>0}set deleted(e){this.deleted!==e&&(this.info^=th)}markDeleted(){this.info|=th}getMissing(e,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Je(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Je(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===ho&&this.id.client!==this.parent.client&&this.parent.clock>=Je(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=X0(e,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Qt(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Tn||this.right&&this.right.constructor===Tn)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===Zd&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===Zd&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===ho){const r=Ru(n,this.parent);r.constructor===Tn?this.parent=null:this.parent=r.content.type}return null}integrate(e,n){if(n>0&&(this.id.clock+=n,this.left=X0(e,e.doc.store,ae(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,i;if(r!==null)i=r.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;const s=new Set,o=new Set;for(;i!==null&&i!==this.right;){if(o.add(i),s.add(i),no(this.origin,i.origin)){if(i.id.client<this.id.client)r=i,s.clear();else if(no(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&o.has(Ru(e.doc.store,i.origin)))s.has(Ru(e.doc.store,i.origin))||(r=i,s.clear());else break;i=i.right}this.left=r}if(this.left!==null){const r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),qv(e.doc.store,this),this.content.integrate(e,this),ty(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new Tn(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:ae(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&no(e.origin,this.lastId)&&this.right===e&&no(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const n=this.parent._searchMarker;return n&&n.forEach(r=>{r.p===e&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),ta(e.deleteSet,this.id.client,this.id.clock,this.length),ty(e,n,this.parentSub),this.content.delete(e)}}gc(e,n){if(!this.deleted)throw Pn();this.content.gc(e),n?qI(e,this,new Tn(this.id,this.length)):this.content=new la(this.length)}write(e,n){const r=n>0?ae(this.id.client,this.id.clock+n-1):this.origin,i=this.rightOrigin,s=this.parentSub,o=this.content.getRef()&rf|(r===null?0:hn)|(i===null?0:Lr)|(s===null?0:Ql);if(e.writeInfo(o),r!==null&&e.writeLeftID(r),i!==null&&e.writeRightID(i),r===null&&i===null){const l=this.parent;if(l._item!==void 0){const a=l._item;if(a===null){const u=na(l);e.writeParentInfo(!0),e.writeString(u)}else e.writeParentInfo(!1),e.writeLeftID(a.id)}else l.constructor===String?(e.writeParentInfo(!0),e.writeString(l)):l.constructor===ho?(e.writeParentInfo(!1),e.writeLeftID(l)):Pn();s!==null&&e.writeString(s)}this.content.write(e,n)}};const gk=(t,e)=>jO[e&rf](t),jO=[()=>{Pn()},xO,RO,bO,NO,IO,OO,VO,AO,TO,()=>{Pn()}],HO=10;class In extends Kg{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,n){Pn()}write(e,n){e.writeInfo(HO),ie(e.restEncoder,this.length-n)}getMissing(e,n){return null}}const mk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},yk="__ $YJS$ __";mk[yk]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");mk[yk]=!0;function pt(t){this.content=t}pt.prototype={constructor:pt,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,i=r.find(t),s=r.content.slice();return i==-1?s.push(n||t,e):(s[i+1]=e,n&&(s[i]=n)),new pt(s)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new pt(n)},addToStart:function(t,e){return new pt([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new pt(n)},addBefore:function(t,e,n){var r=this.remove(e),i=r.content.slice(),s=r.find(t);return i.splice(s==-1?i.length:s,0,e,n),new pt(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=pt.from(t),t.size?new pt(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=pt.from(t),t.size?new pt(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=pt.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};pt.from=function(t){if(t instanceof pt)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new pt(e)};function wk(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let i=t.child(r),s=e.child(r);if(i==s){n+=i.nodeSize;continue}if(!i.sameMarkup(s))return n;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)n++;return n}if(i.content.size||s.content.size){let o=wk(i.content,s.content,n+1);if(o!=null)return o}n+=i.nodeSize}}function Sk(t,e,n,r){for(let i=t.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:n,b:r};let o=t.child(--i),l=e.child(--s),a=o.nodeSize;if(o==l){n-=a,r-=a;continue}if(!o.sameMarkup(l))return{a:n,b:r};if(o.isText&&o.text!=l.text){let u=0,c=Math.min(o.text.length,l.text.length);for(;u<c&&o.text[o.text.length-u-1]==l.text[l.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(o.content.size||l.content.size){let u=Sk(o.content,l.content,n-1,r-1);if(u)return u}n-=a,r-=a}}class H{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,i=0,s){for(let o=0,l=0;l<n;o++){let a=this.content[o],u=l+a.nodeSize;if(u>e&&r(a,i+l,s||null,o)!==!1&&a.content.size){let c=l+1;a.nodesBetween(Math.max(0,e-c),Math.min(a.content.size,n-c),r,i+c)}l=u}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,i){let s="",o=!0;return this.nodesBetween(e,n,(l,a)=>{let u=l.isText?l.text.slice(Math.max(e,a)-a,n-a):l.isLeaf?i?typeof i=="function"?i(l):i:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&u||l.isTextblock)&&r&&(o?o=!1:s+=r),s+=u},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,i=this.content.slice(),s=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new H(i,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],i=0;if(n>e)for(let s=0,o=0;o<n;s++){let l=this.content[s],a=o+l.nodeSize;a>e&&((o<e||a>n)&&(l.isText?l=l.cut(Math.max(0,e-o),Math.min(l.text.length,n-o)):l=l.cut(Math.max(0,e-o-1),Math.min(l.content.size,n-o-1))),r.push(l),i+=l.nodeSize),o=a}return new H(r,i)}cutByIndex(e,n){return e==n?H.empty:e==0&&n==this.content.length?this:new H(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let i=this.content.slice(),s=this.size+n.nodeSize-r.nodeSize;return i[e]=n,new H(i,s)}addToStart(e){return new H([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new H(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let i=this.content[n];e(i,r,n),r+=i.nodeSize}}findDiffStart(e,n=0){return wk(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return Sk(this,e,n,r)}findIndex(e,n=-1){if(e==0)return ou(0,e);if(e==this.size)return ou(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let s=this.child(r),o=i+s.nodeSize;if(o>=e)return o==e||n>0?ou(r+1,o):ou(r,i);i=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return H.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new H(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return H.empty;let n,r=0;for(let i=0;i<e.length;i++){let s=e[i];r+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(n||(n=e.slice(0,i)),n[n.length-1]=s.withText(n[n.length-1].text+s.text)):n&&n.push(s)}return new H(n||e,r)}static from(e){if(!e)return H.empty;if(e instanceof H)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new H([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}H.empty=new H([],0);const uh={index:0,offset:0};function ou(t,e){return uh.index=t,uh.offset=e,uh}function yc(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!yc(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!yc(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}class ve{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))n||(n=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(n||(n=e.slice(0,i)),n.push(this),r=!0),n&&n.push(s)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&yc(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);return r.create(n.attrs)}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return ve.none;if(e instanceof ve)return[e];let n=e.slice();return n.sort((r,i)=>r.type.rank-i.type.rank),n}}ve.none=[];class wc extends Error{}class J{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=kk(this.content,e+this.openStart,n);return r&&new J(r,this.openStart,this.openEnd)}removeBetween(e,n){return new J(vk(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return J.empty;let r=n.openStart||0,i=n.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new J(H.fromJSON(e,n.content),r,i)}static maxOpen(e,n=!0){let r=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.lastChild)i++;return new J(e,r,i)}}J.empty=new J(H.empty,0,0);function vk(t,e,n){let{index:r,offset:i}=t.findIndex(e),s=t.maybeChild(r),{index:o,offset:l}=t.findIndex(n);if(i==e||s.isText){if(l!=n&&!t.child(o).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=o)throw new RangeError("Removing non-flat range");return t.replaceChild(r,s.copy(vk(s.content,e-i-1,n-i-1)))}function kk(t,e,n,r){let{index:i,offset:s}=t.findIndex(e),o=t.maybeChild(i);if(s==e||o.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));let l=kk(o.content,e-s-1,n);return l&&t.replaceChild(i,o.copy(l))}function $O(t,e,n){if(n.openStart>t.depth)throw new wc("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new wc("Inconsistent open depths");return _k(t,e,n,0)}function _k(t,e,n,r){let i=t.index(r),s=t.node(r);if(i==e.index(r)&&r<t.depth-n.openStart){let o=_k(t,e,n,r+1);return s.copy(s.content.replaceChild(i,o))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let o=t.parent,l=o.content;return fs(o,l.cut(0,t.parentOffset).append(n.content).append(l.cut(e.parentOffset)))}else{let{start:o,end:l}=WO(n,t);return fs(s,Ck(t,o,l,e,r))}else return fs(s,Sc(t,e,r))}function Ek(t,e){if(!e.type.compatibleContent(t.type))throw new wc("Cannot join "+e.type.name+" onto "+t.type.name)}function Xd(t,e,n){let r=t.node(n);return Ek(r,e.node(n)),r}function cs(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Cl(t,e,n,r){let i=(e||t).node(n),s=0,o=e?e.index(n):i.childCount;t&&(s=t.index(n),t.depth>n?s++:t.textOffset&&(cs(t.nodeAfter,r),s++));for(let l=s;l<o;l++)cs(i.child(l),r);e&&e.depth==n&&e.textOffset&&cs(e.nodeBefore,r)}function fs(t,e){return t.type.checkContent(e),t.copy(e)}function Ck(t,e,n,r,i){let s=t.depth>i&&Xd(t,e,i+1),o=r.depth>i&&Xd(n,r,i+1),l=[];return Cl(null,t,i,l),s&&o&&e.index(i)==n.index(i)?(Ek(s,o),cs(fs(s,Ck(t,e,n,r,i+1)),l)):(s&&cs(fs(s,Sc(t,e,i+1)),l),Cl(e,n,i,l),o&&cs(fs(o,Sc(n,r,i+1)),l)),Cl(r,null,i,l),new H(l)}function Sc(t,e,n){let r=[];if(Cl(null,t,n,r),t.depth>n){let i=Xd(t,e,n+1);cs(fs(i,Sc(t,e,n+1)),r)}return Cl(e,null,n,r),new H(r)}function WO(t,e){let n=e.depth-t.openStart,i=e.node(n).copy(t.content);for(let s=n-1;s>=0;s--)i=e.node(s).copy(H.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}class aa{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(n);return r?e.child(n).cut(r):i}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let s=0;s<e;s++)i+=r.child(s).nodeSize;return i}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return ve.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),i=e.maybeChild(n);if(!r){let l=r;r=i,i=l}let s=r.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,i=e.parent.maybeChild(e.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!i||!r[s].isInSet(i.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new vc(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],i=0,s=n;for(let o=e;;){let{index:l,offset:a}=o.content.findIndex(s),u=s-a;if(r.push(o,l,i+a),!u||(o=o.child(l),o.isText))break;s=u-1,i+=a+1}return new aa(n,r,s)}static resolveCached(e,n){for(let i=0;i<ch.length;i++){let s=ch[i];if(s.pos==n&&s.doc==e)return s}let r=ch[fh]=aa.resolve(e,n);return fh=(fh+1)%qO,r}}let ch=[],fh=0,qO=12;class vc{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const KO=Object.create(null);let hs=class ep{constructor(e,n,r,i=ve.none){this.type=e,this.attrs=n,this.marks=i,this.content=r||H.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,i=0){this.content.nodesBetween(e,n,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,i){return this.content.textBetween(e,n,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&yc(this.attrs,n||e.defaultAttrs||KO)&&ve.sameSet(this.marks,r||ve.none)}copy(e=null){return e==this.content?this:new ep(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new ep(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return J.empty;let i=this.resolve(e),s=this.resolve(n),o=r?0:i.sharedDepth(n),l=i.start(o),u=i.node(o).content.cut(i.pos-l,s.pos-l);return new J(u,i.depth-o,s.depth-o)}replace(e,n,r){return $O(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:i}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(i==e||n.isText)return n;e-=i+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}}resolve(e){return aa.resolveCached(this,e)}resolveNoCache(e){return aa.resolve(this,e)}rangeHasMark(e,n,r){let i=!1;return n>e&&this.nodesBetween(e,n,s=>(r.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),bk(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=H.empty,i=0,s=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,i,s),l=o&&o.matchFragment(this.content,n);if(!l||!l.validEnd)return!1;for(let a=i;a<s;a++)if(!this.type.allowsMarks(r.child(a).marks))return!1;return!0}canReplaceWith(e,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(e).matchType(r),o=s&&s.matchFragment(this.content,n);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=ve.none;for(let n=0;n<this.marks.length;n++)e=this.marks[n].addToSet(e);if(!ve.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let i=H.fromJSON(e,n.content);return e.nodeType(n.type).create(n.attrs,i,r)}};hs.prototype.text=void 0;class kc extends hs{constructor(e,n,r,i){if(super(e,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):bk(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new kc(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new kc(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function bk(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class Cs{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new GO(e,n);if(r.next==null)return Cs.empty;let i=xk(r);r.next&&r.err("Unexpected trailing text");let s=tR(eR(i));return nR(s,r),s}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let i=this;for(let s=n;i&&s<r;s++)i=i.matchType(e.child(s).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let i=[this];function s(o,l){let a=o.matchFragment(e,r);if(a&&(!n||a.validEnd))return H.from(l.map(u=>u.createAndFill()));for(let u=0;u<o.next.length;u++){let{type:c,next:f}=o.next[u];if(!(c.isText||c.hasRequiredAttrs())&&i.indexOf(f)==-1){i.push(f);let h=s(f,l.concat(c));if(h)return h}}return null}return s(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),s=i.match;if(s.matchType(e)){let o=[];for(let l=i;l.type;l=l.via)o.push(l.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:l,next:a}=s.next[o];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in n)&&(!i.type||a.validEnd)&&(r.push({match:l.contentMatch,type:l,via:i}),n[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&n(r.next[i].next)}return n(this),e.map((r,i)=>{let s=i+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)s+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return s}).join(`
`)}}Cs.empty=new Cs(!0);class GO{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function xk(t){let e=[];do e.push(JO(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function JO(t){let e=[];do e.push(YO(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function YO(t){let e=XO(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=QO(t,e);else break;return e}function uy(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function QO(t,e){let n=uy(t),r=n;return t.eat(",")&&(t.next!="}"?r=uy(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function ZO(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let i=[];for(let s in n){let o=n[s];o.groups.indexOf(e)>-1&&i.push(o)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function XO(t){if(t.eat("(")){let e=xk(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=ZO(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function eR(t){let e=[[]];return i(s(t,0),n()),e;function n(){return e.push([])-1}function r(o,l,a){let u={term:a,to:l};return e[o].push(u),u}function i(o,l){o.forEach(a=>a.to=l)}function s(o,l){if(o.type=="choice")return o.exprs.reduce((a,u)=>a.concat(s(u,l)),[]);if(o.type=="seq")for(let a=0;;a++){let u=s(o.exprs[a],l);if(a==o.exprs.length-1)return u;i(u,l=n())}else if(o.type=="star"){let a=n();return r(l,a),i(s(o.expr,a),a),[r(a)]}else if(o.type=="plus"){let a=n();return i(s(o.expr,l),a),i(s(o.expr,a),a),[r(a)]}else{if(o.type=="opt")return[r(l)].concat(s(o.expr,l));if(o.type=="range"){let a=l;for(let u=0;u<o.min;u++){let c=n();i(s(o.expr,a),c),a=c}if(o.max==-1)i(s(o.expr,a),a);else for(let u=o.min;u<o.max;u++){let c=n();r(a,c),i(s(o.expr,a),c),a=c}return[r(a)]}else{if(o.type=="name")return[r(l,void 0,o.value)];throw new Error("Unknown expr type")}}}}function Tk(t,e){return e-t}function cy(t,e){let n=[];return r(e),n.sort(Tk);function r(i){let s=t[i];if(s.length==1&&!s[0].term)return r(s[0].to);n.push(i);for(let o=0;o<s.length;o++){let{term:l,to:a}=s[o];!l&&n.indexOf(a)==-1&&r(a)}}}function tR(t){let e=Object.create(null);return n(cy(t,0));function n(r){let i=[];r.forEach(o=>{t[o].forEach(({term:l,to:a})=>{if(!l)return;let u;for(let c=0;c<i.length;c++)i[c][0]==l&&(u=i[c][1]);cy(t,a).forEach(c=>{u||i.push([l,u=[]]),u.indexOf(c)==-1&&u.push(c)})})});let s=e[r.join(",")]=new Cs(r.indexOf(t.length-1)>-1);for(let o=0;o<i.length;o++){let l=i[o][1].sort(Tk);s.next.push({type:i[o][0],next:e[l.join(",")]||n(l)})}return s}}function nR(t,e){for(let n=0,r=[t];n<r.length;n++){let i=r[n],s=!i.validEnd,o=[];for(let l=0;l<i.next.length;l++){let{type:a,next:u}=i.next[l];o.push(a.name),s&&!(a.isText||a.hasRequiredAttrs())&&(s=!1),r.indexOf(u)==-1&&r.push(u)}s&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Ik(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function Ok(t,e){let n=Object.create(null);for(let r in t){let i=e&&e[r];if(i===void 0){let s=t[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function Rk(t){let e=Object.create(null);if(t)for(let n in t)e[n]=new rR(t[n]);return e}let fy=class Ak{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=Rk(r.attrs),this.defaultAttrs=Ik(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Cs.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:Ok(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new hs(this,this.computeAttrs(e),H.from(n),ve.setFrom(r))}createChecked(e=null,n,r){return n=H.from(n),this.checkContent(n),new hs(this,this.computeAttrs(e),n,ve.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=H.from(n),n.size){let o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}let i=this.contentMatch.matchFragment(n),s=i&&i.fillBefore(H.empty,!0);return s?new hs(this,e,n.append(s),ve.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:ve.none:e}static compile(e,n){let r=Object.create(null);e.forEach((s,o)=>r[s]=new Ak(s,n,o));let i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};class rR{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}}class cf{constructor(e,n,r,i){this.name=e,this.rank=n,this.schema=r,this.spec=i,this.attrs=Rk(i.attrs),this.excluded=null;let s=Ik(this.attrs);this.instance=s?new ve(this,s):null}create(e=null){return!e&&this.instance?this.instance:new ve(this,Ok(this.attrs,e))}static compile(e,n){let r=Object.create(null),i=0;return e.forEach((s,o)=>r[s]=new cf(s,i++,n,o)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}excludes(e){return this.excluded.indexOf(e)>-1}}class iR{constructor(e){this.cached=Object.create(null);let n=this.spec={};for(let i in e)n[i]=e[i];n.nodes=pt.from(e.nodes),n.marks=pt.from(e.marks||{}),this.nodes=fy.compile(this.spec.nodes,this),this.marks=cf.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],o=s.spec.content||"",l=s.spec.marks;s.contentMatch=r[o]||(r[o]=Cs.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.markSet=l=="_"?null:l?hy(this,l.split(" ")):l==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],o=s.spec.excludes;s.excluded=o==null?[s]:o==""?[]:hy(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof fy){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,i)}text(e,n){let r=this.nodes.text;return new kc(r,r.defaultAttrs,e,ve.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeFromJSON(e){return hs.fromJSON(this,e)}markFromJSON(e){return ve.fromJSON(this,e)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function hy(t,e){let n=[];for(let r=0;r<e.length;r++){let i=e[r],s=t.marks[i],o=s;if(s)n.push(s);else for(let l in t.marks){let a=t.marks[l];(i=="_"||a.spec.group&&a.spec.group.split(" ").indexOf(i)>-1)&&n.push(o=a)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}let Nk=class tp{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[],n.forEach(r=>{r.tag?this.tags.push(r):r.style&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let i=e.nodes[r.node];return i.contentMatch.matchType(i)})}parse(e,n={}){let r=new py(this,n,!1);return r.addAll(e,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new py(this,n,!0);return r.addAll(e,n.from,n.to),J.maxOpen(r.finish())}matchTag(e,n,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(lR(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||n.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,n,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],l=o.style;if(!(l.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=n))){if(o.getAttrs){let a=o.getAttrs(n);if(a===!1)continue;o.attrs=a||void 0}return o}}}static schemaRules(e){let n=[];function r(i){let s=i.priority==null?50:i.priority,o=0;for(;o<n.length;o++){let l=n[o];if((l.priority==null?50:l.priority)<s)break}n.splice(o,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(o=>{r(o=gy(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(o=>{r(o=gy(o)),o.node||o.ignore||o.mark||(o.node=i)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new tp(e,tp.schemaRules(e)))}};const Mk={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},sR={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Dk={ol:!0,ul:!0},_c=1,Ec=2,bl=4;function dy(t,e,n){return e!=null?(e?_c:0)|(e==="full"?Ec:0):t&&t.whitespace=="pre"?_c|Ec:n&~bl}class lu{constructor(e,n,r,i,s,o,l){this.type=e,this.attrs=n,this.marks=r,this.pendingMarks=i,this.solid=s,this.options=l,this.content=[],this.activeMarks=ve.none,this.stashMarks=[],this.match=o||(l&bl?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(H.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&_c)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let n=H.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(H.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}popFromStashMark(e){for(let n=this.stashMarks.length-1;n>=0;n--)if(e.eq(this.stashMarks[n]))return this.stashMarks.splice(n,1)[0]}applyPending(e){for(let n=0,r=this.pendingMarks;n<r.length;n++){let i=r[n];(this.type?this.type.allowsMarkType(i.type):uR(i.type,e))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Mk.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class py{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0;let i=n.topNode,s,o=dy(null,n.preserveWhitespace,0)|(r?bl:0);i?s=new lu(i.type,i.attrs,ve.none,ve.none,!0,n.topMatch||i.type.contentMatch,o):r?s=new lu(null,null,ve.none,ve.none,!0,null,o):s=new lu(e.schema.topNodeType,null,ve.none,ve.none,!0,null,o),this.nodes=[s],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){e.nodeType==3?this.addTextNode(e):e.nodeType==1&&this.addElement(e)}withStyleRules(e,n){let r=e.getAttribute("style");if(!r)return n();let i=this.readStyles(aR(r));if(!i)return;let[s,o]=i,l=this.top;for(let a=0;a<o.length;a++)this.removePendingMark(o[a],l);for(let a=0;a<s.length;a++)this.addPendingMark(s[a]);n();for(let a=0;a<s.length;a++)this.removePendingMark(s[a],l);for(let a=0;a<o.length;a++)this.addPendingMark(o[a])}addTextNode(e){let n=e.nodeValue,r=this.top;if(r.options&Ec||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(r.options&_c)r.options&Ec?n=n.replace(/\r\n?/g,`
`):n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let i=r.content[r.content.length-1],s=e.previousSibling;(!i||s&&s.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n)),this.findInText(e)}else this.findInside(e)}addElement(e,n){let r=e.nodeName.toLowerCase(),i;Dk.hasOwnProperty(r)&&this.parser.normalizeLists&&oR(e);let s=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,n));if(s?s.ignore:sR.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(e=s.skip);let o,l=this.top,a=this.needsBlock;if(Mk.hasOwnProperty(r))l.content.length&&l.content[0].isInline&&this.open&&(this.open--,l=this.top),o=!0,l.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}s&&s.skip?this.addAll(e):this.withStyleRules(e,()=>this.addAll(e)),o&&this.sync(l),this.needsBlock=a}else this.withStyleRules(e,()=>{this.addElementByRule(e,s,s.consuming===!1?i:void 0)})}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let n=ve.none,r=ve.none;for(let i=0;i<e.length;i+=2)for(let s=void 0;;){let o=this.parser.matchStyle(e[i],e[i+1],this,s);if(!o)break;if(o.ignore)return null;if(o.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(l=>{o.clearMark(l)&&(r=l.addToSet(r))}):n=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(n),o.consuming===!1)s=o;else break}return[n,r]}addElementByRule(e,n,r){let i,s,o;n.node?(s=this.parser.schema.nodes[n.node],s.isLeaf?this.insertNode(s.create(n.attrs))||this.leafFallback(e):i=this.enter(s,n.attrs||null,n.preserveWhitespace)):(o=this.parser.schema.marks[n.mark].create(n.attrs),this.addPendingMark(o));let l=this.top;if(s&&s.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(a=>this.insertNode(a));else{let a=e;typeof n.contentElement=="string"?a=e.querySelector(n.contentElement):typeof n.contentElement=="function"?a=n.contentElement(e):n.contentElement&&(a=n.contentElement),this.findAround(e,a,!0),this.addAll(a)}i&&this.sync(l)&&this.open--,o&&this.removePendingMark(o,l)}addAll(e,n,r){let i=n||0;for(let s=n?e.childNodes[n]:e.firstChild,o=r==null?null:e.childNodes[r];s!=o;s=s.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(s);this.findAtPoint(e,i)}findPlace(e){let n,r;for(let i=this.open;i>=0;i--){let s=this.nodes[i],o=s.findWrapping(e);if(o&&(!n||n.length>o.length)&&(n=o,r=s,!o.length)||s.solid)break}if(!n)return!1;this.sync(r);for(let i=0;i<n.length;i++)this.enterInner(n[i],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let n=this.textblockFromContext();n&&this.enterInner(n)}if(this.findPlace(e)){this.closeExtra();let n=this.top;n.applyPending(e.type),n.match&&(n.match=n.match.matchType(e.type));let r=n.activeMarks;for(let i=0;i<e.marks.length;i++)(!n.type||n.type.allowsMarkType(e.marks[i].type))&&(r=e.marks[i].addToSet(r));return n.content.push(e.mark(r)),!0}return!1}enter(e,n,r){let i=this.findPlace(e.create(n));return i&&this.enterInner(e,n,!0,r),i}enterInner(e,n=null,r=!1,i){this.closeExtra();let s=this.top;s.applyPending(e),s.match=s.match&&s.match.matchType(e);let o=dy(e,i,s.options);s.options&bl&&s.content.length==0&&(o|=bl),this.nodes.push(new lu(e,n,s.activeMarks,s.pendingMarks,r,null,o)),this.open++}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let n=this.open;n>=0;n--)if(this.nodes[n]==e)return this.open=n,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(i?0:1),o=(l,a)=>{for(;l>=0;l--){let u=n[l];if(u==""){if(l==n.length-1||l==0)continue;for(;a>=s;a--)if(o(l-1,a))return!0;return!1}else{let c=a>0||a==0&&i?this.nodes[a].type:r&&a>=s?r.node(a-s).type:null;if(!c||c.name!=u&&c.groups.indexOf(u)==-1)return!1;a--}}return!0};return o(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(e){let n=cR(e,this.top.pendingMarks);n&&this.top.stashMarks.push(n),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,n){for(let r=this.open;r>=0;r--){let i=this.nodes[r];if(i.pendingMarks.lastIndexOf(e)>-1)i.pendingMarks=e.removeFromSet(i.pendingMarks);else{i.activeMarks=e.removeFromSet(i.activeMarks);let o=i.popFromStashMark(e);o&&i.type&&i.type.allowsMarkType(o.type)&&(i.activeMarks=o.addToSet(i.activeMarks))}if(i==n)break}}}function oR(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Dk.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function lR(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function aR(t){let e=/\s*([\w-]+)\s*:\s*([^;]+)/g,n,r=[];for(;n=e.exec(t);)r.push(n[1],n[2].trim());return r}function gy(t){let e={};for(let n in t)e[n]=t[n];return e}function uR(t,e){let n=e.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(t))continue;let s=[],o=l=>{s.push(l);for(let a=0;a<l.edgeCount;a++){let{type:u,next:c}=l.edge(a);if(u==e||s.indexOf(c)<0&&o(c))return!0}};if(o(i.contentMatch))return!0}}function cR(t,e){for(let n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}class Br{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=hh(n).createDocumentFragment());let i=r,s=[];return e.forEach(o=>{if(s.length||o.marks.length){let l=0,a=0;for(;l<s.length&&a<o.marks.length;){let u=o.marks[a];if(!this.marks[u.type.name]){a++;continue}if(!u.eq(s[l][0])||u.type.spec.spanning===!1)break;l++,a++}for(;l<s.length;)i=s.pop()[1];for(;a<o.marks.length;){let u=o.marks[a++],c=this.serializeMark(u,o.isInline,n);c&&(s.push([u,i]),i.appendChild(c.dom),i=c.contentDOM||c.dom)}}i.appendChild(this.serializeNodeInner(o,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:i}=Br.renderSpec(hh(n),this.nodes[e.type.name](e));if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,i)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let i=e.marks.length-1;i>=0;i--){let s=this.serializeMark(e.marks[i],e.isInline,n);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(e,n,r={}){let i=this.marks[e.type.name];return i&&Br.renderSpec(hh(r),i(e,n))}static renderSpec(e,n,r=null){if(typeof n=="string")return{dom:e.createTextNode(n)};if(n.nodeType!=null)return{dom:n};if(n.dom&&n.dom.nodeType!=null)return n;let i=n[0],s=i.indexOf(" ");s>0&&(r=i.slice(0,s),i=i.slice(s+1));let o,l=r?e.createElementNS(r,i):e.createElement(i),a=n[1],u=1;if(a&&typeof a=="object"&&a.nodeType==null&&!Array.isArray(a)){u=2;for(let c in a)if(a[c]!=null){let f=c.indexOf(" ");f>0?l.setAttributeNS(c.slice(0,f),c.slice(f+1),a[c]):l.setAttribute(c,a[c])}}for(let c=u;c<n.length;c++){let f=n[c];if(f===0){if(c<n.length-1||c>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:h,contentDOM:p}=Br.renderSpec(e,f,r);if(l.appendChild(h),p){if(o)throw new RangeError("Multiple content holes");o=p}}}return{dom:l,contentDOM:o}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Br(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=my(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return my(e.marks)}}function my(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function hh(t){return t.document||window.document}const Bk=65535,Pk=Math.pow(2,16);function fR(t,e){return t+e*Pk}function yy(t){return t&Bk}function hR(t){return(t-(t&Bk))/Pk}const Lk=1,Fk=2,Nu=4,Uk=8;class np{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&Uk)>0}get deletedBefore(){return(this.delInfo&(Lk|Nu))>0}get deletedAfter(){return(this.delInfo&(Fk|Nu))>0}get deletedAcross(){return(this.delInfo&Nu)>0}}class un{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&un.empty)return un.empty}recover(e){let n=0,r=yy(e);if(!this.inverted)for(let i=0;i<r;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+n+hR(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+s],c=this.ranges[l+o],f=a+u;if(e<=f){let h=u?e==a?-1:e==f?1:n:n,p=a+i+(h<0?0:c);if(r)return p;let m=e==(n<0?a:f)?null:fR(l/3,e-a),v=e==a?Fk:e==f?Lk:Nu;return(n<0?e!=a:e!=f)&&(v|=Uk),new np(p,v,m)}i+=c-u}return r?e+i:new np(e+i,0,null)}touches(e,n){let r=0,i=yy(n),s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+s],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+o]-u}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],l=o-(this.inverted?s:0),a=o+(this.inverted?0:s),u=this.ranges[i+n],c=this.ranges[i+r];e(l,l+u,a,a+c),s+=c-u}}invert(){return new un(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?un.empty:new un(e<0?[0,-e,0]:[0,0,e])}}un.empty=new un([]);class go{constructor(e=[],n,r=0,i=e.length){this.maps=e,this.mirror=n,this.from=r,this.to=i}slice(e=0,n=this.maps.length){return new go(this.maps,this.mirror,e,n)}copy(){return new go(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,n){this.to=this.maps.push(e),n!=null&&this.setMirror(this.maps.length-1,n)}appendMapping(e){for(let n=0,r=this.maps.length;n<e.maps.length;n++){let i=e.getMirror(n);this.appendMap(e.maps[n],i!=null&&i<n?r+i:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this.maps.length+e.maps.length;n>=0;n--){let i=e.getMirror(n);this.appendMap(e.maps[n].invert(),i!=null&&i>n?r-i-1:void 0)}}invert(){let e=new go;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let i=0;for(let s=this.from;s<this.to;s++){let o=this.maps[s],l=o.mapResult(e,n);if(l.recover!=null){let a=this.getMirror(s);if(a!=null&&a>s&&a<this.to){s=a,e=this.maps[a].recover(l.recover);continue}}i|=l.delInfo,e=l.pos}return r?e:new np(e,i,null)}}const dh=Object.create(null);class At{getMap(){return un.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=dh[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in dh)throw new RangeError("Duplicate use of step JSON ID "+e);return dh[e]=n,n.prototype.jsonID=e,n}}class Qe{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new Qe(e,null)}static fail(e){return new Qe(null,e)}static fromReplace(e,n,r,i){try{return Qe.ok(e.replace(n,r,i))}catch(s){if(s instanceof wc)return Qe.fail(s.message);throw s}}}function Jg(t,e,n){let r=[];for(let i=0;i<t.childCount;i++){let s=t.child(i);s.content.size&&(s=s.copy(Jg(s.content,e,s))),s.isInline&&(s=e(s,n,i)),r.push(s)}return H.fromArray(r)}class hi extends At{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new J(Jg(n.content,(o,l)=>!o.isAtom||!l.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),n.openStart,n.openEnd);return Qe.fromReplace(e,this.from,this.to,s)}invert(){return new hr(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new hi(n.pos,r.pos,this.mark)}merge(e){return e instanceof hi&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new hi(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new hi(n.from,n.to,e.markFromJSON(n.mark))}}At.jsonID("addMark",hi);class hr extends At{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new J(Jg(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),n.openStart,n.openEnd);return Qe.fromReplace(e,this.from,this.to,r)}invert(){return new hi(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new hr(n.pos,r.pos,this.mark)}merge(e){return e instanceof hr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new hr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new hr(n.from,n.to,e.markFromJSON(n.mark))}}At.jsonID("removeMark",hr);class di extends At{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Qe.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return Qe.fromReplace(e,this.pos,this.pos+1,new J(H.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(r))return new di(this.pos,n.marks[i]);return new di(this.pos,this.mark)}}return new Ao(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new di(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new di(n.pos,e.markFromJSON(n.mark))}}At.jsonID("addNodeMark",di);class Ao extends At{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return Qe.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return Qe.fromReplace(e,this.pos,this.pos+1,new J(H.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new di(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Ao(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ao(n.pos,e.markFromJSON(n.mark))}}At.jsonID("removeNodeMark",Ao);class Tt extends At{constructor(e,n,r,i=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=i}apply(e){return this.structure&&rp(e,this.from,this.to)?Qe.fail("Structure replace would overwrite content"):Qe.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new un([this.from,this.to-this.from,this.slice.size])}invert(e){return new Tt(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new Tt(n.pos,Math.max(n.pos,r.pos),this.slice)}merge(e){if(!(e instanceof Tt)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?J.empty:new J(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Tt(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?J.empty:new J(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Tt(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Tt(n.from,n.to,J.fromJSON(e,n.slice),!!n.structure)}}At.jsonID("replace",Tt);class wt extends At{constructor(e,n,r,i,s,o,l=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=l}apply(e){if(this.structure&&(rp(e,this.from,this.gapFrom)||rp(e,this.gapTo,this.to)))return Qe.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return Qe.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?Qe.fromReplace(e,this.from,this.to,r):Qe.fail("Content does not fit in gap")}getMap(){return new un([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new wt(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),s=e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||i<n.pos||s>r.pos?null:new wt(n.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new wt(n.from,n.to,n.gapFrom,n.gapTo,J.fromJSON(e,n.slice),n.insert,!!n.structure)}}At.jsonID("replaceAround",wt);function rp(t,e,n){let r=t.resolve(e),i=n-e,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function dR(t,e,n,r){let i=[],s=[],o,l;t.doc.nodesBetween(e,n,(a,u,c)=>{if(!a.isInline)return;let f=a.marks;if(!r.isInSet(f)&&c.type.allowsMarkType(r.type)){let h=Math.max(u,e),p=Math.min(u+a.nodeSize,n),m=r.addToSet(f);for(let v=0;v<f.length;v++)f[v].isInSet(m)||(o&&o.to==h&&o.mark.eq(f[v])?o.to=p:i.push(o=new hr(h,p,f[v])));l&&l.to==h?l.to=p:s.push(l=new hi(h,p,r))}}),i.forEach(a=>t.step(a)),s.forEach(a=>t.step(a))}function pR(t,e,n,r){let i=[],s=0;t.doc.nodesBetween(e,n,(o,l)=>{if(!o.isInline)return;s++;let a=null;if(r instanceof cf){let u=o.marks,c;for(;c=r.isInSet(u);)(a||(a=[])).push(c),u=c.removeFromSet(u)}else r?r.isInSet(o.marks)&&(a=[r]):a=o.marks;if(a&&a.length){let u=Math.min(l+o.nodeSize,n);for(let c=0;c<a.length;c++){let f=a[c],h;for(let p=0;p<i.length;p++){let m=i[p];m.step==s-1&&f.eq(i[p].style)&&(h=m)}h?(h.to=u,h.step=s):i.push({style:f,from:Math.max(l,e),to:u,step:s})}}}),i.forEach(o=>t.step(new hr(o.from,o.to,o.style)))}function gR(t,e,n,r=n.contentMatch){let i=t.doc.nodeAt(e),s=[],o=e+1;for(let l=0;l<i.childCount;l++){let a=i.child(l),u=o+a.nodeSize,c=r.matchType(a.type);if(!c)s.push(new Tt(o,u,J.empty));else{r=c;for(let f=0;f<a.marks.length;f++)n.allowsMarkType(a.marks[f].type)||t.step(new hr(o,u,a.marks[f]));if(a.isText&&!n.spec.code){let f,h=/\r?\n|\r/g,p;for(;f=h.exec(a.text);)p||(p=new J(H.from(n.schema.text(" ",n.allowedMarks(a.marks))),0,0)),s.push(new Tt(o+f.index,o+f.index+f[0].length,p))}}o=u}if(!r.validEnd){let l=r.fillBefore(H.empty,!0);t.replace(o,o,new J(l,0,0))}for(let l=s.length-1;l>=0;l--)t.step(s[l])}function mR(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function Oa(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth;;--r){let i=t.$from.node(r),s=t.$from.index(r),o=t.$to.indexAfter(r);if(r<t.depth&&i.canReplace(s,o,n))return r;if(r==0||i.type.spec.isolating||!mR(i,s,o))break}return null}function yR(t,e,n){let{$from:r,$to:i,depth:s}=e,o=r.before(s+1),l=i.after(s+1),a=o,u=l,c=H.empty,f=0;for(let m=s,v=!1;m>n;m--)v||r.index(m)>0?(v=!0,c=H.from(r.node(m).copy(c)),f++):a--;let h=H.empty,p=0;for(let m=s,v=!1;m>n;m--)v||i.after(m+1)<i.end(m)?(v=!0,h=H.from(i.node(m).copy(h)),p++):u++;t.step(new wt(a,u,o,l,new J(c.append(h),f,p),c.size-f,!0))}function Yg(t,e,n=null,r=t){let i=wR(t,e),s=i&&SR(r,e);return s?i.map(wy).concat({type:e,attrs:n}).concat(s.map(wy)):null}function wy(t){return{type:t,attrs:null}}function wR(t,e){let{parent:n,startIndex:r,endIndex:i}=t,s=n.contentMatchAt(r).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return n.canReplaceWith(r,i,o)?s:null}function SR(t,e){let{parent:n,startIndex:r,endIndex:i}=t,s=n.child(r),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let a=(o.length?o[o.length-1]:e).contentMatch;for(let u=r;a&&u<i;u++)a=a.matchType(n.child(u).type);return!a||!a.validEnd?null:o}function vR(t,e,n){let r=H.empty;for(let o=n.length-1;o>=0;o--){if(r.size){let l=n[o].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=H.from(n[o].type.create(n[o].attrs,r))}let i=e.start,s=e.end;t.step(new wt(i,s,i,s,new J(r,0,0),n.length,!0))}function kR(t,e,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=t.steps.length;t.doc.nodesBetween(e,n,(o,l)=>{if(o.isTextblock&&!o.hasMarkup(r,i)&&_R(t.doc,t.mapping.slice(s).map(l),r)){t.clearIncompatible(t.mapping.slice(s).map(l,1),r);let a=t.mapping.slice(s),u=a.map(l,1),c=a.map(l+o.nodeSize,1);return t.step(new wt(u,c,u+1,c-1,new J(H.from(r.create(i,null,o.marks)),0,0),1,!0)),!1}})}function _R(t,e,n){let r=t.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}function ER(t,e,n,r,i){let s=t.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");n||(n=s.type);let o=n.create(r,null,i||s.marks);if(s.isLeaf)return t.replaceWith(e,e+s.nodeSize,o);if(!n.validContent(s.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new wt(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new J(H.from(o),0,0),1,!0))}function mo(t,e,n=1,r){let i=t.resolve(e),s=i.depth-n,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,c=n-2;u>s;u--,c--){let f=i.node(u),h=i.index(u);if(f.type.spec.isolating)return!1;let p=f.content.cutByIndex(h,f.childCount),m=r&&r[c+1];m&&(p=p.replaceChild(0,m.type.create(m.attrs)));let v=r&&r[c]||f;if(!f.canReplace(h+1,f.childCount)||!v.type.validContent(p))return!1}let l=i.indexAfter(s),a=r&&r[0];return i.node(s).canReplaceWith(l,l,a?a.type:i.node(s+1).type)}function CR(t,e,n=1,r){let i=t.doc.resolve(e),s=H.empty,o=H.empty;for(let l=i.depth,a=i.depth-n,u=n-1;l>a;l--,u--){s=H.from(i.node(l).copy(s));let c=r&&r[u];o=H.from(c?c.type.create(c.attrs,o):i.node(l).copy(o))}t.step(new Tt(e,e,new J(s.append(o),n,n),!0))}function $o(t,e){let n=t.resolve(e),r=n.index();return zk(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function zk(t,e){return!!(t&&e&&!t.isLeaf&&t.canAppend(e))}function Vk(t,e,n=-1){let r=t.resolve(e);for(let i=r.depth;;i--){let s,o,l=r.index(i);if(i==r.depth?(s=r.nodeBefore,o=r.nodeAfter):n>0?(s=r.node(i+1),l++,o=r.node(i).maybeChild(l)):(s=r.node(i).maybeChild(l-1),o=r.node(i+1)),s&&!s.isTextblock&&zk(s,o)&&r.node(i).canReplace(l,l+1))return e;if(i==0)break;e=n<0?r.before(i):r.after(i)}}function bR(t,e,n){let r=new Tt(e-n,e+n,J.empty,!0);t.step(r)}function xR(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,n))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,n))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}function jk(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let i=n.content;for(let s=0;s<n.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(n.openStart==0&&n.size?2:1);s++)for(let o=r.depth;o>=0;o--){let l=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,a=r.index(o)+(l>0?1:0),u=r.node(o),c=!1;if(s==1)c=u.canReplace(a,a,i);else{let f=u.contentMatchAt(a).findWrapping(i.firstChild.type);c=f&&u.canReplaceWith(a,a,f[0])}if(c)return l==0?r.pos:l<0?r.before(o+1):r.after(o+1)}return null}function Qg(t,e,n=e,r=J.empty){if(e==n&&!r.size)return null;let i=t.resolve(e),s=t.resolve(n);return Hk(i,s,r)?new Tt(e,n,r):new TR(i,s,r).fit()}function Hk(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class TR{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=H.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=H.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let s=this.placed,o=r.depth,l=i.depth;for(;o&&l&&s.childCount==1;)s=s.firstChild.content,o--,l--;let a=new J(s,o,l);return e>-1?new wt(r.pos,e,this.$to.pos,this.$to.end(),a,n):a.size||r.pos!=this.$to.pos?new Tt(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let s=n.firstChild;if(n.childCount>1&&(i=0),s.type.spec.isolating&&i<=r){e=r;break}n=s.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let i,s=null;r?(s=ph(this.unplaced.content,r-1).firstChild,i=s.content):i=this.unplaced.content;let o=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:u}=this.frontier[l],c,f=null;if(n==1&&(o?u.matchType(o.type)||(f=u.fillBefore(H.from(o),!1)):s&&a.compatibleContent(s.type)))return{sliceDepth:r,frontierDepth:l,parent:s,inject:f};if(n==2&&o&&(c=u.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:l,parent:s,wrap:c};if(s&&u.matchType(s.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=ph(e,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new J(e,n+1,Math.max(r,i.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=ph(e,n);if(i.childCount<=1&&n>0){let s=e.size-n<=n+i.size;this.unplaced=new J(al(e,n-1,1),n-1,s?n-1:r)}else this.unplaced=new J(al(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:i,wrap:s}){for(;this.depth>n;)this.closeFrontierNode();if(s)for(let v=0;v<s.length;v++)this.openFrontierNode(s[v]);let o=this.unplaced,l=r?r.content:o.content,a=o.openStart-e,u=0,c=[],{match:f,type:h}=this.frontier[n];if(i){for(let v=0;v<i.childCount;v++)c.push(i.child(v));f=f.matchFragment(i)}let p=l.size+e-(o.content.size-o.openEnd);for(;u<l.childCount;){let v=l.child(u),C=f.matchType(v.type);if(!C)break;u++,(u>1||a==0||v.content.size)&&(f=C,c.push($k(v.mark(h.allowedMarks(v.marks)),u==1?a:0,u==l.childCount?p:-1)))}let m=u==l.childCount;m||(p=-1),this.placed=ul(this.placed,n,H.from(c)),this.frontier[n].match=f,m&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let v=0,C=l;v<p;v++){let y=C.lastChild;this.frontier.push({type:y.type,match:y.contentMatchAt(y.childCount)}),C=y.content}this.unplaced=m?e==0?J.empty:new J(al(o.content,e-1,1),e-1,p<0?o.openEnd:e-1):new J(al(o.content,e,u),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!gh(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:i}=this.frontier[n],s=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),o=gh(e,n,i,r,s);if(o){for(let l=n-1;l>=0;l--){let{match:a,type:u}=this.frontier[l],c=gh(e,l,u,a,!0);if(!c||c.childCount)continue e}return{depth:n,fit:o,move:s?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=ul(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let i=e.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,n=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=ul(this.placed,this.depth,H.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(H.empty,!0);n.childCount&&(this.placed=ul(this.placed,this.frontier.length,n))}}function al(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(al(t.firstChild.content,e-1,n)))}function ul(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(ul(t.lastChild.content,e-1,n)))}function ph(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function $k(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,$k(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(H.empty,!0)))),t.copy(r)}function gh(t,e,n,r,i){let s=t.node(e),o=i?t.indexAfter(e):t.index(e);if(o==s.childCount&&!n.compatibleContent(s.type))return null;let l=r.fillBefore(s.content,!0,o);return l&&!IR(n,s.content,o)?l:null}function IR(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function OR(t){return t.spec.defining||t.spec.definingForContent}function RR(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let i=t.doc.resolve(e),s=t.doc.resolve(n);if(Hk(i,s,r))return t.step(new Tt(e,n,r));let o=qk(i,t.doc.resolve(n));o[o.length-1]==0&&o.pop();let l=-(i.depth+1);o.unshift(l);for(let h=i.depth,p=i.pos-1;h>0;h--,p--){let m=i.node(h).type.spec;if(m.defining||m.definingAsContext||m.isolating)break;o.indexOf(h)>-1?l=h:i.before(h)==p&&o.splice(1,0,-h)}let a=o.indexOf(l),u=[],c=r.openStart;for(let h=r.content,p=0;;p++){let m=h.firstChild;if(u.push(m),p==r.openStart)break;h=m.content}for(let h=c-1;h>=0;h--){let p=u[h],m=OR(p.type);if(m&&!p.sameMarkup(i.node(Math.abs(l)-1)))c=h;else if(m||!p.type.isTextblock)break}for(let h=r.openStart;h>=0;h--){let p=(h+c+1)%(r.openStart+1),m=u[p];if(m)for(let v=0;v<o.length;v++){let C=o[(v+a)%o.length],y=!0;C<0&&(y=!1,C=-C);let _=i.node(C-1),x=i.index(C-1);if(_.canReplaceWith(x,x,m.type,m.marks))return t.replace(i.before(C),y?s.after(C):n,new J(Wk(r.content,0,r.openStart,p),p,r.openEnd))}}let f=t.steps.length;for(let h=o.length-1;h>=0&&(t.replace(e,n,r),!(t.steps.length>f));h--){let p=o[h];p<0||(e=i.before(p),n=s.after(p))}}function Wk(t,e,n,r,i){if(e<n){let s=t.firstChild;t=t.replaceChild(0,s.copy(Wk(s.content,e+1,n,r,s)))}if(e>r){let s=i.contentMatchAt(0),o=s.fillBefore(t).append(t);t=o.append(s.matchFragment(o).fillBefore(H.empty,!0))}return t}function AR(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let i=xR(t.doc,e,r.type);i!=null&&(e=n=i)}t.replaceRange(e,n,new J(H.from(r),0,0))}function NR(t,e,n){let r=t.doc.resolve(e),i=t.doc.resolve(n),s=qk(r,i);for(let o=0;o<s.length;o++){let l=s[o],a=o==s.length-1;if(a&&l==0||r.node(l).type.contentMatch.validEnd)return t.delete(r.start(l),i.end(l));if(l>0&&(a||r.node(l-1).canReplace(r.index(l-1),i.indexAfter(l-1))))return t.delete(r.before(l),i.after(l))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(e-r.start(o)==r.depth-o&&n>r.end(o)&&i.end(o)-n!=i.depth-o)return t.delete(r.before(o),n);t.delete(e,n)}function qk(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let i=r;i>=0;i--){let s=t.start(i);if(s<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(s==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==s-1)&&n.push(i)}return n}class yo extends At{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return Qe.fail("No node at attribute step's position");let r=Object.create(null);for(let s in n.attrs)r[s]=n.attrs[s];r[this.attr]=this.value;let i=n.type.create(r,null,n.marks);return Qe.fromReplace(e,this.pos,this.pos+1,new J(H.from(i),0,n.isLeaf?0:1))}getMap(){return un.empty}invert(e){return new yo(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new yo(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new yo(n.pos,n.attr,n.value)}}At.jsonID("attr",yo);class ua extends At{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let i in e.attrs)n[i]=e.attrs[i];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return Qe.ok(r)}getMap(){return un.empty}invert(e){return new ua(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new ua(n.attr,n.value)}}At.jsonID("docAttr",ua);let No=class extends Error{};No=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};No.prototype=Object.create(Error.prototype);No.prototype.constructor=No;No.prototype.name="TransformError";let MR=class{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new go}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new No(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=J.empty){let i=Qg(this.doc,e,n,r);return i&&this.step(i),this}replaceWith(e,n,r){return this.replace(e,n,new J(H.from(r),0,0))}delete(e,n){return this.replace(e,n,J.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return RR(this,e,n,r),this}replaceRangeWith(e,n,r){return AR(this,e,n,r),this}deleteRange(e,n){return NR(this,e,n),this}lift(e,n){return yR(this,e,n),this}join(e,n=1){return bR(this,e,n),this}wrap(e,n){return vR(this,e,n),this}setBlockType(e,n=e,r,i=null){return kR(this,e,n,r,i),this}setNodeMarkup(e,n,r=null,i){return ER(this,e,n,r,i),this}setNodeAttribute(e,n,r){return this.step(new yo(e,n,r)),this}setDocAttribute(e,n){return this.step(new ua(e,n)),this}addNodeMark(e,n){return this.step(new di(e,n)),this}removeNodeMark(e,n){if(!(n instanceof ve)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n=n.isInSet(r.marks),!n)return this}return this.step(new Ao(e,n)),this}split(e,n=1,r){return CR(this,e,n,r),this}addMark(e,n,r){return dR(this,e,n,r),this}removeMark(e,n,r){return pR(this,e,n,r),this}clearIncompatible(e,n,r){return gR(this,e,n,r),this}};const mh=Object.create(null);class me{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new DR(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=J.empty){let r=n.content.lastChild,i=null;for(let l=0;l<n.openEnd;l++)i=r,r=r.lastChild;let s=e.steps.length,o=this.ranges;for(let l=0;l<o.length;l++){let{$from:a,$to:u}=o[l],c=e.mapping.slice(s);e.replaceRange(c.map(a.pos),c.map(u.pos),l?J.empty:n),l==0&&ky(e,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:l}=i[s],a=e.mapping.slice(r),u=a.map(o.pos),c=a.map(l.pos);s?e.deleteRange(u,c):(e.replaceRangeWith(u,c,n),ky(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let i=e.parent.inlineContent?new _e(e):js(e.node(0),e.parent,e.pos,e.index(),n,r);if(i)return i;for(let s=e.depth-1;s>=0;s--){let o=n<0?js(e.node(0),e.node(s),e.before(s+1),e.index(s),n,r):js(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,n,r);if(o)return o}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new pn(e.node(0))}static atStart(e){return js(e,e,0,0,1)||new pn(e)}static atEnd(e){return js(e,e,e.content.size,e.childCount,-1)||new pn(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=mh[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in mh)throw new RangeError("Duplicate use of selection JSON ID "+e);return mh[e]=n,n.prototype.jsonID=e,n}getBookmark(){return _e.between(this.$anchor,this.$head).getBookmark()}}me.prototype.visible=!0;class DR{constructor(e,n){this.$from=e,this.$to=n}}let Sy=!1;function vy(t){!Sy&&!t.parent.inlineContent&&(Sy=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class _e extends me{constructor(e,n=e){vy(e),vy(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return me.near(r);let i=e.resolve(n.map(this.anchor));return new _e(i.parent.inlineContent?i:r,r)}replace(e,n=J.empty){if(super.replace(e,n),n==J.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof _e&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new ff(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new _e(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let i=e.resolve(n);return new this(i,r==n?i:e.resolve(r))}static between(e,n,r){let i=e.pos-n.pos;if((!r||i)&&(r=i>=0?1:-1),!n.parent.inlineContent){let s=me.findFrom(n,r,!0)||me.findFrom(n,-r,!0);if(s)n=s.$head;else return me.near(n,r)}return e.parent.inlineContent||(i==0?e=n:(e=(me.findFrom(e,-r,!0)||me.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=i<0&&(e=n))),new _e(e,n)}}me.jsonID("text",_e);class ff{constructor(e,n){this.anchor=e,this.head=n}map(e){return new ff(e.map(this.anchor),e.map(this.head))}resolve(e){return _e.between(e.resolve(this.anchor),e.resolve(this.head))}}class ne extends me{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:i}=n.mapResult(this.anchor),s=e.resolve(i);return r?me.near(s):new ne(s)}content(){return new J(H.from(this.node),0,0)}eq(e){return e instanceof ne&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Zg(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new ne(e.resolve(n.anchor))}static create(e,n){return new ne(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}ne.prototype.visible=!1;me.jsonID("node",ne);class Zg{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new ff(r,r):new Zg(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&ne.isSelectable(r)?new ne(n):me.near(n)}}class pn extends me{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=J.empty){if(n==J.empty){e.delete(0,e.doc.content.size);let r=me.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new pn(e)}map(e){return new pn(e)}eq(e){return e instanceof pn}getBookmark(){return BR}}me.jsonID("all",pn);const BR={map(){return this},resolve(t){return new pn(t)}};function js(t,e,n,r,i,s=!1){if(e.inlineContent)return _e.create(t,n);for(let o=r-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let l=e.child(o);if(l.isAtom){if(!s&&ne.isSelectable(l))return ne.create(t,n-(i<0?l.nodeSize:0))}else{let a=js(t,l,n+i,i<0?l.childCount:0,i,s);if(a)return a}n+=l.nodeSize*i}return null}function ky(t,e,n){let r=t.steps.length-1;if(r<e)return;let i=t.steps[r];if(!(i instanceof Tt||i instanceof wt))return;let s=t.mapping.maps[r],o;s.forEach((l,a,u,c)=>{o==null&&(o=c)}),t.setSelection(me.near(t.doc.resolve(o),n))}const _y=1,au=2,Ey=4;class PR extends MR{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|_y)&~au,this.storedMarks=null,this}get selectionSet(){return(this.updated&_y)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=au,this}ensureMarks(e){return ve.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&au)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~au,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||ve.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let i=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),r=r??n,!e)return this.deleteRange(n,r);let s=this.storedMarks;if(!s){let o=this.doc.resolve(n);s=r==n?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,i.text(e,s)),this.selection.empty||this.setSelection(me.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Ey,this}get scrolledIntoView(){return(this.updated&Ey)>0}}function Cy(t,e){return!e||!t?t:t.bind(e)}class cl{constructor(e,n,r){this.name=e,this.init=Cy(n.init,r),this.apply=Cy(n.apply,r)}}const LR=[new cl("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new cl("selection",{init(t,e){return t.selection||me.atStart(e.doc)},apply(t){return t.selection}}),new cl("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new cl("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class yh{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=LR.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new cl(r.key,r.spec.state,r))})}}class ro{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),i=null;for(;;){let s=!1;for(let o=0;o<this.config.plugins.length;o++){let l=this.config.plugins[o];if(l.spec.appendTransaction){let a=i?i[o].n:0,u=i?i[o].state:this,c=a<n.length&&l.spec.appendTransaction.call(l,a?n.slice(a):n,u,r);if(c&&r.filterTransaction(c,o)){if(c.setMeta("appendedTransaction",e),!i){i=[];for(let f=0;f<this.config.plugins.length;f++)i.push(f<o?{state:r,n:n.length}:{state:this,n:0})}n.push(c),r=r.applyInner(c),s=!0}i&&(i[o]={state:r,n:n.length})}}if(!s)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new ro(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let s=r[i];n[s.name]=s.apply(e,this[s.name],this,n)}return n}get tr(){return new PR(this)}static create(e){let n=new yh(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new ro(n);for(let i=0;i<n.fields.length;i++)r[n.fields[i].name]=n.fields[i].init(e,r);return r}reconfigure(e){let n=new yh(this.schema,e.plugins),r=n.fields,i=new ro(n);for(let s=0;s<r.length;s++){let o=r[s].name;i[o]=this.hasOwnProperty(o)?this[o]:r[s].init(e,i)}return i}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],s=i.spec.state;s&&s.toJSON&&(n[r]=s.toJSON.call(i,this[i.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new yh(e.schema,e.plugins),s=new ro(i);return i.fields.forEach(o=>{if(o.name=="doc")s.doc=hs.fromJSON(e.schema,n.doc);else if(o.name=="selection")s.selection=me.fromJSON(s.doc,n.selection);else if(o.name=="storedMarks")n.storedMarks&&(s.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let l in r){let a=r[l],u=a.spec.state;if(a.key==o.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(n,l)){s[o.name]=u.fromJSON.call(a,e,n[l],s);return}}s[o.name]=o.init(e,s)}}),s}}function Kk(t,e,n){for(let r in t){let i=t[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=Kk(i,e,{})),n[r]=i}return n}class kr{constructor(e){this.spec=e,this.props={},e.props&&Kk(e.props,this,this.props),this.key=e.key?e.key.key:Gk("plugin")}getState(e){return e[this.key]}}const wh=Object.create(null);function Gk(t){return t in wh?t+"$"+ ++wh[t]:(wh[t]=0,t+"$")}class Ra{constructor(e="key"){this.key=Gk(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Lt=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},ca=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let by=null;const Rr=function(t,e,n){let r=by||(by=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},bs=function(t,e,n,r){return n&&(xy(t,e,n,r,-1)||xy(t,e,n,r,1))},FR=/^(img|br|input|textarea|hr)$/i;function xy(t,e,n,r,i){for(;;){if(t==n&&e==r)return!0;if(e==(i<0?0:cr(t))){let s=t.parentNode;if(!s||s.nodeType!=1||Xg(t)||FR.test(t.nodeName)||t.contentEditable=="false")return!1;e=Lt(t)+(i<0?0:1),t=s}else if(t.nodeType==1){if(t=t.childNodes[e+(i<0?-1:0)],t.contentEditable=="false")return!1;e=i<0?cr(t):0}else return!1}}function cr(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function UR(t,e,n){for(let r=e==0,i=e==cr(t);r||i;){if(t==n)return!0;let s=Lt(t);if(t=t.parentNode,!t)return!1;r=r&&s==0,i=i&&s==cr(t)}}function Xg(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const hf=function(t){return t.focusNode&&bs(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Yi(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function zR(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function VR(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:r.offset}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:r.startOffset}}}const wr=typeof navigator<"u"?navigator:null,Ty=typeof document<"u"?document:null,zi=wr&&wr.userAgent||"",ip=/Edge\/(\d+)/.exec(zi),Jk=/MSIE \d/.exec(zi),sp=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(zi),sn=!!(Jk||sp||ip),Ci=Jk?document.documentMode:sp?+sp[1]:ip?+ip[1]:0,tr=!sn&&/gecko\/(\d+)/i.test(zi);tr&&+(/Firefox\/(\d+)/.exec(zi)||[0,0])[1];const op=!sn&&/Chrome\/(\d+)/.exec(zi),It=!!op,jR=op?+op[1]:0,jt=!sn&&!!wr&&/Apple Computer/.test(wr.vendor),Mo=jt&&(/Mobile\/\w+/.test(zi)||!!wr&&wr.maxTouchPoints>2),En=Mo||(wr?/Mac/.test(wr.platform):!1),HR=wr?/Win/.test(wr.platform):!1,qn=/Android \d/.test(zi),Aa=!!Ty&&"webkitFontSmoothing"in Ty.documentElement.style,$R=Aa?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function WR(t){return{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function xr(t,e){return typeof t=="number"?t:t[e]}function qR(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function Iy(t,e,n){let r=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,s=t.dom.ownerDocument;for(let o=n||t.dom;o;o=ca(o)){if(o.nodeType!=1)continue;let l=o,a=l==s.body,u=a?WR(s):qR(l),c=0,f=0;if(e.top<u.top+xr(r,"top")?f=-(u.top-e.top+xr(i,"top")):e.bottom>u.bottom-xr(r,"bottom")&&(f=e.bottom-e.top>u.bottom-u.top?e.top+xr(i,"top")-u.top:e.bottom-u.bottom+xr(i,"bottom")),e.left<u.left+xr(r,"left")?c=-(u.left-e.left+xr(i,"left")):e.right>u.right-xr(r,"right")&&(c=e.right-u.right+xr(i,"right")),c||f)if(a)s.defaultView.scrollBy(c,f);else{let h=l.scrollLeft,p=l.scrollTop;f&&(l.scrollTop+=f),c&&(l.scrollLeft+=c);let m=l.scrollLeft-h,v=l.scrollTop-p;e={left:e.left-m,top:e.top-v,right:e.right-m,bottom:e.bottom-v}}if(a||/^(fixed|sticky)$/.test(getComputedStyle(o).position))break}}function KR(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,i;for(let s=(e.left+e.right)/2,o=n+1;o<Math.min(innerHeight,e.bottom);o+=5){let l=t.root.elementFromPoint(s,o);if(!l||l==t.dom||!t.dom.contains(l))continue;let a=l.getBoundingClientRect();if(a.top>=n-20){r=l,i=a.top;break}}return{refDOM:r,refTop:i,stack:Yk(t.dom)}}function Yk(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=ca(r));return e}function GR({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;Qk(n,r==0?0:r-e)}function Qk(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:i,left:s}=t[n];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=s&&(r.scrollLeft=s)}}let Ps=null;function JR(t){if(t.setActive)return t.setActive();if(Ps)return t.focus(Ps);let e=Yk(t);t.focus(Ps==null?{get preventScroll(){return Ps={preventScroll:!0},!0}}:void 0),Ps||(Ps=!1,Qk(e,0))}function Zk(t,e){let n,r=2e8,i,s=0,o=e.top,l=e.top,a,u;for(let c=t.firstChild,f=0;c;c=c.nextSibling,f++){let h;if(c.nodeType==1)h=c.getClientRects();else if(c.nodeType==3)h=Rr(c).getClientRects();else continue;for(let p=0;p<h.length;p++){let m=h[p];if(m.top<=o&&m.bottom>=l){o=Math.max(m.bottom,o),l=Math.min(m.top,l);let v=m.left>e.left?m.left-e.left:m.right<e.left?e.left-m.right:0;if(v<r){n=c,r=v,i=v&&n.nodeType==3?{left:m.right<e.left?m.right:m.left,top:e.top}:e,c.nodeType==1&&v&&(s=f+(e.left>=(m.left+m.right)/2?1:0));continue}}else m.top>e.top&&!a&&m.left<=e.left&&m.right>=e.left&&(a=c,u={left:Math.max(m.left,Math.min(m.right,e.left)),top:m.top});!n&&(e.left>=m.right&&e.top>=m.top||e.left>=m.left&&e.top>=m.bottom)&&(s=f+1)}}return!n&&a&&(n=a,i=u,r=0),n&&n.nodeType==3?YR(n,i):!n||r&&n.nodeType==1?{node:t,offset:s}:Zk(n,i)}function YR(t,e){let n=t.nodeValue.length,r=document.createRange();for(let i=0;i<n;i++){r.setEnd(t,i+1),r.setStart(t,i);let s=Xr(r,1);if(s.top!=s.bottom&&em(e,s))return{node:t,offset:i+(e.left>=(s.left+s.right)/2?1:0)}}return{node:t,offset:0}}function em(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function QR(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function ZR(t,e,n){let{node:r,offset:i}=Zk(e,n),s=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();s=o.left!=o.right&&n.left>(o.left+o.right)/2?1:-1}return t.docView.posFromDOM(r,i,s)}function XR(t,e,n,r){let i=-1;for(let s=e,o=!1;s!=t.dom;){let l=t.docView.nearestDesc(s,!0);if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent&&!o||!l.contentDOM)){let a=l.dom.getBoundingClientRect();if(l.node.isBlock&&l.parent&&!o&&(o=!0,a.left>r.left||a.top>r.top?i=l.posBefore:(a.right<r.left||a.bottom<r.top)&&(i=l.posAfter)),!l.contentDOM&&i<0&&!l.node.isText)return(l.node.isBlock?r.top<(a.top+a.bottom)/2:r.left<(a.left+a.right)/2)?l.posBefore:l.posAfter}s=l.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,n,-1)}function Xk(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),s=i;;){let o=t.childNodes[s];if(o.nodeType==1){let l=o.getClientRects();for(let a=0;a<l.length;a++){let u=l[a];if(em(e,u))return Xk(o,e,u)}}if((s=(s+1)%r)==i)break}return t}function e2(t,e){let n=t.dom.ownerDocument,r,i=0,s=VR(n,e.left,e.top);s&&({node:r,offset:i}=s);let o=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),l;if(!o||!t.dom.contains(o.nodeType!=1?o.parentNode:o)){let u=t.dom.getBoundingClientRect();if(!em(e,u)||(o=Xk(t.dom,e,u),!o))return null}if(jt)for(let u=o;r&&u;u=ca(u))u.draggable&&(r=void 0);if(o=QR(o,e),r){if(tr&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let c=r.childNodes[i],f;c.nodeName=="IMG"&&(f=c.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&i++}let u;Aa&&i&&r.nodeType==1&&(u=r.childNodes[i-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=e.top&&i--,r==t.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?l=t.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(l=XR(t,r,i,e))}l==null&&(l=ZR(t,o,e));let a=t.docView.nearestDesc(o,!0);return{pos:l,inside:a?a.posAtStart-a.border:-1}}function Oy(t){return t.top<t.bottom||t.left<t.right}function Xr(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(Oy(r))return r}return Array.prototype.find.call(n,Oy)||t.getBoundingClientRect()}const t2=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function e_(t,e,n){let{node:r,offset:i,atom:s}=t.docView.domFromPos(e,n<0?-1:1),o=Aa||tr;if(r.nodeType==3)if(o&&(t2.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let a=Xr(Rr(r,i,i),n);if(tr&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let u=Xr(Rr(r,i-1,i-1),-1);if(u.top==a.top){let c=Xr(Rr(r,i,i+1),-1);if(c.top!=a.top)return nl(c,c.left<u.left)}}return a}else{let a=i,u=i,c=n<0?1:-1;return n<0&&!i?(u++,c=-1):n>=0&&i==r.nodeValue.length?(a--,c=1):n<0?a--:u++,nl(Xr(Rr(r,a,u),c),c<0)}if(!t.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&i&&(n<0||i==cr(r))){let a=r.childNodes[i-1];if(a.nodeType==1)return Sh(a.getBoundingClientRect(),!1)}if(s==null&&i<cr(r)){let a=r.childNodes[i];if(a.nodeType==1)return Sh(a.getBoundingClientRect(),!0)}return Sh(r.getBoundingClientRect(),n>=0)}if(s==null&&i&&(n<0||i==cr(r))){let a=r.childNodes[i-1],u=a.nodeType==3?Rr(a,cr(a)-(o?0:1)):a.nodeType==1&&(a.nodeName!="BR"||!a.nextSibling)?a:null;if(u)return nl(Xr(u,1),!1)}if(s==null&&i<cr(r)){let a=r.childNodes[i];for(;a.pmViewDesc&&a.pmViewDesc.ignoreForCoords;)a=a.nextSibling;let u=a?a.nodeType==3?Rr(a,0,o?0:1):a.nodeType==1?a:null:null;if(u)return nl(Xr(u,-1),!0)}return nl(Xr(r.nodeType==3?Rr(r):r,-n),n>=0)}function nl(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Sh(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function t_(t,e,n){let r=t.state,i=t.root.activeElement;r!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),i!=t.dom&&i&&i.focus()}}function n2(t,e,n){let r=e.selection,i=n=="up"?r.$from:r.$to;return t_(t,e,()=>{let{node:s}=t.docView.domFromPos(i.pos,n=="up"?-1:1);for(;;){let l=t.docView.nearestDesc(s,!0);if(!l)break;if(l.node.isBlock){s=l.contentDOM||l.dom;break}s=l.dom.parentNode}let o=e_(t,i.pos,1);for(let l=s.firstChild;l;l=l.nextSibling){let a;if(l.nodeType==1)a=l.getClientRects();else if(l.nodeType==3)a=Rr(l,0,l.nodeValue.length).getClientRects();else continue;for(let u=0;u<a.length;u++){let c=a[u];if(c.bottom>c.top+1&&(n=="up"?o.top-c.top>(c.bottom-o.top)*2:c.bottom-o.bottom>(o.bottom-c.top)*2))return!1}}return!0})}const r2=/[\u0590-\u08ac]/;function i2(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,s=!i,o=i==r.parent.content.size,l=t.domSelection();return!r2.test(r.parent.textContent)||!l.modify?n=="left"||n=="backward"?s:o:t_(t,e,()=>{let{focusNode:a,focusOffset:u,anchorNode:c,anchorOffset:f}=t.domSelectionRange(),h=l.caretBidiLevel;l.modify("move",n,"character");let p=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:m,focusOffset:v}=t.domSelectionRange(),C=m&&!p.contains(m.nodeType==1?m:m.parentNode)||a==m&&u==v;try{l.collapse(c,f),a&&(a!=c||u!=f)&&l.extend&&l.extend(a,u)}catch{}return h!=null&&(l.caretBidiLevel=h),C})}let Ry=null,Ay=null,Ny=!1;function s2(t,e,n){return Ry==e&&Ay==n?Ny:(Ry=e,Ay=n,Ny=n=="up"||n=="down"?n2(t,e,n):i2(t,e,n))}const Mn=0,My=1,es=2,Sr=3;class Na{constructor(e,n,r,i){this.parent=e,this.children=n,this.dom=r,this.contentDOM=i,this.dirty=Mn,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let i=this.children[n];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let s,o;if(e==this.contentDOM)s=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(o)+o.size:this.posAtStart}else{let s,o;if(e==this.contentDOM)s=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(o):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=n>Lt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(i==null&&n==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,i=e;i;i=i.parentNode){let s=this.getDesc(i),o;if(s&&(!n||s.node))if(r&&(o=s.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return s}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let i=e;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let i=this.children[n],s=r+i.size;if(r==e&&s!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(e<s)return i.descAt(e-r-i.border);r=s}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let s=0;r<this.children.length;r++){let o=this.children[r],l=s+o.size;if(l>e||o instanceof r_){i=e-s;break}s=l}if(i)return this.children[r].domFromPos(i-this.children[r].border,n);for(let s;r&&!(s=this.children[r-1]).size&&s instanceof n_&&s.side>=0;r--);if(n<=0){let s,o=!0;for(;s=r?this.children[r-1]:null,!(!s||s.dom.parentNode==this.contentDOM);r--,o=!1);return s&&n&&o&&!s.border&&!s.domAtom?s.domFromPos(s.size,n):{node:this.contentDOM,offset:s?Lt(s.dom)+1:0}}else{let s,o=!0;for(;s=r<this.children.length?this.children[r]:null,!(!s||s.dom.parentNode==this.contentDOM);r++,o=!1);return s&&o&&!s.border&&!s.domAtom?s.domFromPos(0,n):{node:this.contentDOM,offset:s?Lt(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let o=r,l=0;;l++){let a=this.children[l],u=o+a.size;if(i==-1&&e<=u){let c=o+a.border;if(e>=c&&n<=u-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,n,c);e=o;for(let f=l;f>0;f--){let h=this.children[f-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){i=Lt(h.dom)+1;break}e-=h.size}i==-1&&(i=0)}if(i>-1&&(u>n||l==this.children.length-1)){n=u;for(let c=l+1;c<this.children.length;c++){let f=this.children[c];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){s=Lt(f.dom);break}n+=f.size}s==-1&&(s=this.contentDOM.childNodes.length);break}o=u}return{node:this.contentDOM,from:e,to:n,fromOffset:i,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,i=!1){let s=Math.min(e,n),o=Math.max(e,n);for(let h=0,p=0;h<this.children.length;h++){let m=this.children[h],v=p+m.size;if(s>p&&o<v)return m.setSelection(e-p-m.border,n-p-m.border,r,i);p=v}let l=this.domFromPos(e,e?-1:1),a=n==e?l:this.domFromPos(n,n?-1:1),u=r.getSelection(),c=!1;if((tr||jt)&&e==n){let{node:h,offset:p}=l;if(h.nodeType==3){if(c=!!(p&&h.nodeValue[p-1]==`
`),c&&p==h.nodeValue.length)for(let m=h,v;m;m=m.parentNode){if(v=m.nextSibling){v.nodeName=="BR"&&(l=a={node:v.parentNode,offset:Lt(v)+1});break}let C=m.pmViewDesc;if(C&&C.node&&C.node.isBlock)break}}else{let m=h.childNodes[p-1];c=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(tr&&u.focusNode&&u.focusNode!=a.node&&u.focusNode.nodeType==1){let h=u.focusNode.childNodes[u.focusOffset];h&&h.contentEditable=="false"&&(i=!0)}if(!(i||c&&jt)&&bs(l.node,l.offset,u.anchorNode,u.anchorOffset)&&bs(a.node,a.offset,u.focusNode,u.focusOffset))return;let f=!1;if((u.extend||e==n)&&!c){u.collapse(l.node,l.offset);try{e!=n&&u.extend(a.node,a.offset),f=!0}catch{}}if(!f){if(e>n){let p=l;l=a,a=p}let h=document.createRange();h.setEnd(a.node,a.offset),h.setStart(l.node,l.offset),u.removeAllRanges(),u.addRange(h)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,i=0;i<this.children.length;i++){let s=this.children[i],o=r+s.size;if(r==o?e<=o&&n>=r:e<o&&n>r){let l=r+s.border,a=o-s.border;if(e>=l&&n<=a){this.dirty=e==r||n==o?es:My,e==l&&n==a&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=Sr:s.markDirty(e-l,n-l);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?es:Sr}r=o}this.dirty=es}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?es:My;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class n_ extends Na{constructor(e,n,r,i){let s,o=n.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!s)return i;if(s.parent)return s.parent.posBeforeChild(s)})),!n.type.spec.raw){if(o.nodeType!=1){let l=document.createElement("span");l.appendChild(o),o=l}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=n,this.widget=n,s=this}matchesWidget(e){return this.dirty==Mn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class o2 extends Na{constructor(e,n,r,i){super(e,[],n,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class xs extends Na{constructor(e,n,r,i){super(e,[],r,i),this.mark=n}static create(e,n,r,i){let s=i.nodeViews[n.type.name],o=s&&s(n,i,r);return(!o||!o.dom)&&(o=Br.renderSpec(document,n.type.spec.toDOM(n,r))),new xs(e,n,o.dom,o.contentDOM||o.dom)}parseRule(){return this.dirty&Sr||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Sr&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=Mn){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Mn}}slice(e,n,r){let i=xs.create(this.parent,this.mark,!0,r),s=this.children,o=this.size;n<o&&(s=up(s,n,o,r)),e>0&&(s=up(s,0,e,r));for(let l=0;l<s.length;l++)s[l].parent=i;return i.children=s,i}}class bi extends Na{constructor(e,n,r,i,s,o,l,a,u){super(e,[],s,o),this.node=n,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=l}static create(e,n,r,i,s,o){let l=s.nodeViews[n.type.name],a,u=l&&l(n,s,()=>{if(!a)return o;if(a.parent)return a.parent.posBeforeChild(a)},r,i),c=u&&u.dom,f=u&&u.contentDOM;if(n.isText){if(!c)c=document.createTextNode(n.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:f}=Br.renderSpec(document,n.type.spec.toDOM(n)));!f&&!n.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),n.type.spec.draggable&&(c.draggable=!0));let h=c;return c=o_(c,r,n),u?a=new l2(e,n,r,i,c,f||null,h,u,s,o+1):n.isText?new df(e,n,r,i,c,h,s):new bi(e,n,r,i,c,f||null,h,s,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>H.empty)}return e}matchesNode(e,n,r){return this.dirty==Mn&&e.eq(this.node)&&ap(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,i=n,s=e.composing?this.localCompositionInfo(e,n):null,o=s&&s.pos>-1?s:null,l=s&&s.pos<0,a=new u2(this,o&&o.node,e);h2(this.node,this.innerDeco,(u,c,f)=>{u.spec.marks?a.syncToMarks(u.spec.marks,r,e):u.type.side>=0&&!f&&a.syncToMarks(c==this.node.childCount?ve.none:this.node.child(c).marks,r,e),a.placeWidget(u,e,i)},(u,c,f,h)=>{a.syncToMarks(u.marks,r,e);let p;a.findNodeMatch(u,c,f,h)||l&&e.state.selection.from>i&&e.state.selection.to<i+u.nodeSize&&(p=a.findIndexWithChild(s.node))>-1&&a.updateNodeAt(u,c,f,p,e)||a.updateNextNode(u,c,f,e,h,i)||a.addNode(u,c,f,e,i),i+=u.nodeSize}),a.syncToMarks([],r,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||this.dirty==es)&&(o&&this.protectLocalComposition(e,o),i_(this.contentDOM,this.children,e),Mo&&d2(this.dom))}localCompositionInfo(e,n){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof _e)||r<n||i>n+this.node.content.size)return null;let s=e.domSelectionRange(),o=p2(s.focusNode,s.focusOffset);if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let l=o.nodeValue,a=g2(this.node.content,l,r-n,i-n);return a<0?null:{node:o,pos:a,text:l}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:i}){if(this.getDesc(n))return;let s=n;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new o2(this,s,n,i);e.input.compositionNodes.push(o),this.children=up(this.children,r,r+i.length,e,o)}update(e,n,r,i){return this.dirty==Sr||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,i),!0)}updateInner(e,n,r,i){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Mn}updateOuterDeco(e){if(ap(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=s_(this.dom,this.nodeDOM,lp(this.outerDeco,this.node,n),lp(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function Dy(t,e,n,r,i){o_(r,e,t);let s=new bi(void 0,t,e,n,r,r,r,i,0);return s.contentDOM&&s.updateChildren(i,0),s}class df extends bi{constructor(e,n,r,i,s,o,l){super(e,n,r,i,s,null,o,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,i){return this.dirty==Sr||this.dirty!=Mn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=Mn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=Mn,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let i=this.node.cut(e,n),s=document.createTextNode(i.text);return new df(this.parent,i,this.outerDeco,this.innerDeco,s,s,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Sr)}get domAtom(){return!1}}class r_ extends Na{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Mn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class l2 extends bi{constructor(e,n,r,i,s,o,l,a,u,c){super(e,n,r,i,s,o,l,u,c),this.spec=a}update(e,n,r,i){if(this.dirty==Sr)return!1;if(this.spec.update){let s=this.spec.update(e,n,r);return s&&this.updateInner(e,n,r,i),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,i){this.spec.setSelection?this.spec.setSelection(e,n,r):super.setSelection(e,n,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function i_(t,e,n){let r=t.firstChild,i=!1;for(let s=0;s<e.length;s++){let o=e[s],l=o.dom;if(l.parentNode==t){for(;l!=r;)r=By(r),i=!0;r=r.nextSibling}else i=!0,t.insertBefore(l,r);if(o instanceof xs){let a=r?r.previousSibling:t.lastChild;i_(o.contentDOM,o.children,n),r=a?a.nextSibling:t.firstChild}}for(;r;)r=By(r),i=!0;i&&n.trackWrites==t&&(n.trackWrites=null)}const xl=function(t){t&&(this.nodeName=t)};xl.prototype=Object.create(null);const ts=[new xl];function lp(t,e,n){if(t.length==0)return ts;let r=n?ts[0]:new xl,i=[r];for(let s=0;s<t.length;s++){let o=t[s].type.attrs;if(o){o.nodeName&&i.push(r=new xl(o.nodeName));for(let l in o){let a=o[l];a!=null&&(n&&i.length==1&&i.push(r=new xl(e.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+a:l=="style"?r.style=(r.style?r.style+";":"")+a:l!="nodeName"&&(r[l]=a))}}}return i}function s_(t,e,n,r){if(n==ts&&r==ts)return e;let i=e;for(let s=0;s<r.length;s++){let o=r[s],l=n[s];if(s){let a;l&&l.nodeName==o.nodeName&&i!=t&&(a=i.parentNode)&&a.nodeName.toLowerCase()==o.nodeName||(a=document.createElement(o.nodeName),a.pmIsDeco=!0,a.appendChild(i),l=ts[0]),i=a}a2(i,l||ts[0],o)}return i}function a2(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let s=0;s<r.length;s++)i.indexOf(r[s])==-1&&t.classList.remove(r[s]);for(let s=0;s<i.length;s++)r.indexOf(i[s])==-1&&t.classList.add(i[s]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)t.style.removeProperty(i[1])}n.style&&(t.style.cssText+=n.style)}}function o_(t,e,n){return s_(t,t,ts,lp(e,n,t.nodeType!=1))}function ap(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function By(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class u2{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=c2(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let i=0,s=this.stack.length>>1,o=Math.min(s,e.length);for(;i<o&&(i==s-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<s;)this.destroyRest(),this.top.dirty=Mn,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let a=this.index;a<Math.min(this.index+3,this.top.children.length);a++){let u=this.top.children[a];if(u.matchesMark(e[s])&&!this.isLocked(u.dom)){l=a;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let a=xs.create(this.top,e[s],n,r);this.top.children.splice(this.index,0,a),this.top=a,this.changed=!0}this.index=0,s++}}findNodeMatch(e,n,r,i){let s=-1,o;if(i>=this.preMatch.index&&(o=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&o.matchesNode(e,n,r))s=this.top.children.indexOf(o,this.index);else for(let l=this.index,a=Math.min(this.top.children.length,l+5);l<a;l++){let u=this.top.children[l];if(u.matchesNode(e,n,r)&&!this.preMatch.matched.has(u)){s=l;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,n,r,i,s){let o=this.top.children[i];return o.dirty==Sr&&o.dom==o.contentDOM&&(o.dirty=es),o.update(e,n,r,s)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=n}}updateNextNode(e,n,r,i,s,o){for(let l=this.index;l<this.top.children.length;l++){let a=this.top.children[l];if(a instanceof bi){let u=this.preMatch.matched.get(a);if(u!=null&&u!=s)return!1;let c=a.dom,f,h=this.isLocked(c)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&a.dirty!=Sr&&ap(n,a.outerDeco));if(!h&&a.update(e,n,r,i))return this.destroyBetween(this.index,l),a.dom!=c&&(this.changed=!0),this.index++,!0;if(!h&&(f=this.recreateWrapper(a,e,n,r,i,o)))return this.top.children[this.index]=f,f.contentDOM&&(f.dirty=es,f.updateChildren(i,o+1),f.dirty=Mn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,i,s,o){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content))return null;let l=bi.create(this.top,n,r,i,s,o);if(l.contentDOM){l.children=e.children,e.children=[];for(let a of l.children)a.parent=l}return e.destroy(),l}addNode(e,n,r,i,s){let o=bi.create(this.top,e,n,r,i,s);o.contentDOM&&o.updateChildren(i,s+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,n,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let s=new n_(this.top,e,n,r);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof xs;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof df)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((jt||It)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new r_(this.top,[],r,null);n!=this.top?n.children.push(i):n.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function c2(t,e){let n=e,r=n.children.length,i=t.childCount,s=new Map,o=[];e:for(;i>0;){let l;for(;;)if(r){let u=n.children[r-1];if(u instanceof xs)n=u,r=u.children.length;else{l=u,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let a=l.node;if(a){if(a!=t.child(i-1))break;--i,s.set(l,i),o.push(l)}}return{index:i,matched:s,matches:o.reverse()}}function f2(t,e){return t.type.side-e.type.side}function h2(t,e,n,r){let i=e.locals(t),s=0;if(i.length==0){for(let u=0;u<t.childCount;u++){let c=t.child(u);r(c,i,e.forChild(s,c),u),s+=c.nodeSize}return}let o=0,l=[],a=null;for(let u=0;;){let c,f;for(;o<i.length&&i[o].to==s;){let C=i[o++];C.widget&&(c?(f||(f=[c])).push(C):c=C)}if(c)if(f){f.sort(f2);for(let C=0;C<f.length;C++)n(f[C],u,!!a)}else n(c,u,!!a);let h,p;if(a)p=-1,h=a,a=null;else if(u<t.childCount)p=u,h=t.child(u++);else break;for(let C=0;C<l.length;C++)l[C].to<=s&&l.splice(C--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)l.push(i[o++]);let m=s+h.nodeSize;if(h.isText){let C=m;o<i.length&&i[o].from<C&&(C=i[o].from);for(let y=0;y<l.length;y++)l[y].to<C&&(C=l[y].to);C<m&&(a=h.cut(C-s),h=h.cut(0,C-s),m=C,p=-1)}else for(;o<i.length&&i[o].to<m;)o++;let v=h.isInline&&!h.isLeaf?l.filter(C=>!C.inline):l.slice();r(h,v,e.forChild(s,h),p),s=m}}function d2(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function p2(t,e){for(;;){if(t.nodeType==3)return t;if(t.nodeType==1&&e>0){if(t.childNodes.length>e&&t.childNodes[e].nodeType==3)return t.childNodes[e];t=t.childNodes[e-1],e=cr(t)}else if(t.nodeType==1&&e<t.childNodes.length)t=t.childNodes[e],e=0;else return null}}function g2(t,e,n,r){for(let i=0,s=0;i<t.childCount&&s<=r;){let o=t.child(i++),l=s;if(s+=o.nodeSize,!o.isText)continue;let a=o.text;for(;i<t.childCount;){let u=t.child(i++);if(s+=u.nodeSize,!u.isText)break;a+=u.text}if(s>=n){if(s>=r&&a.slice(r-e.length-l,r-l)==e)return r-e.length;let u=l<r?a.lastIndexOf(e,r-l-1):-1;if(u>=0&&u+e.length+l>=n)return l+u;if(n==r&&a.length>=r+e.length-l&&a.slice(r-l,r-l+e.length)==e)return r}}return-1}function up(t,e,n,r,i){let s=[];for(let o=0,l=0;o<t.length;o++){let a=t[o],u=l,c=l+=a.size;u>=n||c<=e?s.push(a):(u<e&&s.push(a.slice(0,e-u,r)),i&&(s.push(i),i=void 0),c>n&&s.push(a.slice(n-u,a.size,r)))}return s}function tm(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),s=i&&i.size==0,o=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let l=r.resolve(o),a,u;if(hf(n)){for(a=l;i&&!i.node;)i=i.parent;let c=i.node;if(i&&c.isAtom&&ne.isSelectable(c)&&i.parent&&!(c.isInline&&UR(n.focusNode,n.focusOffset,i.dom))){let f=i.posBefore;u=new ne(o==f?l:r.resolve(f))}}else{let c=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(c<0)return null;a=r.resolve(c)}if(!u){let c=e=="pointer"||t.state.selection.head<l.pos&&!s?1:-1;u=nm(t,a,l,c)}return u}function l_(t){return t.editable?t.hasFocus():u_(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Fr(t,e=!1){let n=t.state.selection;if(a_(t,n),!!l_(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&It){let r=t.domSelectionRange(),i=t.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&bs(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)y2(t);else{let{anchor:r,head:i}=n,s,o;Py&&!(n instanceof _e)&&(n.$from.parent.inlineContent||(s=Ly(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(o=Ly(t,n.to))),t.docView.setSelection(r,i,t.root,e),Py&&(s&&Fy(s),o&&Fy(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&m2(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const Py=jt||It&&jR<63;function Ly(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),i=r<n.childNodes.length?n.childNodes[r]:null,s=r?n.childNodes[r-1]:null;if(jt&&i&&i.contentEditable=="false")return vh(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return vh(i);if(s)return vh(s)}}function vh(t){return t.contentEditable="true",jt&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Fy(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function m2(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!l_(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function y2(t){let e=t.domSelection(),n=document.createRange(),r=t.cursorWrapper.dom,i=r.nodeName=="IMG";i?n.setEnd(r.parentNode,Lt(r)+1):n.setEnd(r,0),n.collapse(!1),e.removeAllRanges(),e.addRange(n),!i&&!t.state.selection.visible&&sn&&Ci<=11&&(r.disabled=!0,r.disabled=!1)}function a_(t,e){if(e instanceof ne){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Uy(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Uy(t)}function Uy(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function nm(t,e,n,r){return t.someProp("createSelectionBetween",i=>i(t,e,n))||_e.between(e,n,r)}function zy(t){return t.editable&&!t.hasFocus()?!1:u_(t)}function u_(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function w2(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return bs(e.node,e.offset,n.anchorNode,n.anchorOffset)}function cp(t,e){let{$anchor:n,$head:r}=t.selection,i=e>0?n.max(r):n.min(r),s=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return s&&me.findFrom(s,e)}function ni(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function Vy(t,e,n){let r=t.state.selection;if(r instanceof _e)if(n.indexOf("s")>-1){let{$head:i}=r,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let o=t.state.doc.resolve(i.pos+s.nodeSize*(e<0?-1:1));return ni(t,new _e(r.$anchor,o))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=cp(t.state,e);return i&&i instanceof ne?ni(t,i):!1}else if(!(En&&n.indexOf("m")>-1)){let i=r.$head,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,o;if(!s||s.isText)return!1;let l=e<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(o=t.docView.descAt(l))&&!o.contentDOM?ne.isSelectable(s)?ni(t,new ne(e<0?t.state.doc.resolve(i.pos-s.nodeSize):i)):Aa?ni(t,new _e(t.state.doc.resolve(e<0?l:l+s.nodeSize))):!1:!1}}else return!1;else{if(r instanceof ne&&r.node.isInline)return ni(t,new _e(e>0?r.$to:r.$from));{let i=cp(t.state,e);return i?ni(t,i):!1}}}function Cc(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Tl(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Ls(t,e){return e<0?S2(t):v2(t)}function S2(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i,s,o=!1;for(tr&&n.nodeType==1&&r<Cc(n)&&Tl(n.childNodes[r],-1)&&(o=!0);;)if(r>0){if(n.nodeType!=1)break;{let l=n.childNodes[r-1];if(Tl(l,-1))i=n,s=--r;else if(l.nodeType==3)n=l,r=n.nodeValue.length;else break}}else{if(c_(n))break;{let l=n.previousSibling;for(;l&&Tl(l,-1);)i=n.parentNode,s=Lt(l),l=l.previousSibling;if(l)n=l,r=Cc(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}o?fp(t,n,r):i&&fp(t,i,s)}function v2(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i=Cc(n),s,o;for(;;)if(r<i){if(n.nodeType!=1)break;let l=n.childNodes[r];if(Tl(l,1))s=n,o=++r;else break}else{if(c_(n))break;{let l=n.nextSibling;for(;l&&Tl(l,1);)s=l.parentNode,o=Lt(l)+1,l=l.nextSibling;if(l)n=l,r=0,i=Cc(n);else{if(n=n.parentNode,n==t.dom)break;r=i=0}}}s&&fp(t,s,o)}function c_(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function k2(t,e){for(;t&&e==t.childNodes.length&&!Xg(t);)e=Lt(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function _2(t,e){for(;t&&!e&&!Xg(t);)e=Lt(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function fp(t,e,n){if(e.nodeType!=3){let s,o;(o=k2(e,n))?(e=o,n=0):(s=_2(e,n))&&(e=s,n=s.nodeValue.length)}let r=t.domSelection();if(hf(r)){let s=document.createRange();s.setEnd(e,n),s.setStart(e,n),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&Fr(t)},50)}function jy(t,e){let n=t.state.doc.resolve(e);if(!(It||HR)&&n.parent.inlineContent){let i=t.coordsAtPos(e);if(e>n.start()){let s=t.coordsAtPos(e-1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left<i.left?"ltr":"rtl"}if(e<n.end()){let s=t.coordsAtPos(e+1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function Hy(t,e,n){let r=t.state.selection;if(r instanceof _e&&!r.empty||n.indexOf("s")>-1||En&&n.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let o=cp(t.state,e);if(o&&o instanceof ne)return ni(t,o)}if(!i.parent.inlineContent){let o=e<0?i:s,l=r instanceof pn?me.near(o,e):me.findFrom(o,e);return l?ni(t,l):!1}return!1}function $y(t,e){if(!(t.state.selection instanceof _e))return!0;let{$head:n,$anchor:r,empty:i}=t.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let o=t.state.tr;return e<0?o.delete(n.pos-s.nodeSize,n.pos):o.delete(n.pos,n.pos+s.nodeSize),t.dispatch(o),!0}return!1}function Wy(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function E2(t){if(!jt||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;Wy(t,r,"true"),setTimeout(()=>Wy(t,r,"false"),20)}return!1}function C2(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function b2(t,e){let n=e.keyCode,r=C2(e);if(n==8||En&&n==72&&r=="c")return $y(t,-1)||Ls(t,-1);if(n==46&&!e.shiftKey||En&&n==68&&r=="c")return $y(t,1)||Ls(t,1);if(n==13||n==27)return!0;if(n==37||En&&n==66&&r=="c"){let i=n==37?jy(t,t.state.selection.from)=="ltr"?-1:1:-1;return Vy(t,i,r)||Ls(t,i)}else if(n==39||En&&n==70&&r=="c"){let i=n==39?jy(t,t.state.selection.from)=="ltr"?1:-1:1;return Vy(t,i,r)||Ls(t,i)}else{if(n==38||En&&n==80&&r=="c")return Hy(t,-1,r)||Ls(t,-1);if(n==40||En&&n==78&&r=="c")return E2(t)||Hy(t,1,r)||Ls(t,1);if(r==(En?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function f_(t,e){t.someProp("transformCopied",p=>{e=p(e,t)});let n=[],{content:r,openStart:i,openEnd:s}=e;for(;i>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,s--;let p=r.firstChild;n.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let o=t.someProp("clipboardSerializer")||Br.fromSchema(t.state.schema),l=y_(),a=l.createElement("div");a.appendChild(o.serializeFragment(r,{document:l}));let u=a.firstChild,c,f=0;for(;u&&u.nodeType==1&&(c=m_[u.nodeName.toLowerCase()]);){for(let p=c.length-1;p>=0;p--){let m=l.createElement(c[p]);for(;a.firstChild;)m.appendChild(a.firstChild);a.appendChild(m),f++}u=a.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${s}${f?` -${f}`:""} ${JSON.stringify(n)}`);let h=t.someProp("clipboardTextSerializer",p=>p(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:a,text:h}}function h_(t,e,n,r,i){let s=i.parent.type.spec.code,o,l;if(!n&&!e)return null;let a=e&&(r||s||!n);if(a){if(t.someProp("transformPastedText",h=>{e=h(e,s||r,t)}),s)return e?new J(H.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):J.empty;let f=t.someProp("clipboardTextParser",h=>h(e,i,r,t));if(f)l=f;else{let h=i.marks(),{schema:p}=t.state,m=Br.fromSchema(p);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(v=>{let C=o.appendChild(document.createElement("p"));v&&C.appendChild(m.serializeNode(p.text(v,h)))})}}else t.someProp("transformPastedHTML",f=>{n=f(n,t)}),o=I2(n),Aa&&O2(o);let u=o&&o.querySelector("[data-pm-slice]"),c=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let f=+c[3];f>0;f--){let h=o.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;o=h}if(l||(l=(t.someProp("clipboardParser")||t.someProp("domParser")||Nk.fromSchema(t.state.schema)).parseSlice(o,{preserveWhitespace:!!(a||c),context:i,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!x2.test(h.parentNode.nodeName)?{ignore:!0}:null}})),c)l=R2(qy(l,+c[1],+c[2]),c[4]);else if(l=J.maxOpen(T2(l.content,i),!0),l.openStart||l.openEnd){let f=0,h=0;for(let p=l.content.firstChild;f<l.openStart&&!p.type.spec.isolating;f++,p=p.firstChild);for(let p=l.content.lastChild;h<l.openEnd&&!p.type.spec.isolating;h++,p=p.lastChild);l=qy(l,f,h)}return t.someProp("transformPasted",f=>{l=f(l,t)}),l}const x2=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function T2(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.index(n)),s,o=[];if(t.forEach(l=>{if(!o)return;let a=i.findWrapping(l.type),u;if(!a)return o=null;if(u=o.length&&s.length&&p_(a,s,l,o[o.length-1],0))o[o.length-1]=u;else{o.length&&(o[o.length-1]=g_(o[o.length-1],s.length));let c=d_(l,a);o.push(c),i=i.matchType(c.type),s=a}}),o)return H.from(o)}return t}function d_(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,H.from(t));return t}function p_(t,e,n,r,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let s=p_(t,e,n,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==t.length-1?n.type:t[i+1]))return r.copy(r.content.append(H.from(d_(n,t,i+1))))}}function g_(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,g_(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(H.empty,!0);return t.copy(n.append(r))}function hp(t,e,n,r,i,s){let o=e<0?t.firstChild:t.lastChild,l=o.content;return t.childCount>1&&(s=0),i<r-1&&(l=hp(l,e,n,r,i+1,s)),i>=n&&(l=e<0?o.contentMatchAt(0).fillBefore(l,s<=i).append(l):l.append(o.contentMatchAt(o.childCount).fillBefore(H.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,o.copy(l))}function qy(t,e,n){return e<t.openStart&&(t=new J(hp(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new J(hp(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const m_={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Ky=null;function y_(){return Ky||(Ky=document.implementation.createHTMLDocument("title"))}function I2(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=y_().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),i;if((i=r&&m_[r[1].toLowerCase()])&&(t=i.map(s=>"<"+s+">").join("")+t+i.map(s=>"</"+s+">").reverse().join("")),n.innerHTML=t,i)for(let s=0;s<i.length;s++)n=n.querySelector(i[s])||n;return n}function O2(t){let e=t.querySelectorAll(It?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function R2(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:i,openStart:s,openEnd:o}=t;for(let l=r.length-2;l>=0;l-=2){let a=n.nodes[r[l]];if(!a||a.hasRequiredAttrs())break;i=H.from(a.create(r[l+1],i)),s++,o++}return new J(i,s,o)}const Ht={},$t={},A2={touchstart:!0,touchmove:!0};class N2{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function M2(t){for(let e in Ht){let n=Ht[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{B2(t,r)&&!rm(t,r)&&(t.editable||!(r.type in $t))&&n(t,r)},A2[e]?{passive:!0}:void 0)}jt&&t.dom.addEventListener("input",()=>null),dp(t)}function pi(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function D2(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function dp(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>rm(t,r))})}function rm(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function B2(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function P2(t,e){!rm(t,e)&&Ht[e.type]&&(t.editable||!(e.type in $t))&&Ht[e.type](t,e)}$t.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!S_(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(qn&&It&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),Mo&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",i=>i(t,Yi(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||b2(t,n)?n.preventDefault():pi(t,"key")};$t.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};$t.keypress=(t,e)=>{let n=e;if(S_(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||En&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof _e)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(n.charCode);!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",s=>s(t,r.$from.pos,r.$to.pos,i))&&t.dispatch(t.state.tr.insertText(i).scrollIntoView()),n.preventDefault()}};function pf(t){return{left:t.clientX,top:t.clientY}}function L2(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function im(t,e,n,r,i){if(r==-1)return!1;let s=t.state.doc.resolve(r);for(let o=s.depth+1;o>0;o--)if(t.someProp(e,l=>o>s.depth?l(t,n,s.nodeAfter,s.before(o),i,!0):l(t,n,s.node(o),s.before(o),i,!1)))return!0;return!1}function wo(t,e,n){t.focused||t.focus();let r=t.state.tr.setSelection(e);n=="pointer"&&r.setMeta("pointer",!0),t.dispatch(r)}function F2(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&ne.isSelectable(r)?(wo(t,new ne(n),"pointer"),!0):!1}function U2(t,e){if(e==-1)return!1;let n=t.state.selection,r,i;n instanceof ne&&(r=n.node);let s=t.state.doc.resolve(e);for(let o=s.depth+1;o>0;o--){let l=o>s.depth?s.nodeAfter:s.node(o);if(ne.isSelectable(l)){r&&n.$from.depth>0&&o>=n.$from.depth&&s.before(n.$from.depth+1)==n.$from.pos?i=s.before(n.$from.depth):i=s.before(o);break}}return i!=null?(wo(t,ne.create(t.state.doc,i),"pointer"),!0):!1}function z2(t,e,n,r,i){return im(t,"handleClickOn",e,n,r)||t.someProp("handleClick",s=>s(t,e,r))||(i?U2(t,n):F2(t,n))}function V2(t,e,n,r){return im(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",i=>i(t,e,r))}function j2(t,e,n,r){return im(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",i=>i(t,e,r))||H2(t,n,r)}function H2(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(wo(t,_e.create(r,0,r.content.size),"pointer"),!0):!1;let i=r.resolve(e);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s),l=i.before(s);if(o.inlineContent)wo(t,_e.create(r,l+1,l+1+o.content.size),"pointer");else if(ne.isSelectable(o))wo(t,ne.create(r,l),"pointer");else continue;return!0}}function sm(t){return bc(t)}const w_=En?"metaKey":"ctrlKey";Ht.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=sm(t),i=Date.now(),s="singleClick";i-t.input.lastClick.time<500&&L2(n,t.input.lastClick)&&!n[w_]&&(t.input.lastClick.type=="singleClick"?s="doubleClick":t.input.lastClick.type=="doubleClick"&&(s="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:s};let o=t.posAtCoords(pf(n));o&&(s=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new $2(t,o,n,!!r)):(s=="doubleClick"?V2:j2)(t,o.pos,o.inside,n)?n.preventDefault():pi(t,"pointer"))};class $2{constructor(e,n,r,i){this.view=e,this.pos=n,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[w_],this.allowDefault=r.shiftKey;let s,o;if(n.inside>-1)s=e.state.doc.nodeAt(n.inside),o=n.inside;else{let c=e.state.doc.resolve(n.pos);s=c.parent,o=c.depth?c.before():0}const l=i?null:r.target,a=l?e.docView.nearestDesc(l,!0):null;this.target=a?a.dom:null;let{selection:u}=e.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||u instanceof ne&&u.from<=o&&u.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&tr&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),pi(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Fr(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(pf(e))),this.updateAllowDefault(e),this.allowDefault||!n?pi(this.view,"pointer"):z2(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||jt&&this.mightDrag&&!this.mightDrag.node.isAtom||It&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(wo(this.view,me.near(this.view.state.doc.resolve(n.pos)),"pointer"),e.preventDefault()):pi(this.view,"pointer")}move(e){this.updateAllowDefault(e),pi(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Ht.touchstart=t=>{t.input.lastTouch=Date.now(),sm(t),pi(t,"pointer")};Ht.touchmove=t=>{t.input.lastTouch=Date.now(),pi(t,"pointer")};Ht.contextmenu=t=>sm(t);function S_(t,e){return t.composing?!0:jt&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const W2=qn?5e3:-1;$t.compositionstart=$t.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),bc(t,!0),t.markCursor=null;else if(bc(t),tr&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let i=r.focusNode,s=r.focusOffset;i&&i.nodeType==1&&s!=0;){let o=s<0?i.lastChild:i.childNodes[s-1];if(!o)break;if(o.nodeType==3){t.domSelection().collapse(o,o.nodeValue.length);break}else i=o,s=-1}}t.input.composing=!0}v_(t,W2)};$t.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,v_(t,20))};function v_(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>bc(t),e))}function k_(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=q2());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function q2(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function bc(t,e=!1){if(!(qn&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),k_(t),e||t.docView&&t.docView.dirty){let n=tm(t);return n&&!n.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(n)):t.updateState(t.state),!0}return!1}}function K2(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const fa=sn&&Ci<15||Mo&&$R<604;Ht.copy=$t.cut=(t,e)=>{let n=e,r=t.state.selection,i=n.type=="cut";if(r.empty)return;let s=fa?null:n.clipboardData,o=r.content(),{dom:l,text:a}=f_(t,o);s?(n.preventDefault(),s.clearData(),s.setData("text/html",l.innerHTML),s.setData("text/plain",a)):K2(t,l),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function G2(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function J2(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?ha(t,r.value,null,i,e):ha(t,r.textContent,r.innerHTML,i,e)},50)}function ha(t,e,n,r,i){let s=h_(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",a=>a(t,i,s||J.empty)))return!0;if(!s)return!1;let o=G2(s),l=o?t.state.tr.replaceSelectionWith(o,r):t.state.tr.replaceSelection(s);return t.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function __(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}$t.paste=(t,e)=>{let n=e;if(t.composing&&!qn)return;let r=fa?null:n.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&ha(t,__(r),r.getData("text/html"),i,n)?n.preventDefault():J2(t,n)};class E_{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const C_=En?"altKey":"ctrlKey";Ht.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i=t.state.selection,s=i.empty?null:t.posAtCoords(pf(n)),o;if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof ne?i.to-1:i.to))){if(r&&r.mightDrag)o=ne.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let c=t.docView.nearestDesc(n.target,!0);c&&c.node.type.spec.draggable&&c!=t.docView&&(o=ne.create(t.state.doc,c.posBefore))}}let l=(o||t.state.selection).content(),{dom:a,text:u}=f_(t,l);n.dataTransfer.clearData(),n.dataTransfer.setData(fa?"Text":"text/html",a.innerHTML),n.dataTransfer.effectAllowed="copyMove",fa||n.dataTransfer.setData("text/plain",u),t.dragging=new E_(l,!n[C_],o)};Ht.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};$t.dragover=$t.dragenter=(t,e)=>e.preventDefault();$t.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let i=t.posAtCoords(pf(n));if(!i)return;let s=t.state.doc.resolve(i.pos),o=r&&r.slice;o?t.someProp("transformPasted",m=>{o=m(o,t)}):o=h_(t,__(n.dataTransfer),fa?null:n.dataTransfer.getData("text/html"),!1,s);let l=!!(r&&!n[C_]);if(t.someProp("handleDrop",m=>m(t,n,o||J.empty,l))){n.preventDefault();return}if(!o)return;n.preventDefault();let a=o?jk(t.state.doc,s.pos,o):s.pos;a==null&&(a=s.pos);let u=t.state.tr;if(l){let{node:m}=r;m?m.replace(u):u.deleteSelection()}let c=u.mapping.map(a),f=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,h=u.doc;if(f?u.replaceRangeWith(c,c,o.content.firstChild):u.replaceRange(c,c,o),u.doc.eq(h))return;let p=u.doc.resolve(c);if(f&&ne.isSelectable(o.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(o.content.firstChild))u.setSelection(new ne(p));else{let m=u.mapping.map(a);u.mapping.maps[u.mapping.maps.length-1].forEach((v,C,y,_)=>m=_),u.setSelection(nm(t,p,u.doc.resolve(m)))}t.focus(),t.dispatch(u.setMeta("uiEvent","drop"))};Ht.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Fr(t)},20))};Ht.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};Ht.beforeinput=(t,e)=>{if(It&&qn&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",s=>s(t,Yi(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in $t)Ht[t]=$t[t];function da(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class xc{constructor(e,n){this.toDOM=e,this.spec=n||ds,this.side=this.spec.side||0}map(e,n,r,i){let{pos:s,deleted:o}=e.mapResult(n.from+i,this.side<0?-1:1);return o?null:new en(s-r,s-r,this)}valid(){return!0}eq(e){return this==e||e instanceof xc&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&da(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class xi{constructor(e,n){this.attrs=e,this.spec=n||ds}map(e,n,r,i){let s=e.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,o=e.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return s>=o?null:new en(s,o,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof xi&&da(this.attrs,e.attrs)&&da(this.spec,e.spec)}static is(e){return e.type instanceof xi}destroy(){}}class om{constructor(e,n){this.attrs=e,this.spec=n||ds}map(e,n,r,i){let s=e.mapResult(n.from+i,1);if(s.deleted)return null;let o=e.mapResult(n.to+i,-1);return o.deleted||o.pos<=s.pos?null:new en(s.pos-r,o.pos-r,this)}valid(e,n){let{index:r,offset:i}=e.content.findIndex(n.from),s;return i==n.from&&!(s=e.child(r)).isText&&i+s.nodeSize==n.to}eq(e){return this==e||e instanceof om&&da(this.attrs,e.attrs)&&da(this.spec,e.spec)}destroy(){}}class en{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new en(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new en(e,e,new xc(n,r))}static inline(e,n,r,i){return new en(e,n,new xi(r,i))}static node(e,n,r,i){return new en(e,n,new om(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof xi}get widget(){return this.type instanceof xc}}const Hs=[],ds={};class Ke{constructor(e,n){this.local=e.length?e:Hs,this.children=n.length?n:Hs}static create(e,n){return n.length?Tc(n,e,0,ds):bt}find(e,n,r){let i=[];return this.findInner(e??0,n??1e9,i,0,r),i}findInner(e,n,r,i,s){for(let o=0;o<this.local.length;o++){let l=this.local[o];l.from<=n&&l.to>=e&&(!s||s(l.spec))&&r.push(l.copy(l.from+i,l.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<n&&this.children[o+1]>e){let l=this.children[o]+1;this.children[o+2].findInner(e-l,n-l,r,i+l,s)}}map(e,n,r){return this==bt||e.maps.length==0?this:this.mapInner(e,n,0,0,r||ds)}mapInner(e,n,r,i,s){let o;for(let l=0;l<this.local.length;l++){let a=this.local[l].map(e,r,i);a&&a.type.valid(n,a)?(o||(o=[])).push(a):s.onRemove&&s.onRemove(this.local[l].spec)}return this.children.length?Y2(this.children,o||[],e,n,r,i,s):o?new Ke(o.sort(ps),Hs):bt}add(e,n){return n.length?this==bt?Ke.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let i,s=0;e.forEach((l,a)=>{let u=a+r,c;if(c=x_(n,l,u)){for(i||(i=this.children.slice());s<i.length&&i[s]<a;)s+=3;i[s]==a?i[s+2]=i[s+2].addInner(l,c,u+1):i.splice(s,0,a,a+l.nodeSize,Tc(c,l,u+1,ds)),s+=3}});let o=b_(s?T_(n):n,-r);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||o.splice(l--,1);return new Ke(o.length?this.local.concat(o).sort(ps):this.local,i||this.children)}remove(e){return e.length==0||this==bt?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,i=this.local;for(let s=0;s<r.length;s+=3){let o,l=r[s]+n,a=r[s+1]+n;for(let c=0,f;c<e.length;c++)(f=e[c])&&f.from>l&&f.to<a&&(e[c]=null,(o||(o=[])).push(f));if(!o)continue;r==this.children&&(r=this.children.slice());let u=r[s+2].removeInner(o,l+1);u!=bt?r[s+2]=u:(r.splice(s,3),s-=3)}if(i.length){for(let s=0,o;s<e.length;s++)if(o=e[s])for(let l=0;l<i.length;l++)i[l].eq(o,n)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Ke(i,r):bt}forChild(e,n){if(this==bt)return this;if(n.isLeaf)return Ke.empty;let r,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let s=e+1,o=s+n.content.size;for(let l=0;l<this.local.length;l++){let a=this.local[l];if(a.from<o&&a.to>s&&a.type instanceof xi){let u=Math.max(s,a.from)-s,c=Math.min(o,a.to)-s;u<c&&(i||(i=[])).push(a.copy(u,c))}}if(i){let l=new Ke(i.sort(ps),Hs);return r?new li([l,r]):l}return r||bt}eq(e){if(this==e)return!0;if(!(e instanceof Ke)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return lm(this.localsInner(e))}localsInner(e){if(this==bt)return Hs;if(e.inlineContent||!this.local.some(xi.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof xi||n.push(this.local[r]);return n}}Ke.empty=new Ke([],[]);Ke.removeOverlap=lm;const bt=Ke.empty;class li{constructor(e){this.members=e}map(e,n){const r=this.members.map(i=>i.map(e,n,ds));return li.from(r)}forChild(e,n){if(n.isLeaf)return Ke.empty;let r=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(e,n);s!=bt&&(s instanceof li?r=r.concat(s.members):r.push(s))}return li.from(r)}eq(e){if(!(e instanceof li)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(e);if(s.length)if(!n)n=s;else{r&&(n=n.slice(),r=!1);for(let o=0;o<s.length;o++)n.push(s[o])}}return n?lm(r?n:n.sort(ps)):Hs}static from(e){switch(e.length){case 0:return bt;case 1:return e[0];default:return new li(e.every(n=>n instanceof Ke)?e:e.reduce((n,r)=>n.concat(r instanceof Ke?r:r.members),[]))}}}function Y2(t,e,n,r,i,s,o){let l=t.slice();for(let u=0,c=s;u<n.maps.length;u++){let f=0;n.maps[u].forEach((h,p,m,v)=>{let C=v-m-(p-h);for(let y=0;y<l.length;y+=3){let _=l[y+1];if(_<0||h>_+c-f)continue;let x=l[y]+c-f;p>=x?l[y+1]=h<=x?-2:-1:h>=c&&C&&(l[y]+=C,l[y+1]+=C)}f+=C}),c=n.maps[u].map(c,-1)}let a=!1;for(let u=0;u<l.length;u+=3)if(l[u+1]<0){if(l[u+1]==-2){a=!0,l[u+1]=-1;continue}let c=n.map(t[u]+s),f=c-i;if(f<0||f>=r.content.size){a=!0;continue}let h=n.map(t[u+1]+s,-1),p=h-i,{index:m,offset:v}=r.content.findIndex(f),C=r.maybeChild(m);if(C&&v==f&&v+C.nodeSize==p){let y=l[u+2].mapInner(n,C,c+1,t[u]+s+1,o);y!=bt?(l[u]=f,l[u+1]=p,l[u+2]=y):(l[u+1]=-2,a=!0)}else a=!0}if(a){let u=Q2(l,t,e,n,i,s,o),c=Tc(u,r,0,o);e=c.local;for(let f=0;f<l.length;f+=3)l[f+1]<0&&(l.splice(f,3),f-=3);for(let f=0,h=0;f<c.children.length;f+=3){let p=c.children[f];for(;h<l.length&&l[h]<p;)h+=3;l.splice(h,0,c.children[f],c.children[f+1],c.children[f+2])}}return new Ke(e.sort(ps),l)}function b_(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let i=t[r];n.push(new en(i.from+e,i.to+e,i.type))}return n}function Q2(t,e,n,r,i,s,o){function l(a,u){for(let c=0;c<a.local.length;c++){let f=a.local[c].map(r,i,u);f?n.push(f):o.onRemove&&o.onRemove(a.local[c].spec)}for(let c=0;c<a.children.length;c+=3)l(a.children[c+2],a.children[c]+u+1)}for(let a=0;a<t.length;a+=3)t[a+1]==-1&&l(t[a+2],e[a]+s+1);return n}function x_(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,i=null;for(let s=0,o;s<t.length;s++)(o=t[s])&&o.from>n&&o.to<r&&((i||(i=[])).push(o),t[s]=null);return i}function T_(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function Tc(t,e,n,r){let i=[],s=!1;e.forEach((l,a)=>{let u=x_(t,l,a+n);if(u){s=!0;let c=Tc(u,l,n+a+1,r);c!=bt&&i.push(a,a+l.nodeSize,c)}});let o=b_(s?T_(t):t,-n).sort(ps);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||(r.onRemove&&r.onRemove(o[l].spec),o.splice(l--,1));return o.length||i.length?new Ke(o,i):bt}function ps(t,e){return t.from-e.from||t.to-e.to}function lm(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let i=n+1;i<e.length;i++){let s=e[i];if(s.from==r.from){s.to!=r.to&&(e==t&&(e=t.slice()),e[i]=s.copy(s.from,r.to),Gy(e,i+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,s.from),Gy(e,i,r.copy(s.from,r.to)));break}}}return e}function Gy(t,e,n){for(;e<t.length&&ps(n,t[e])>0;)e++;t.splice(e,0,n)}function kh(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=bt&&e.push(r)}),t.cursorWrapper&&e.push(Ke.create(t.state.doc,[t.cursorWrapper.deco])),li.from(e)}const Z2={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},X2=sn&&Ci<=11;class eA{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class tA{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new eA,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);sn&&Ci<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),X2&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Z2)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(zy(this.view)){if(this.suppressingSelectionUpdates)return Fr(this.view);if(sn&&Ci<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&bs(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let s=e.focusNode;s;s=ca(s))n.add(s);for(let s=e.anchorNode;s;s=ca(s))if(n.has(s)){r=s;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&zy(e)&&!this.ignoreSelectionChange(r),s=-1,o=-1,l=!1,a=[];if(e.editable)for(let c=0;c<n.length;c++){let f=this.registerMutation(n[c],a);f&&(s=s<0?f.from:Math.min(f.from,s),o=o<0?f.to:Math.max(f.to,o),f.typeOver&&(l=!0))}if(tr&&a.length>1){let c=a.filter(f=>f.nodeName=="BR");if(c.length==2){let f=c[0],h=c[1];f.parentNode&&f.parentNode.parentNode==h.parentNode?h.remove():f.remove()}}let u=null;s<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&hf(r)&&(u=tm(e))&&u.eq(me.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Fr(e),this.currentSelection.set(r),e.scrollToSelection()):(s>-1||i)&&(s>-1&&(e.docView.markDirty(s,o),nA(e)),this.handleDOMChange(s,o,l,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Fr(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let c=0;c<e.addedNodes.length;c++)n.push(e.addedNodes[c]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,s=e.nextSibling;if(sn&&Ci<=11&&e.addedNodes.length)for(let c=0;c<e.addedNodes.length;c++){let{previousSibling:f,nextSibling:h}=e.addedNodes[c];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(i=f),(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(s=h)}let o=i&&i.parentNode==e.target?Lt(i)+1:0,l=r.localPosFromDOM(e.target,o,-1),a=s&&s.parentNode==e.target?Lt(s):e.target.childNodes.length,u=r.localPosFromDOM(e.target,a,1);return{from:l,to:u}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}let Jy=new WeakMap,Yy=!1;function nA(t){if(!Jy.has(t)&&(Jy.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=tr,Yy)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Yy=!0}}function rA(t){let e;function n(a){a.preventDefault(),a.stopImmediatePropagation(),e=a.getTargetRanges()[0]}t.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",n,!0);let r=e.startContainer,i=e.startOffset,s=e.endContainer,o=e.endOffset,l=t.domAtPos(t.state.selection.anchor);return bs(l.node,l.offset,s,o)&&([r,i,s,o]=[s,o,r,i]),{anchorNode:r,anchorOffset:i,focusNode:s,focusOffset:o}}function iA(t,e,n){let{node:r,fromOffset:i,toOffset:s,from:o,to:l}=t.docView.parseRange(e,n),a=t.domSelectionRange(),u,c=a.anchorNode;if(c&&t.dom.contains(c.nodeType==1?c:c.parentNode)&&(u=[{node:c,offset:a.anchorOffset}],hf(a)||u.push({node:a.focusNode,offset:a.focusOffset})),It&&t.input.lastKeyCode===8)for(let C=s;C>i;C--){let y=r.childNodes[C-1],_=y.pmViewDesc;if(y.nodeName=="BR"&&!_){s=C;break}if(!_||_.size)break}let f=t.state.doc,h=t.someProp("domParser")||Nk.fromSchema(t.state.schema),p=f.resolve(o),m=null,v=h.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:i,to:s,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:sA,context:p});if(u&&u[0].pos!=null){let C=u[0].pos,y=u[1]&&u[1].pos;y==null&&(y=C),m={anchor:C+o,head:y+o}}return{doc:v,sel:m,from:o,to:l}}function sA(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(jt&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||jt&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const oA=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function lA(t,e,n,r,i){let s=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let z=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,Q=tm(t,z);if(Q&&!t.state.selection.eq(Q)){if(It&&qn&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",nt=>nt(t,Yi(13,"Enter"))))return;let ye=t.state.tr.setSelection(Q);z=="pointer"?ye.setMeta("pointer",!0):z=="key"&&ye.scrollIntoView(),s&&ye.setMeta("composition",s),t.dispatch(ye)}return}let o=t.state.doc.resolve(e),l=o.sharedDepth(n);e=o.before(l+1),n=t.state.doc.resolve(n).after(l+1);let a=t.state.selection,u=iA(t,e,n),c=t.state.doc,f=c.slice(u.from,u.to),h,p;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(h=t.state.selection.to,p="end"):(h=t.state.selection.from,p="start"),t.input.lastKeyCode=null;let m=cA(f.content,u.doc.content,u.from,h,p);if((Mo&&t.input.lastIOSEnter>Date.now()-225||qn)&&i.some(z=>z.nodeType==1&&!oA.test(z.nodeName))&&(!m||m.endA>=m.endB)&&t.someProp("handleKeyDown",z=>z(t,Yi(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!m)if(r&&a instanceof _e&&!a.empty&&a.$head.sameParent(a.$anchor)&&!t.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))m={start:a.from,endA:a.to,endB:a.to};else{if(u.sel){let z=Qy(t,t.state.doc,u.sel);if(z&&!z.eq(t.state.selection)){let Q=t.state.tr.setSelection(z);s&&Q.setMeta("composition",s),t.dispatch(Q)}}return}if(It&&t.cursorWrapper&&u.sel&&u.sel.anchor==t.cursorWrapper.deco.from&&u.sel.head==u.sel.anchor){let z=m.endB-m.start;u.sel={anchor:u.sel.anchor+z,head:u.sel.anchor+z}}t.input.domChangeCount++,t.state.selection.from<t.state.selection.to&&m.start==m.endB&&t.state.selection instanceof _e&&(m.start>t.state.selection.from&&m.start<=t.state.selection.from+2&&t.state.selection.from>=u.from?m.start=t.state.selection.from:m.endA<t.state.selection.to&&m.endA>=t.state.selection.to-2&&t.state.selection.to<=u.to&&(m.endB+=t.state.selection.to-m.endA,m.endA=t.state.selection.to)),sn&&Ci<=11&&m.endB==m.start+1&&m.endA==m.start&&m.start>u.from&&u.doc.textBetween(m.start-u.from-1,m.start-u.from+1)==" "&&(m.start--,m.endA--,m.endB--);let v=u.doc.resolveNoCache(m.start-u.from),C=u.doc.resolveNoCache(m.endB-u.from),y=c.resolve(m.start),_=v.sameParent(C)&&v.parent.inlineContent&&y.end()>=m.endA,x;if((Mo&&t.input.lastIOSEnter>Date.now()-225&&(!_||i.some(z=>z.nodeName=="DIV"||z.nodeName=="P"))||!_&&v.pos<u.doc.content.size&&!v.sameParent(C)&&(x=me.findFrom(u.doc.resolve(v.pos+1),1,!0))&&x.head==C.pos)&&t.someProp("handleKeyDown",z=>z(t,Yi(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>m.start&&uA(c,m.start,m.endA,v,C)&&t.someProp("handleKeyDown",z=>z(t,Yi(8,"Backspace")))){qn&&It&&t.domObserver.suppressSelectionUpdates();return}It&&qn&&m.endB==m.start&&(t.input.lastAndroidDelete=Date.now()),qn&&!_&&v.start()!=C.start()&&C.parentOffset==0&&v.depth==C.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==m.endA&&(m.endB-=2,C=u.doc.resolveNoCache(m.endB-u.from),setTimeout(()=>{t.someProp("handleKeyDown",function(z){return z(t,Yi(13,"Enter"))})},20));let O=m.start,R=m.endA,P,F,V;if(_){if(v.pos==C.pos)sn&&Ci<=11&&v.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Fr(t),20)),P=t.state.tr.delete(O,R),F=c.resolve(m.start).marksAcross(c.resolve(m.endA));else if(m.endA==m.endB&&(V=aA(v.parent.content.cut(v.parentOffset,C.parentOffset),y.parent.content.cut(y.parentOffset,m.endA-y.start()))))P=t.state.tr,V.type=="add"?P.addMark(O,R,V.mark):P.removeMark(O,R,V.mark);else if(v.parent.child(v.index()).isText&&v.index()==C.index()-(C.textOffset?0:1)){let z=v.parent.textBetween(v.parentOffset,C.parentOffset);if(t.someProp("handleTextInput",Q=>Q(t,O,R,z)))return;P=t.state.tr.insertText(z,O,R)}}if(P||(P=t.state.tr.replace(O,R,u.doc.slice(m.start-u.from,m.endB-u.from))),u.sel){let z=Qy(t,P.doc,u.sel);z&&!(It&&qn&&t.composing&&z.empty&&(m.start!=m.endB||t.input.lastAndroidDelete<Date.now()-100)&&(z.head==O||z.head==P.mapping.map(R)-1)||sn&&z.empty&&z.head==O)&&P.setSelection(z)}F&&P.ensureMarks(F),s&&P.setMeta("composition",s),t.dispatch(P.scrollIntoView())}function Qy(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:nm(t,e.resolve(n.anchor),e.resolve(n.head))}function aA(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,i=n,s=r,o,l,a;for(let c=0;c<r.length;c++)i=r[c].removeFromSet(i);for(let c=0;c<n.length;c++)s=n[c].removeFromSet(s);if(i.length==1&&s.length==0)l=i[0],o="add",a=c=>c.mark(l.addToSet(c.marks));else if(i.length==0&&s.length==1)l=s[0],o="remove",a=c=>c.mark(l.removeFromSet(c.marks));else return null;let u=[];for(let c=0;c<e.childCount;c++)u.push(a(e.child(c)));if(H.from(u).eq(t))return{mark:l,type:o}}function uA(t,e,n,r,i){if(!r.parent.isTextblock||n-e<=i.pos-r.pos||_h(r,!0,!1)<i.pos)return!1;let s=t.resolve(e);if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=t.resolve(_h(s,!0,!0));return!o.parent.isTextblock||o.pos>n||_h(o,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function _h(t,e,n){let r=t.depth,i=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,i++,e=!1;if(n){let s=t.node(r).maybeChild(t.indexAfter(r));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}function cA(t,e,n,r,i){let s=t.findDiffStart(e,n);if(s==null)return null;let{a:o,b:l}=t.findDiffEnd(e,n+t.size,n+e.size);if(i=="end"){let a=Math.max(0,s-Math.min(o,l));r-=o+a-s}if(o<s&&t.size<e.size){let a=r<=s&&r>=o?s-r:0;s-=a,s&&s<e.size&&Zy(e.textBetween(s-1,s+1))&&(s+=a?1:-1),l=s+(l-o),o=s}else if(l<s){let a=r<=s&&r>=l?s-r:0;s-=a,s&&s<t.size&&Zy(t.textBetween(s-1,s+1))&&(s+=a?1:-1),o=s+(o-l),l=s}return{start:s,endA:o,endB:l}}function Zy(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class fA{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new N2,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(r1),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=t1(this),e1(this),this.nodeViews=n1(this),this.docView=Dy(this.state.doc,Xy(this),kh(this),this.dom,this),this.domObserver=new tA(this,(r,i,s,o)=>lA(this,r,i,s,o)),this.domObserver.start(),M2(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&dp(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(r1),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let i=this.state,s=!1,o=!1;e.storedMarks&&this.composing&&(k_(this),o=!0),this.state=e;let l=i.plugins!=e.plugins||this._props.plugins!=n.plugins;if(l||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let p=n1(this);dA(p,this.nodeViews)&&(this.nodeViews=p,s=!0)}(l||n.handleDOMEvents!=this._props.handleDOMEvents)&&dp(this),this.editable=t1(this),e1(this);let a=kh(this),u=Xy(this),c=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",f=s||!this.docView.matchesNode(e.doc,u,a);(f||!e.selection.eq(i.selection))&&(o=!0);let h=c=="preserve"&&o&&this.dom.style.overflowAnchor==null&&KR(this);if(o){this.domObserver.stop();let p=f&&(sn||It)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&hA(i.selection,e.selection);if(f){let m=It?this.trackWrites=this.domSelectionRange().focusNode:null;(s||!this.docView.update(e.doc,u,a,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=Dy(e.doc,u,a,this.dom,this)),m&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&w2(this))?Fr(this,p):(a_(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():h&&GR(h)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof ne){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&Iy(this,n.getBoundingClientRect(),e)}else Iy(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let s=r.from+(this.state.doc.content.size-n.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==r.node&&(i=s)}this.dragging=new E_(e.slice,e.move,i<0?void 0:ne.create(this.state.doc,i))}someProp(e,n){let r=this._props&&this._props[e],i;if(r!=null&&(i=n?n(r):r))return i;for(let o=0;o<this.directPlugins.length;o++){let l=this.directPlugins[o].props[e];if(l!=null&&(i=n?n(l):l))return i}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let l=s[o].props[e];if(l!=null&&(i=n?n(l):l))return i}}hasFocus(){if(sn){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&JR(this.dom),Fr(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return e2(this,e)}coordsAtPos(e,n=1){return e_(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let i=this.docView.posFromDOM(e,n,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,n){return s2(this,n||this.state,e)}pasteHTML(e,n){return ha(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return ha(this,e,null,!0,n||new ClipboardEvent("paste"))}destroy(){this.docView&&(D2(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],kh(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return this.docView==null}dispatchEvent(e){return P2(this,e)}dispatch(e){let n=this._props.dispatchTransaction;n?n.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){return jt&&this.root.nodeType===11&&zR(this.dom.ownerDocument)==this.dom?rA(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function Xy(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[en.node(0,t.state.doc.content.size,e)]}function e1(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:en.widget(t.state.selection.head,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function t1(t){return!t.someProp("editable",e=>e(t.state)===!1)}function hA(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function n1(t){let e=Object.create(null);function n(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function dA(t,e){let n=0,r=0;for(let i in t){if(t[i]!=e[i])return!0;n++}for(let i in e)r++;return n!=r}function r1(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}const Eh=3e4;class pA extends dT{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const n=Ni();this.getLocalState()!==null&&Eh/2<=n-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const r=[];this.meta.forEach((i,s)=>{s!==this.clientID&&Eh<=n-i.lastUpdated&&this.states.has(s)&&r.push(s)}),r.length>0&&am(this,r,"timeout")},gr(Eh/10)),e.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){const n=this.clientID,r=this.meta.get(n),i=r===void 0?0:r.clock+1,s=this.states.get(n);e===null?this.states.delete(n):this.states.set(n,e),this.meta.set(n,{clock:i,lastUpdated:Ni()});const o=[],l=[],a=[],u=[];e===null?u.push(n):s==null?e!=null&&o.push(n):(l.push(n),_l(s,e)||a.push(n)),(o.length>0||a.length>0||u.length>0)&&this.emit("change",[{added:o,updated:a,removed:u},"local"]),this.emit("update",[{added:o,updated:l,removed:u},"local"])}setLocalStateField(e,n){const r=this.getLocalState();r!==null&&this.setLocalState({...r,[e]:n})}getStates(){return this.states}}const am=(t,e,n)=>{const r=[];for(let i=0;i<e.length;i++){const s=e[i];if(t.states.has(s)){if(t.states.delete(s),s===t.clientID){const o=t.meta.get(s);t.meta.set(s,{clock:o.clock+1,lastUpdated:Ni()})}r.push(s)}}r.length>0&&(t.emit("change",[{added:[],updated:[],removed:r},n]),t.emit("update",[{added:[],updated:[],removed:r},n]))},um=(t,e,n=t.states)=>{const r=e.length,i=mr();ie(i,r);for(let s=0;s<r;s++){const o=e[s],l=n.get(o)||null,a=t.meta.get(o).clock;ie(i,o),ie(i,a),us(i,JSON.stringify(l))}return Ot(i)},gA=(t,e,n)=>{const r=Ui(e),i=Ni(),s=[],o=[],l=[],a=[],u=le(r);for(let c=0;c<u;c++){const f=le(r);let h=le(r);const p=JSON.parse(Ei(r)),m=t.meta.get(f),v=t.states.get(f),C=m===void 0?0:m.clock;(C<h||C===h&&p===null&&t.states.has(f))&&(p===null?f===t.clientID&&t.getLocalState()!=null?h++:t.states.delete(f):t.states.set(f,p),t.meta.set(f,{clock:h,lastUpdated:i}),m===void 0&&p!==null?s.push(f):m!==void 0&&p===null?a.push(f):p!==null&&(_l(p,v)||l.push(f),o.push(f)))}(s.length>0||l.length>0||a.length>0)&&t.emit("change",[{added:s,updated:l,removed:a},n]),(s.length>0||o.length>0||a.length>0)&&t.emit("update",[{added:s,updated:o,removed:a},n])},mA=()=>{let t=!0;return(e,n)=>{if(t){t=!1;try{e()}finally{t=!0}}else n!==void 0&&n()}},yA=/[\uD800-\uDBFF]/,wA=/[\uDC00-\uDFFF]/,SA=(t,e)=>{let n=0,r=0;for(;n<t.length&&n<e.length&&t[n]===e[n];)n++;for(n>0&&yA.test(t[n-1])&&n--;r+n<t.length&&r+n<e.length&&t[t.length-r-1]===e[e.length-r-1];)r++;return r>0&&wA.test(t[t.length-r])&&r--,{index:n,remove:t.length-n-r,insert:e.slice(n,e.length-r)}},vA=SA,Le=new Ra("y-sync"),So=new Ra("y-undo"),uu=new Ra("yjs-cursor"),Ic=(t,e)=>e===void 0?!t.deleted:e.sv.has(t.id.client)&&e.sv.get(t.id.client)>t.id.clock&&!zo(e.ds,t.id),kA=[{light:"#ecd44433",dark:"#ecd444"}],_A=(t,e,n)=>{if(!t.has(n)){if(t.size<e.length){const r=Ri();t.forEach(i=>r.add(i)),e=e.filter(i=>!r.has(i))}t.set(n,HT(e))}return t.get(n)},EA=(t,{colors:e=kA,colorMapping:n=new Map,permanentUserData:r=null,onFirstRender:i=()=>{}}={})=>{let s=!1,o;const l=new kr({props:{editable:a=>{const u=Le.getState(a);return u.snapshot==null&&u.prevSnapshot==null}},key:Le,state:{init:(a,u)=>({type:t,doc:t.doc,binding:null,snapshot:null,prevSnapshot:null,isChangeOrigin:!1,isUndoRedoOperation:!1,addToHistory:!0,colors:e,colorMapping:n,permanentUserData:r}),apply:(a,u)=>{const c=a.getMeta(Le);if(c!==void 0){u=Object.assign({},u);for(const f in c)u[f]=c[f]}return u.addToHistory=a.getMeta("addToHistory")!==!1,u.isChangeOrigin=c!==void 0&&!!c.isChangeOrigin,u.isUndoRedoOperation=c!==void 0&&!!c.isChangeOrigin&&!!c.isUndoRedoOperation,u.binding!==null&&c!==void 0&&(c.snapshot!=null||c.prevSnapshot!=null)&&cc(0,()=>{u.binding==null||u.binding.isDestroyed||(c.restore==null?u.binding._renderSnapshot(c.snapshot,c.prevSnapshot,u):(u.binding._renderSnapshot(c.snapshot,c.snapshot,u),delete u.restore,delete u.snapshot,delete u.prevSnapshot,u.binding.mux(()=>{u.binding._prosemirrorChanged(u.binding.prosemirrorView.state.doc)})))}),u}},view:a=>{const u=new bA(t,a);return o!=null&&o.destroy(),o=cc(0,()=>{u._forceRerender(),a.dispatch(a.state.tr.setMeta(Le,{binding:u})),i()}),{update:()=>{const c=l.getState(a.state);if(c.snapshot==null&&c.prevSnapshot==null&&(s||a.state.doc.content.findDiffStart(a.state.doc.type.createAndFill().content)!==null)){if(s=!0,c.addToHistory===!1&&!c.isChangeOrigin){const f=So.getState(a.state),h=f&&f.undoManager;h&&h.stopCapturing()}u.mux(()=>{c.doc.transact(f=>{f.meta.set("addToHistory",c.addToHistory),u._prosemirrorChanged(a.state.doc)},Le)})}},destroy:()=>{o.destroy(),u.destroy()}}}});return l},CA=(t,e,n)=>{if(e!==null&&e.anchor!==null&&e.head!==null){const r=ga(n.doc,n.type,e.anchor,n.mapping),i=ga(n.doc,n.type,e.head,n.mapping);r!==null&&i!==null&&(t=t.setSelection(_e.create(t.doc,r,i)))}},pp=(t,e)=>({anchor:Rc(e.selection.anchor,t.type,t.mapping),head:Rc(e.selection.head,t.type,t.mapping)});class bA{constructor(e,n){this.type=e,this.prosemirrorView=n,this.mux=mA(),this.isDestroyed=!1,this.mapping=new Map,this._observeFunction=this._typeChanged.bind(this),this.doc=e.doc,this.beforeTransactionSelection=null,this.beforeAllTransactions=()=>{this.beforeTransactionSelection===null&&(this.beforeTransactionSelection=pp(this,n.state))},this.afterAllTransactions=()=>{this.beforeTransactionSelection=null},this.doc.on("beforeAllTransactions",this.beforeAllTransactions),this.doc.on("afterAllTransactions",this.afterAllTransactions),e.observeDeep(this._observeFunction),this._domSelectionInView=null}get _tr(){return this.prosemirrorView.state.tr.setMeta("addToHistory",!1)}_isLocalCursorInView(){return this.prosemirrorView.hasFocus()?(rI&&this._domSelectionInView===null&&(cc(0,()=>{this._domSelectionInView=null}),this._domSelectionInView=this._isDomSelectionInView()),this._domSelectionInView):!1}_isDomSelectionInView(){const e=this.prosemirrorView._root.getSelection(),n=this.prosemirrorView._root.createRange();n.setStart(e.anchorNode,e.anchorOffset),n.setEnd(e.focusNode,e.focusOffset),n.getClientRects().length===0&&n.startContainer&&n.collapsed&&n.selectNodeContents(n.startContainer);const i=n.getBoundingClientRect(),s=cI.documentElement;return i.bottom>=0&&i.right>=0&&i.left<=(window.innerWidth||s.clientWidth||0)&&i.top<=(window.innerHeight||s.clientHeight||0)}renderSnapshot(e,n){n||(n=$v(Mv(),new Map)),this.prosemirrorView.dispatch(this._tr.setMeta(Le,{snapshot:e,prevSnapshot:n}))}unrenderSnapshot(){this.mapping=new Map,this.mux(()=>{const e=this.type.toArray().map(r=>Mu(r,this.prosemirrorView.state.schema,this.mapping)).filter(r=>r!==null),n=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new J(H.from(e),0,0));n.setMeta(Le,{snapshot:null,prevSnapshot:null}),this.prosemirrorView.dispatch(n)})}_forceRerender(){this.mapping=new Map,this.mux(()=>{const e=this.type.toArray().map(r=>Mu(r,this.prosemirrorView.state.schema,this.mapping)).filter(r=>r!==null),n=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new J(H.from(e),0,0));this.prosemirrorView.dispatch(n.setMeta(Le,{isChangeOrigin:!0}))})}_renderSnapshot(e,n,r){e||(e=$I(this.doc)),this.mapping=new Map,this.mux(()=>{this.doc.transact(i=>{const s=r.permanentUserData;s&&s.dss.forEach(u=>{Di(i,u,c=>{})});const o=(u,c)=>{const f=u==="added"?s.getUserByClientId(c.client):s.getUserByDeletedId(c);return{user:f,type:u,color:_A(r.colorMapping,r.colors,f)}},l=tk(this.type,new zg(n.ds,e.sv)).map(u=>!u._item.deleted||Ic(u._item,e)||Ic(u._item,n)?Mu(u,this.prosemirrorView.state.schema,new Map,e,n,o):null).filter(u=>u!==null),a=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new J(H.from(l),0,0));this.prosemirrorView.dispatch(a.setMeta(Le,{isChangeOrigin:!0}))},Le)})}_typeChanged(e,n){const r=Le.getState(this.prosemirrorView.state);if(e.length===0||r.snapshot!=null||r.prevSnapshot!=null){this.renderSnapshot(r.snapshot,r.prevSnapshot);return}this.mux(()=>{const i=(l,a)=>this.mapping.delete(a);Di(n,n.deleteSet,l=>{if(l.constructor===Ae){const a=l.content.type;a&&this.mapping.delete(a)}}),n.changed.forEach(i),n.changedParentTypes.forEach(i);const s=this.type.toArray().map(l=>I_(l,this.prosemirrorView.state.schema,this.mapping)).filter(l=>l!==null);let o=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new J(H.from(s),0,0));CA(o,this.beforeTransactionSelection,this),o=o.setMeta(Le,{isChangeOrigin:!0,isUndoRedoOperation:n.origin instanceof Jv}),this.beforeTransactionSelection!==null&&this._isLocalCursorInView()&&o.scrollIntoView(),this.prosemirrorView.dispatch(o)})}_prosemirrorChanged(e){this.doc.transact(()=>{mp(this.doc,this.type,e,this.mapping),this.beforeTransactionSelection=pp(this,this.prosemirrorView.state)},Le)}destroy(){this.isDestroyed=!0,this.type.unobserveDeep(this._observeFunction),this.doc.off("beforeAllTransactions",this.beforeAllTransactions),this.doc.off("afterAllTransactions",this.afterAllTransactions)}}const I_=(t,e,n,r,i,s)=>{const o=n.get(t);if(o===void 0){if(t instanceof Ut)return Mu(t,e,n,r,i,s);throw Zn()}return o},Mu=(t,e,n,r,i,s)=>{const o=[],l=a=>{if(a.constructor===Ut){const u=I_(a,e,n,r,i,s);u!==null&&o.push(u)}else{const u=xA(a,e,n,r,i,s);u!==null&&u.forEach(c=>{c!==null&&o.push(c)})}};r===void 0||i===void 0?t.toArray().forEach(l):tk(t,new zg(i.ds,r.sv)).forEach(l);try{const a=t.getAttributes(r);r!==void 0&&(Ic(t._item,r)?Ic(t._item,i)||(a.ychange=s?s("added",t._item.id):{type:"added"}):a.ychange=s?s("removed",t._item.id):{type:"removed"});const u=e.node(t.nodeName,a,o);return n.set(t,u),u}catch{return t.doc.transact(u=>{t._item.delete(u)},Le),n.delete(t),null}},xA=(t,e,n,r,i,s)=>{const o=[],l=t.toDelta(r,i,s);try{for(let a=0;a<l.length;a++){const u=l[a],c=[];for(const f in u.attributes)c.push(e.mark(f,u.attributes[f]));o.push(e.text(u.insert,c))}}catch{return t.doc.transact(u=>{t._item.delete(u)},Le),null}return o},TA=(t,e)=>{const n=new dn,r=t.map(i=>({insert:i.text,attributes:R_(i.marks)}));return n.applyDelta(r),e.set(n,t),n},IA=(t,e)=>{const n=new Ut(t.type.name);for(const r in t.attrs){const i=t.attrs[r];i!==null&&r!=="ychange"&&n.setAttribute(r,i)}return n.insert(0,gf(t).map(r=>gp(r,e))),e.set(n,t),n},gp=(t,e)=>t instanceof Array?TA(t,e):IA(t,e),i1=t=>typeof t=="object"&&t!==null,cm=(t,e)=>{const n=Object.keys(t).filter(i=>t[i]!==null);let r=n.length===Object.keys(e).filter(i=>e[i]!==null).length;for(let i=0;i<n.length&&r;i++){const s=n[i],o=t[s],l=e[s];r=s==="ychange"||o===l||i1(o)&&i1(l)&&cm(o,l)}return r},gf=t=>{const e=t.content.content,n=[];for(let r=0;r<e.length;r++){const i=e[r];if(i.isText){const s=[];for(let o=e[r];r<e.length&&o.isText;o=e[++r])s.push(o);r--,n.push(s)}else n.push(i)}return n},O_=(t,e)=>{const n=t.toDelta();return n.length===e.length&&n.every((r,i)=>r.insert===e[i].text&&Cv(r.attributes||{}).length===e[i].marks.length&&e[i].marks.every(s=>cm(r.attributes[s.type.name]||{},s.attrs)))},pa=(t,e)=>{if(t instanceof Ut&&!(e instanceof Array)&&yp(t,e)){const n=gf(e);return t._length===n.length&&cm(t.getAttributes(),e.attrs)&&t.toArray().every((r,i)=>pa(r,n[i]))}return t instanceof dn&&e instanceof Array&&O_(t,e)},Oc=(t,e)=>t===e||t instanceof Array&&e instanceof Array&&t.length===e.length&&t.every((n,r)=>e[r]===n),s1=(t,e,n)=>{const r=t.toArray(),i=gf(e),s=i.length,o=r.length,l=ls(o,s);let a=0,u=0,c=!1;for(;a<l;a++){const f=r[a],h=i[a];if(Oc(n.get(f),h))c=!0;else if(!pa(f,h))break}for(;a+u<l;u++){const f=r[o-u-1],h=i[s-u-1];if(Oc(n.get(f),h))c=!0;else if(!pa(f,h))break}return{equalityFactor:a+u,foundMappedChild:c}},OA=t=>{let e="",n=t._start;const r={};for(;n!==null;)n.deleted||(n.countable&&n.content instanceof er?e+=n.content.str:n.content instanceof Ze&&(r[n.content.key]=null)),n=n.right;return{str:e,nAttrs:r}},RA=(t,e,n)=>{n.set(t,e);const{nAttrs:r,str:i}=OA(t),s=e.map(u=>({insert:u.text,attributes:Object.assign({},r,R_(u.marks))})),{insert:o,remove:l,index:a}=vA(i,s.map(u=>u.insert).join(""));t.delete(a,l),t.insert(a,o),t.applyDelta(s.map(u=>({retain:u.insert.length,attributes:u.attributes})))},R_=t=>{const e={};return t.forEach(n=>{n.type.name!=="ychange"&&(e[n.type.name]=n.attrs)}),e},mp=(t,e,n,r)=>{if(e instanceof Ut&&e.nodeName!==n.type.name)throw new Error("node name mismatch!");if(r.set(e,n),e instanceof Ut){const f=e.getAttributes(),h=n.attrs;for(const p in h)h[p]!==null?f[p]!==h[p]&&p!=="ychange"&&e.setAttribute(p,h[p]):e.removeAttribute(p);for(const p in f)h[p]===void 0&&e.removeAttribute(p)}const i=gf(n),s=i.length,o=e.toArray(),l=o.length,a=ls(s,l);let u=0,c=0;for(;u<a;u++){const f=o[u],h=i[u];if(!Oc(r.get(f),h))if(pa(f,h))r.set(f,h);else break}for(;c+u+1<a;c++){const f=o[l-c-1],h=i[s-c-1];if(!Oc(r.get(f),h))if(pa(f,h))r.set(f,h);else break}t.transact(()=>{for(;l-u-c>0&&s-u-c>0;){const h=o[u],p=i[u],m=o[l-c-1],v=i[s-c-1];if(h instanceof dn&&p instanceof Array)O_(h,p)||RA(h,p,r),u+=1;else{let C=h instanceof Ut&&yp(h,p),y=m instanceof Ut&&yp(m,v);if(C&&y){const _=s1(h,p,r),x=s1(m,v,r);_.foundMappedChild&&!x.foundMappedChild?y=!1:!_.foundMappedChild&&x.foundMappedChild||_.equalityFactor<x.equalityFactor?C=!1:y=!1}C?(mp(t,h,p,r),u+=1):y?(mp(t,m,v,r),c+=1):(r.delete(e.get(u)),e.delete(u,1),e.insert(u,[gp(p,r)]),u+=1)}}const f=l-u-c;if(l===1&&s===0&&o[0]instanceof dn?(r.delete(o[0]),o[0].delete(0,o[0].length)):f>0&&(e.slice(u,u+f).forEach(h=>r.delete(h)),e.delete(u,f)),u+c<s){const h=[];for(let p=u;p<s-c;p++)h.push(gp(i[p],r));e.insert(u,h)}},Le)},yp=(t,e)=>!(e instanceof Array)&&t.nodeName===e.type.name;let Il=null;const AA=()=>{const t=Il;Il=null,t.forEach((e,n)=>{const r=n.state.tr,i=Le.getState(n.state);i&&i.binding&&!i.binding.isDestroyed&&(e.forEach((s,o)=>{r.setMeta(o,s)}),n.dispatch(r))})},NA=(t,e,n)=>{Il||(Il=new Map,cc(0,AA)),vr(Il,t,Vt).set(e,n)},Rc=(t,e,n)=>{if(t===0)return oh(e,0);let r=e._first===null?null:e._first.content.type;for(;r!==null&&e!==r;){if(r instanceof dn){if(r._length>=t)return oh(r,t);if(t-=r._length,r._item!==null&&r._item.next!==null)r=r._item.next.content.type;else{do r=r._item===null?null:r._item.parent,t--;while(r!==e&&r!==null&&r._item!==null&&r._item.next===null);r!==null&&r!==e&&(r=r._item===null?null:r._item.next.content.type)}}else{const i=(n.get(r)||{nodeSize:0}).nodeSize;if(r._first!==null&&t<i)r=r._first.content.type,t--;else{if(t===1&&r._length===0&&i>1)return new ia(r._item===null?null:r._item.id,r._item===null?na(r):null,null);if(t-=i,r._item!==null&&r._item.next!==null)r=r._item.next.content.type;else{if(t===0)return r=r._item===null?r:r._item.parent,new ia(r._item===null?null:r._item.id,r._item===null?na(r):null,null);do r=r._item.parent,t--;while(r!==e&&r._item.next===null);r!==e&&(r=r._item.next.content.type)}}}if(r===null)throw Pn();if(t===0&&r.constructor!==dn&&r!==e)return MA(r._item.parent,r._item)}return oh(e,e._length)},MA=(t,e)=>{let n=null,r=null;return t._item===null?r=na(t):n=ae(t._item.id.client,t._item.id.clock),new ia(n,r,e.id)},ga=(t,e,n,r)=>{const i=HI(n,t);if(i===null||i.type!==e&&!ra(e,i.type._item))return null;let s=i.type,o=0;if(s.constructor===dn)o=i.index;else if(s._item===null||!s._item.deleted){let l=s._first,a=0;for(;a<s._length&&a<i.index&&l!==null;){if(!l.deleted){const u=l.content.type;a++,u instanceof dn?o+=u._length:o+=r.get(u).nodeSize}l=l.right}o+=1}for(;s!==e&&s._item!==null;){const l=s._item.parent;if(l._item===null||!l._item.deleted){o+=1;let a=l._first;for(;a!==null;){const u=a.content.type;if(u===s)break;a.deleted||(u instanceof dn?o+=u._length:o+=r.get(u).nodeSize),a=a.right}}s=l}return o-1},DA=(t,e,n)=>t!==e,BA=t=>{const e=document.createElement("span");e.classList.add("ProseMirror-yjs-cursor"),e.setAttribute("style",`border-color: ${t.color}`);const n=document.createElement("div");n.setAttribute("style",`background-color: ${t.color}`),n.insertBefore(document.createTextNode(t.name),null);const r=document.createTextNode(""),i=document.createTextNode("");return e.insertBefore(r,null),e.insertBefore(n,null),e.insertBefore(i,null),e},PA=t=>({style:`background-color: ${t.color}70`,class:"ProseMirror-yjs-selection"}),LA=/^#[0-9a-fA-F]{6}$/,o1=(t,e,n,r,i)=>{const s=Le.getState(t),o=s.doc,l=[];return s.snapshot!=null||s.prevSnapshot!=null||s.binding===null?Ke.create(t.doc,[]):(e.getStates().forEach((a,u)=>{if(n(o.clientID,u,a)&&a.cursor!=null){const c=a.user||{};c.color==null?c.color="#ffa500":LA.test(c.color)||console.warn("A user uses an unsupported color format",c),c.name==null&&(c.name=`User: ${u}`);let f=ga(o,s.type,El(a.cursor.anchor),s.binding.mapping),h=ga(o,s.type,El(a.cursor.head),s.binding.mapping);if(f!==null&&h!==null){const p=$r(t.doc.content.size-1,0);f=ls(f,p),h=ls(h,p),l.push(en.widget(h,()=>r(c),{key:u+"",side:10}));const m=ls(f,h),v=$r(f,h);l.push(en.inline(m,v,i(c),{inclusiveEnd:!0,inclusiveStart:!1}))}}}),Ke.create(t.doc,l))},FA=(t,{awarenessStateFilter:e=DA,cursorBuilder:n=BA,selectionBuilder:r=PA,getSelection:i=o=>o.selection}={},s="cursor")=>new kr({key:uu,state:{init(o,l){return o1(l,t,e,n,r)},apply(o,l,a,u){const c=Le.getState(u),f=o.getMeta(uu);return c&&c.isChangeOrigin||f&&f.awarenessUpdated?o1(u,t,e,n,r):l.map(o.mapping,o.doc)}},props:{decorations:o=>uu.getState(o)},view:o=>{const l=()=>{o.docView&&NA(o,uu,{awarenessUpdated:!0})},a=()=>{const u=Le.getState(o.state),c=t.getLocalState()||{};if(u.binding!=null)if(o.hasFocus()){const f=i(o.state),h=Rc(f.anchor,u.type,u.binding.mapping),p=Rc(f.head,u.type,u.binding.mapping);(c.cursor==null||!Z0(El(c.cursor.anchor),h)||!Z0(El(c.cursor.head),p))&&t.setLocalStateField(s,{anchor:h,head:p})}else c.cursor!=null&&ga(u.doc,u.type,El(c.cursor.anchor),u.binding.mapping)!==null&&t.setLocalStateField(s,null)};return t.on("change",l),o.dom.addEventListener("focusin",a),o.dom.addEventListener("focusout",a),{update:a,destroy:()=>{o.dom.removeEventListener("focusin",a),o.dom.removeEventListener("focusout",a),t.off("change",l),t.setLocalStateField(s,null)}}}}),UA=t=>{const e=So.getState(t).undoManager;if(e!=null)return e.undo(),!0},l1=t=>{const e=So.getState(t).undoManager;if(e!=null)return e.redo(),!0},zA=new Set(["paragraph"]),VA=(t,e)=>!(t instanceof Ae)||!(t.content instanceof nr)||!(t.content.type instanceof ks||t.content.type instanceof Ut&&e.has(t.content.type.nodeName))||t.content.type._length===0,jA=({protectedNodes:t=zA,trackedOrigins:e=[],undoManager:n=null}={})=>new kr({key:So,state:{init:(r,i)=>{const s=Le.getState(i),o=n||new Jv(s.type,{trackedOrigins:new Set([Le].concat(e)),deleteFilter:l=>VA(l,t),captureTransaction:l=>l.meta.get("addToHistory")!==!1});return{undoManager:o,prevSel:null,hasUndoOps:o.undoStack.length>0,hasRedoOps:o.redoStack.length>0}},apply:(r,i,s,o)=>{const l=Le.getState(o).binding,a=i.undoManager,u=a.undoStack.length>0,c=a.redoStack.length>0;return l?{undoManager:a,prevSel:pp(l,s),hasUndoOps:u,hasRedoOps:c}:u!==i.hasUndoOps||c!==i.hasRedoOps?Object.assign({},i,{hasUndoOps:a.undoStack.length>0,hasRedoOps:a.redoStack.length>0}):i}},view:r=>{const i=Le.getState(r.state),s=So.getState(r.state).undoManager;return s.on("stack-item-added",({stackItem:o})=>{const l=i.binding;l&&o.meta.set(l,So.getState(r.state).prevSel)}),s.on("stack-item-popped",({stackItem:o})=>{const l=i.binding;l&&(l.beforeTransactionSelection=o.meta.get(l)||l.beforeTransactionSelection)}),{destroy:()=>{s.destroy()}}}}),HA=["br"],Fs=(t,e={})=>(e=Object.assign({},e),t.ychange!==null&&(e.ychange_user=t.ychange.user,e.ychange_state=t.ychange.state),e),$A={doc:{content:"block+"},paragraph:{attrs:{ychange:{default:null}},content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM(t){return["p",Fs(t.attrs),0]}},blockquote:{attrs:{ychange:{default:null}},content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM(t){return["blockquote",Fs(t.attrs),0]}},horizontal_rule:{attrs:{ychange:{default:null}},group:"block",parseDOM:[{tag:"hr"}],toDOM(t){return["hr",Fs(t.attrs)]}},heading:{attrs:{level:{default:1},ychange:{default:null}},content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM(t){return["h"+t.attrs.level,Fs(t.attrs),0]}},code_block:{attrs:{ychange:{default:null}},content:"text*",marks:"",group:"block",code:!0,defining:!0,parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM(t){return["pre",Fs(t.attrs),["code",0]]}},text:{group:"inline"},image:{inline:!0,attrs:{ychange:{default:null},src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs(t){return{src:t.getAttribute("src"),title:t.getAttribute("title"),alt:t.getAttribute("alt")}}}],toDOM(t){const e={src:t.attrs.src,title:t.attrs.title,alt:t.attrs.alt};return["img",Fs(t.attrs,e)]}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM(){return HA}}},WA=["em",0],qA=["strong",0],KA=["code",0],GA={link:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs(t){return{href:t.getAttribute("href"),title:t.getAttribute("title")}}}],toDOM(t){return["a",t.attrs,0]}},em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM(){return WA}},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}],toDOM(){return qA}},code:{parseDOM:[{tag:"code"}],toDOM(){return KA}},ychange:{attrs:{user:{default:null},state:{default:null}},inclusive:!1,parseDOM:[{tag:"ychange"}],toDOM(t){return["ychange",{ychange_user:t.attrs.user,ychange_state:t.attrs.state},0]}}},a1=new iR({nodes:$A,marks:GA});var Bi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Ac={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},JA=typeof navigator<"u"&&/Mac/.test(navigator.platform),YA=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var gt=0;gt<10;gt++)Bi[48+gt]=Bi[96+gt]=String(gt);for(var gt=1;gt<=24;gt++)Bi[gt+111]="F"+gt;for(var gt=65;gt<=90;gt++)Bi[gt]=String.fromCharCode(gt+32),Ac[gt]=String.fromCharCode(gt);for(var Ch in Bi)Ac.hasOwnProperty(Ch)||(Ac[Ch]=Bi[Ch]);function QA(t){var e=JA&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||YA&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?Ac:Bi)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const ZA=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function XA(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,i,s,o;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))s=!0;else if(/^mod$/i.test(a))ZA?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(n="Alt-"+n),i&&(n="Ctrl-"+n),o&&(n="Meta-"+n),s&&(n="Shift-"+n),n}function eN(t){let e=Object.create(null);for(let n in t)e[XA(n)]=t[n];return e}function bh(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function wp(t){return new kr({props:{handleKeyDown:A_(t)}})}function A_(t){let e=eN(t);return function(n,r){let i=QA(r),s,o=e[bh(i,r)];if(o&&o(n.state,n.dispatch,n))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[bh(i,r,!1)];if(l&&l(n.state,n.dispatch,n))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(s=Bi[r.keyCode])&&s!=i){let l=e[bh(s,r)];if(l&&l(n.state,n.dispatch,n))return!0}}return!1}}var Nc=200,ft=function(){};ft.prototype.append=function(e){return e.length?(e=ft.from(e),!this.length&&e||e.length<Nc&&this.leafAppend(e)||this.length<Nc&&e.leafPrepend(this)||this.appendInner(e)):this};ft.prototype.prepend=function(e){return e.length?ft.from(e).append(this):this};ft.prototype.appendInner=function(e){return new tN(this,e)};ft.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?ft.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};ft.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};ft.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};ft.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(s,o){return i.push(e(s,o))},n,r),i};ft.from=function(e){return e instanceof ft?e:e&&e.length?new N_(e):ft.empty};var N_=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,s){return i==0&&s==this.length?this:new e(this.values.slice(i,s))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,s,o,l){for(var a=s;a<o;a++)if(i(this.values[a],l+a)===!1)return!1},e.prototype.forEachInvertedInner=function(i,s,o,l){for(var a=s-1;a>=o;a--)if(i(this.values[a],l+a)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=Nc)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=Nc)return new e(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(ft);ft.empty=new N_([]);var tN=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,s,o){var l=this.left.length;if(i<l&&this.left.forEachInner(r,i,Math.min(s,l),o)===!1||s>l&&this.right.forEachInner(r,Math.max(i-l,0),Math.min(this.length,s)-l,o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,s,o){var l=this.left.length;if(i>l&&this.right.forEachInvertedInner(r,i-l,Math.max(s,l)-l,o+l)===!1||s<l&&this.left.forEachInvertedInner(r,Math.min(i,l),s,o)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(r,i):r>=s?this.right.slice(r-s,i-s):this.left.slice(r,s).append(this.right.slice(0,i-s))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(ft);const nN=500;class Kn{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,s;n&&(i=this.remapping(r,this.items.length),s=i.maps.length);let o=e.tr,l,a,u=[],c=[];return this.items.forEach((f,h)=>{if(!f.step){i||(i=this.remapping(r,h+1),s=i.maps.length),s--,c.push(f);return}if(i){c.push(new ar(f.map));let p=f.step.map(i.slice(s)),m;p&&o.maybeStep(p).doc&&(m=o.mapping.maps[o.mapping.maps.length-1],u.push(new ar(m,void 0,void 0,u.length+c.length))),s--,m&&i.appendMap(m,s)}else o.maybeStep(f.step);if(f.selection)return l=i?f.selection.map(i.slice(s)):f.selection,a=new Kn(this.items.slice(0,r).append(c.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:a,transform:o,selection:l}}addTransform(e,n,r,i){let s=[],o=this.eventCount,l=this.items,a=!i&&l.length?l.get(l.length-1):null;for(let c=0;c<e.steps.length;c++){let f=e.steps[c].invert(e.docs[c]),h=new ar(e.mapping.maps[c],f,n),p;(p=a&&a.merge(h))&&(h=p,c?s.pop():l=l.slice(0,l.length-1)),s.push(h),n&&(o++,n=void 0),i||(a=h)}let u=o-r.depth;return u>iN&&(l=rN(l,u),o-=u),new Kn(l.append(s),o)}remapping(e,n){let r=new go;return this.items.forEach((i,s)=>{let o=i.mirrorOffset!=null&&s-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,o)},e,n),r}addMaps(e){return this.eventCount==0?this:new Kn(this.items.append(e.map(n=>new ar(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-n),s=e.mapping,o=e.steps.length,l=this.eventCount;this.items.forEach(h=>{h.selection&&l--},i);let a=n;this.items.forEach(h=>{let p=s.getMirror(--a);if(p==null)return;o=Math.min(o,p);let m=s.maps[p];if(h.step){let v=e.steps[p].invert(e.docs[p]),C=h.selection&&h.selection.map(s.slice(a+1,p));C&&l++,r.push(new ar(m,v,C))}else r.push(new ar(m))},i);let u=[];for(let h=n;h<o;h++)u.push(new ar(s.maps[h]));let c=this.items.slice(0,i).append(u).append(r),f=new Kn(c,l);return f.emptyItemCount()>nN&&(f=f.compress(this.items.length-r.length)),f}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,i=[],s=0;return this.items.forEach((o,l)=>{if(l>=e)i.push(o),o.selection&&s++;else if(o.step){let a=o.step.map(n.slice(r)),u=a&&a.getMap();if(r--,u&&n.appendMap(u,r),a){let c=o.selection&&o.selection.map(n.slice(r));c&&s++;let f=new ar(u.invert(),a,c),h,p=i.length-1;(h=i.length&&i[p].merge(f))?i[p]=h:i.push(f)}}else o.map&&r--},this.items.length,0),new Kn(ft.from(i.reverse()),s)}}Kn.empty=new Kn(ft.empty,0);function rN(t,e){let n;return t.forEach((r,i)=>{if(r.selection&&e--==0)return n=i,!1}),t.slice(n)}class ar{constructor(e,n,r,i){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new ar(n.getMap().invert(),n,this.selection)}}}class ri{constructor(e,n,r,i,s){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=i,this.prevComposition=s}}const iN=20;function sN(t,e,n,r){let i=n.getMeta(Ti),s;if(i)return i.historyState;n.getMeta(lN)&&(t=new ri(t.done,t.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(o&&o.getMeta(Ti))return o.getMeta(Ti).redo?new ri(t.done.addTransform(n,void 0,r,Du(e)),t.undone,u1(n.mapping.maps[n.steps.length-1]),t.prevTime,t.prevComposition):new ri(t.done,t.undone.addTransform(n,void 0,r,Du(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let l=n.getMeta("composition"),a=t.prevTime==0||!o&&t.prevComposition!=l&&(t.prevTime<(n.time||0)-r.newGroupDelay||!oN(n,t.prevRanges)),u=o?xh(t.prevRanges,n.mapping):u1(n.mapping.maps[n.steps.length-1]);return new ri(t.done.addTransform(n,a?e.selection.getBookmark():void 0,r,Du(e)),Kn.empty,u,n.time,l??t.prevComposition)}else return(s=n.getMeta("rebased"))?new ri(t.done.rebased(n,s),t.undone.rebased(n,s),xh(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new ri(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),xh(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function oN(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,i)=>{for(let s=0;s<e.length;s+=2)r<=e[s+1]&&i>=e[s]&&(n=!0)}),n}function u1(t){let e=[];return t.forEach((n,r,i,s)=>e.push(i,s)),e}function xh(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let i=e.map(t[r],1),s=e.map(t[r+1],-1);i<=s&&n.push(i,s)}return n}function M_(t,e,n,r){let i=Du(e),s=Ti.get(e).spec.config,o=(r?t.undone:t.done).popEvent(e,i);if(!o)return;let l=o.selection.resolve(o.transform.doc),a=(r?t.done:t.undone).addTransform(o.transform,e.selection.getBookmark(),s,i),u=new ri(r?a:o.remaining,r?o.remaining:a,null,0,-1);n(o.transform.setSelection(l).setMeta(Ti,{redo:r,historyState:u}).scrollIntoView())}let Th=!1,c1=null;function Du(t){let e=t.plugins;if(c1!=e){Th=!1,c1=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){Th=!0;break}}return Th}const Ti=new Ra("history"),lN=new Ra("closeHistory");function aN(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new kr({key:Ti,state:{init(){return new ri(Kn.empty,Kn.empty,null,0,-1)},apply(e,n,r){return sN(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,i=r=="historyUndo"?Mc:r=="historyRedo"?ma:null;return i?(n.preventDefault(),i(e.state,e.dispatch)):!1}}}})}const Mc=(t,e)=>{let n=Ti.getState(t);return!n||n.done.eventCount==0?!1:(e&&M_(n,t,e,!1),!0)},ma=(t,e)=>{let n=Ti.getState(t);return!n||n.undone.eventCount==0?!1:(e&&M_(n,t,e,!0),!0)},D_=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function uN(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const cN=(t,e,n)=>{let r=uN(t,n);if(!r)return!1;let i=B_(r);if(!i){let o=r.blockRange(),l=o&&Oa(o);return l==null?!1:(e&&e(t.tr.lift(o,l).scrollIntoView()),!0)}let s=i.nodeBefore;if(!s.type.spec.isolating&&F_(t,i,e))return!0;if(r.parent.content.size==0&&(Do(s,"end")||ne.isSelectable(s))){let o=Qg(t.doc,r.before(),r.after(),J.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=t.tr.step(o);l.setSelection(Do(s,"end")?me.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):ne.create(l.doc,i.pos-s.nodeSize)),e(l.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1};function Do(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const fN=(t,e,n)=>{let{$head:r,empty:i}=t.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;s=B_(r)}let o=s&&s.nodeBefore;return!o||!ne.isSelectable(o)?!1:(e&&e(t.tr.setSelection(ne.create(t.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function B_(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function hN(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const dN=(t,e,n)=>{let r=hN(t,n);if(!r)return!1;let i=P_(r);if(!i)return!1;let s=i.nodeAfter;if(F_(t,i,e))return!0;if(r.parent.content.size==0&&(Do(s,"start")||ne.isSelectable(s))){let o=Qg(t.doc,r.before(),r.after(),J.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=t.tr.step(o);l.setSelection(Do(s,"start")?me.findFrom(l.doc.resolve(l.mapping.map(i.pos)),1):ne.create(l.doc,l.mapping.map(i.pos))),e(l.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},pN=(t,e,n)=>{let{$head:r,empty:i}=t.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;s=P_(r)}let o=s&&s.nodeAfter;return!o||!ne.isSelectable(o)?!1:(e&&e(t.tr.setSelection(ne.create(t.doc,s.pos)).scrollIntoView()),!0)};function P_(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const Sp=(t,e)=>{let n=t.selection,r=n instanceof ne,i;if(r){if(n.node.isTextblock||!$o(t.doc,n.from))return!1;i=n.from}else if(i=Vk(t.doc,n.from,-1),i==null)return!1;if(e){let s=t.tr.join(i);r&&s.setSelection(ne.create(s.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(s.scrollIntoView())}return!0},gN=(t,e)=>{let n=t.selection,r;if(n instanceof ne){if(n.node.isTextblock||!$o(t.doc,n.to))return!1;r=n.to}else if(r=Vk(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},vp=(t,e)=>{let{$from:n,$to:r}=t.selection,i=n.blockRange(r),s=i&&Oa(i);return s==null?!1:(e&&e(t.tr.lift(i,s).scrollIntoView()),!0)},mN=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function fm(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const L_=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),s=n.indexAfter(-1),o=fm(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(e){let l=n.after(),a=t.tr.replaceWith(l,l,o.createAndFill());a.setSelection(me.near(a.doc.resolve(l),1)),e(a.scrollIntoView())}return!0},yN=(t,e)=>{let n=t.selection,{$from:r,$to:i}=n;if(n instanceof pn||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=fm(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let o=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,l=t.tr.insert(o,s.createAndFill());l.setSelection(_e.create(l.doc,o+1)),e(l.scrollIntoView())}return!0},wN=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let s=n.before();if(mo(t.doc,s))return e&&e(t.tr.split(s).scrollIntoView()),!0}let r=n.blockRange(),i=r&&Oa(r);return i==null?!1:(e&&e(t.tr.lift(r,i).scrollIntoView()),!0)};function SN(t){return(e,n)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof ne&&e.selection.node.isBlock)return!r.parentOffset||!mo(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.parent.isBlock)return!1;if(n){let s=i.parentOffset==i.parent.content.size,o=e.tr;(e.selection instanceof _e||e.selection instanceof pn)&&o.deleteSelection();let l=r.depth==0?null:fm(r.node(-1).contentMatchAt(r.indexAfter(-1))),a=t&&t(i.parent,s),u=a?[a]:s&&l?[{type:l}]:void 0,c=mo(o.doc,o.mapping.map(r.pos),1,u);if(!u&&!c&&mo(o.doc,o.mapping.map(r.pos),1,l?[{type:l}]:void 0)&&(l&&(u=[{type:l}]),c=!0),c&&(o.split(o.mapping.map(r.pos),1,u),!s&&!r.parentOffset&&r.parent.type!=l)){let f=o.mapping.map(r.before()),h=o.doc.resolve(f);l&&r.node(-1).canReplaceWith(h.index(),h.index()+1,l)&&o.setNodeMarkup(o.mapping.map(r.before()),l)}n(o.scrollIntoView())}return!0}}const vN=SN(),kp=(t,e)=>{let{$from:n,to:r}=t.selection,i,s=n.sharedDepth(r);return s==0?!1:(i=n.before(s),e&&e(t.tr.setSelection(ne.create(t.doc,i))),!0)},kN=(t,e)=>(e&&e(t.tr.setSelection(new pn(t.doc))),!0);function _N(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,s=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(s-1,s)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(i.isTextblock||$o(t.doc,e.pos))?!1:(n&&n(t.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0)}function F_(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,s,o;if(r.type.spec.isolating||i.type.spec.isolating)return!1;if(_N(t,e,n))return!0;let l=e.parent.canReplace(e.index(),e.index()+1);if(l&&(s=(o=r.contentMatchAt(r.childCount)).findWrapping(i.type))&&o.matchType(s[0]||i.type).validEnd){if(n){let f=e.pos+i.nodeSize,h=H.empty;for(let v=s.length-1;v>=0;v--)h=H.from(s[v].create(null,h));h=H.from(r.copy(h));let p=t.tr.step(new wt(e.pos-1,f,e.pos,f,new J(h,1,0),s.length,!0)),m=f+2*s.length;$o(p.doc,m)&&p.join(m),n(p.scrollIntoView())}return!0}let a=me.findFrom(e,1),u=a&&a.$from.blockRange(a.$to),c=u&&Oa(u);if(c!=null&&c>=e.depth)return n&&n(t.tr.lift(u,c).scrollIntoView()),!0;if(l&&Do(i,"start",!0)&&Do(r,"end")){let f=r,h=[];for(;h.push(f),!f.isTextblock;)f=f.lastChild;let p=i,m=1;for(;!p.isTextblock;p=p.firstChild)m++;if(f.canReplace(f.childCount,f.childCount,p.content)){if(n){let v=H.empty;for(let y=h.length-1;y>=0;y--)v=H.from(h[y].copy(v));let C=t.tr.step(new wt(e.pos-h.length,e.pos+i.nodeSize,e.pos+m,e.pos+i.nodeSize-m,new J(v,h.length,0),0,!0));n(C.scrollIntoView())}return!0}}return!1}function U_(t){return function(e,n){let r=e.selection,i=t<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(n&&n(e.tr.setSelection(_e.create(e.doc,t<0?i.start(s):i.end(s)))),!0):!1}}const EN=U_(-1),CN=U_(1);function _p(t,e=null){return function(n,r){let{$from:i,$to:s}=n.selection,o=i.blockRange(s),l=o&&Yg(o,t,e);return l?(r&&r(n.tr.wrap(o,l).scrollIntoView()),!0):!1}}function Bu(t,e=null){return function(n,r){let i=!1;for(let s=0;s<n.selection.ranges.length&&!i;s++){let{$from:{pos:o},$to:{pos:l}}=n.selection.ranges[s];n.doc.nodesBetween(o,l,(a,u)=>{if(i)return!1;if(!(!a.isTextblock||a.hasMarkup(t,e)))if(a.type==t)i=!0;else{let c=n.doc.resolve(u),f=c.index();i=c.parent.canReplaceWith(f,f+1,t)}})}if(!i)return!1;if(r){let s=n.tr;for(let o=0;o<n.selection.ranges.length;o++){let{$from:{pos:l},$to:{pos:a}}=n.selection.ranges[o];s.setBlockType(l,a,t,e)}r(s.scrollIntoView())}return!0}}function bN(t,e,n){for(let r=0;r<e.length;r++){let{$from:i,$to:s}=e[r],o=i.depth==0?t.inlineContent&&t.type.allowsMarkType(n):!1;if(t.nodesBetween(i.pos,s.pos,l=>{if(o)return!1;o=l.inlineContent&&l.type.allowsMarkType(n)}),o)return!0}return!1}function ai(t,e=null){return function(n,r){let{empty:i,$cursor:s,ranges:o}=n.selection;if(i&&!s||!bN(n.doc,o,t))return!1;if(r)if(s)t.isInSet(n.storedMarks||s.marks())?r(n.tr.removeStoredMark(t)):r(n.tr.addStoredMark(t.create(e)));else{let l=!1,a=n.tr;for(let u=0;!l&&u<o.length;u++){let{$from:c,$to:f}=o[u];l=n.doc.rangeHasMark(c.pos,f.pos,t)}for(let u=0;u<o.length;u++){let{$from:c,$to:f}=o[u];if(l)a.removeMark(c.pos,f.pos,t);else{let h=c.pos,p=f.pos,m=c.nodeAfter,v=f.nodeBefore,C=m&&m.isText?/^\s*/.exec(m.text)[0].length:0,y=v&&v.isText?/\s*$/.exec(v.text)[0].length:0;h+C<p&&(h+=C,p-=y),a.addMark(h,p,t.create(e))}}r(a.scrollIntoView())}return!0}}function mf(...t){return function(e,n,r){for(let i=0;i<t.length;i++)if(t[i](e,n,r))return!0;return!1}}let Ih=mf(D_,cN,fN),f1=mf(D_,dN,pN);const Nr={Enter:mf(mN,yN,wN,vN),"Mod-Enter":L_,Backspace:Ih,"Mod-Backspace":Ih,"Shift-Backspace":Ih,Delete:f1,"Mod-Delete":f1,"Mod-a":kN},z_={"Ctrl-h":Nr.Backspace,"Alt-Backspace":Nr["Mod-Backspace"],"Ctrl-d":Nr.Delete,"Ctrl-Alt-Backspace":Nr["Mod-Delete"],"Alt-Delete":Nr["Mod-Delete"],"Alt-d":Nr["Mod-Delete"],"Ctrl-a":EN,"Ctrl-e":CN};for(let t in Nr)z_[t]=Nr[t];const xN=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1,TN=xN?z_:Nr;function IN(t={}){return new kr({view(e){return new ON(e,t)}})}class ON{constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let s=o=>{this[i](o)};return e.dom.addEventListener(i,s),{name:i,handler:s}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r;if(n){let l=e.nodeBefore,a=e.nodeAfter;if(l||a){let u=this.editorView.nodeDOM(this.cursorPos-(l?l.nodeSize:0));if(u){let c=u.getBoundingClientRect(),f=l?c.bottom:c.top;l&&a&&(f=(f+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),r={left:c.left,right:c.right,top:f-this.width/2,bottom:f+this.width/2}}}}if(!r){let l=this.editorView.coordsAtPos(this.cursorPos);r={left:l.left-this.width/2,right:l.left+this.width/2,top:l.top,bottom:l.bottom}}let i=this.editorView.dom.offsetParent;this.element||(this.element=i.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let s,o;if(!i||i==document.body&&getComputedStyle(i).position=="static")s=-pageXOffset,o=-pageYOffset;else{let l=i.getBoundingClientRect();s=l.left-i.scrollLeft,o=l.top-i.scrollTop}this.element.style.left=r.left-s+"px",this.element.style.top=r.top-o+"px",this.element.style.width=r.right-r.left+"px",this.element.style.height=r.bottom-r.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=r&&r.type.spec.disableDropCursor,s=typeof i=="function"?i(this.editorView,n,e):i;if(n&&!s){let o=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=jk(this.editorView.state.doc,o,this.editorView.dragging.slice);l!=null&&(o=l)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}class $e extends me{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return $e.valid(r)?new $e(r):me.near(r)}content(){return J.empty}eq(e){return e instanceof $e&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new $e(e.resolve(n.pos))}getBookmark(){return new hm(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!RN(e)||!AN(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let i=n.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&$e.valid(e))return e;let i=e.pos,s=null;for(let o=e.depth;;o--){let l=e.node(o);if(n>0?e.indexAfter(o)<l.childCount:e.index(o)>0){s=l.child(n>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;i+=n;let a=e.doc.resolve(i);if($e.valid(a))return a}for(;;){let o=n>0?s.firstChild:s.lastChild;if(!o){if(s.isAtom&&!s.isText&&!ne.isSelectable(s)){e=e.doc.resolve(i+s.nodeSize*n),r=!1;continue e}break}s=o,i+=n;let l=e.doc.resolve(i);if($e.valid(l))return l}return null}}}$e.prototype.visible=!1;$e.findFrom=$e.findGapCursorFrom;me.jsonID("gapcursor",$e);class hm{constructor(e){this.pos=e}map(e){return new hm(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return $e.valid(n)?new $e(n):me.near(n)}}function RN(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function AN(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function NN(){return new kr({props:{decorations:PN,createSelectionBetween(t,e,n){return e.pos==n.pos&&$e.valid(n)?new $e(n):null},handleClick:DN,handleKeyDown:MN,handleDOMEvents:{beforeinput:BN}}})}const MN=A_({ArrowLeft:cu("horiz",-1),ArrowRight:cu("horiz",1),ArrowUp:cu("vert",-1),ArrowDown:cu("vert",1)});function cu(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,s){let o=r.selection,l=e>0?o.$to:o.$from,a=o.empty;if(o instanceof _e){if(!s.endOfTextblock(n)||l.depth==0)return!1;a=!1,l=r.doc.resolve(e>0?l.after():l.before())}let u=$e.findGapCursorFrom(l,e,a);return u?(i&&i(r.tr.setSelection(new $e(u))),!0):!1}}function DN(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!$e.valid(r))return!1;let i=t.posAtCoords({left:n.clientX,top:n.clientY});return i&&i.inside>-1&&ne.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new $e(r))),!0)}function BN(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof $e))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let i=H.empty;for(let o=r.length-1;o>=0;o--)i=H.from(r[o].createAndFill(null,i));let s=t.state.tr.replace(n.pos,n.pos,new J(i,0,0));return s.setSelection(_e.near(s.doc.resolve(n.pos+1))),t.dispatch(s),!1}function PN(t){if(!(t.selection instanceof $e))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Ke.create(t.doc,[en.widget(t.selection.head,e,{key:"gapcursor"})])}function gn(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,n=arguments[1];if(n&&typeof n=="object"&&n.nodeType==null&&!Array.isArray(n)){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var i=n[r];typeof i=="string"?t.setAttribute(r,i):i!=null&&(t[r]=i)}e++}for(;e<arguments.length;e++)V_(t,arguments[e]);return t}function V_(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var n=0;n<e.length;n++)V_(t,e[n]);else throw new RangeError("Unsupported child node: "+e)}const Ol="http://www.w3.org/2000/svg",LN="http://www.w3.org/1999/xlink",Ep="ProseMirror-icon";function FN(t){let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n)|0;return e}function UN(t,e){let n=(t.nodeType==9?t:t.ownerDocument)||document,r=n.createElement("div");if(r.className=Ep,e.path){let{path:i,width:s,height:o}=e,l="pm-icon-"+FN(i).toString(16);n.getElementById(l)||zN(t,l,e);let a=r.appendChild(n.createElementNS(Ol,"svg"));a.style.width=s/o+"em",a.appendChild(n.createElementNS(Ol,"use")).setAttributeNS(LN,"href",/([^#]*)/.exec(n.location.toString())[1]+"#"+l)}else if(e.dom)r.appendChild(e.dom.cloneNode(!0));else{let{text:i,css:s}=e;r.appendChild(n.createElement("span")).textContent=i||"",s&&(r.firstChild.style.cssText=s)}return r}function zN(t,e,n){let[r,i]=t.nodeType==9?[t,t.body]:[t.ownerDocument||document,t],s=r.getElementById(Ep+"-collection");s||(s=r.createElementNS(Ol,"svg"),s.id=Ep+"-collection",s.style.display="none",i.insertBefore(s,i.firstChild));let o=r.createElementNS(Ol,"symbol");o.id=e,o.setAttribute("viewBox","0 0 "+n.width+" "+n.height),o.appendChild(r.createElementNS(Ol,"path")).setAttribute("d",n.path),s.appendChild(o)}const Zt="ProseMirror-menu";class rr{constructor(e){this.spec=e}render(e){let n=this.spec,r=n.render?n.render(e):n.icon?UN(e.root,n.icon):n.label?gn("div",null,ya(e,n.label)):null;if(!r)throw new RangeError("MenuItem without icon or label property");if(n.title){const s=typeof n.title=="function"?n.title(e.state):n.title;r.setAttribute("title",ya(e,s))}n.class&&r.classList.add(n.class),n.css&&(r.style.cssText+=n.css),r.addEventListener("mousedown",s=>{s.preventDefault(),r.classList.contains(Zt+"-disabled")||n.run(e.state,e.dispatch,e,s)});function i(s){if(n.select){let l=n.select(s);if(r.style.display=l?"":"none",!l)return!1}let o=!0;if(n.enable&&(o=n.enable(s)||!1,Cp(r,Zt+"-disabled",!o)),n.active){let l=o&&n.active(s)||!1;Cp(r,Zt+"-active",l)}return!0}return{dom:r,update:i}}}function ya(t,e){return t._props.translate?t._props.translate(e):e}let Rl={time:0,node:null};function j_(t){Rl.time=Date.now(),Rl.node=t.target}function H_(t){return Date.now()-100<Rl.time&&Rl.node&&t.contains(Rl.node)}class h1{constructor(e,n={}){this.options=n,this.options=n||{},this.content=Array.isArray(e)?e:[e]}render(e){let n=$_(this.content,e),r=e.dom.ownerDocument.defaultView||window,i=gn("div",{class:Zt+"-dropdown "+(this.options.class||""),style:this.options.css},ya(e,this.options.label||""));this.options.title&&i.setAttribute("title",ya(e,this.options.title));let s=gn("div",{class:Zt+"-dropdown-wrap"},i),o=null,l=null,a=()=>{o&&o.close()&&(o=null,r.removeEventListener("mousedown",l))};i.addEventListener("mousedown",c=>{c.preventDefault(),j_(c),o?a():(o=this.expand(s,n.dom),r.addEventListener("mousedown",l=()=>{H_(s)||a()}))});function u(c){let f=n.update(c);return s.style.display=f?"":"none",f}return{dom:s,update:u}}expand(e,n){let r=gn("div",{class:Zt+"-dropdown-menu "+(this.options.class||"")},n),i=!1;function s(){return i?!1:(i=!0,e.removeChild(r),!0)}return e.appendChild(r),{close:s,node:r}}}function $_(t,e){let n=[],r=[];for(let i=0;i<t.length;i++){let{dom:s,update:o}=t[i].render(e);n.push(gn("div",{class:Zt+"-dropdown-item"},s)),r.push(o)}return{dom:n,update:W_(r,n)}}function W_(t,e){return n=>{let r=!1;for(let i=0;i<t.length;i++){let s=t[i](n);e[i].style.display=s?"":"none",s&&(r=!0)}return r}}class VN{constructor(e,n={}){this.options=n,this.content=Array.isArray(e)?e:[e]}render(e){let n=$_(this.content,e),r=e.dom.ownerDocument.defaultView||window,i=gn("div",{class:Zt+"-submenu-label"},ya(e,this.options.label||"")),s=gn("div",{class:Zt+"-submenu-wrap"},i,gn("div",{class:Zt+"-submenu"},n.dom)),o=null;i.addEventListener("mousedown",a=>{a.preventDefault(),j_(a),Cp(s,Zt+"-submenu-wrap-active",!1),o||r.addEventListener("mousedown",o=()=>{H_(s)||(s.classList.remove(Zt+"-submenu-wrap-active"),r.removeEventListener("mousedown",o),o=null)})});function l(a){let u=n.update(a);return s.style.display=u?"":"none",u}return{dom:s,update:l}}}function jN(t,e){let n=document.createDocumentFragment(),r=[],i=[];for(let o=0;o<e.length;o++){let l=e[o],a=[],u=[];for(let c=0;c<l.length;c++){let{dom:f,update:h}=l[c].render(t),p=gn("span",{class:Zt+"item"},f);n.appendChild(p),u.push(p),a.push(h)}a.length&&(r.push(W_(a,u)),o<e.length-1&&i.push(n.appendChild(HN())))}function s(o){let l=!1,a=!1;for(let u=0;u<r.length;u++){let c=r[u](o);u&&(i[u-1].style.display=a&&c?"":"none"),a=c,c&&(l=!0)}return l}return{dom:n,update:s}}function HN(){return gn("span",{class:Zt+"separator"})}const xn={join:{width:800,height:900,path:"M0 75h800v125h-800z M0 825h800v-125h-800z M250 400h100v-100h100v100h100v100h-100v100h-100v-100h-100z"},lift:{width:1024,height:1024,path:"M219 310v329q0 7-5 12t-12 5q-8 0-13-5l-164-164q-5-5-5-13t5-13l164-164q5-5 13-5 7 0 12 5t5 12zM1024 749v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12zM1024 530v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 310v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 91v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12z"},selectParentNode:{text:"",css:"font-weight: bold"},undo:{width:1024,height:1024,path:"M761 1024c113-206 132-520-313-509v253l-384-384 384-384v248c534-13 594 472 313 775z"},redo:{width:1024,height:1024,path:"M576 248v-248l384 384-384 384v-253c-446-10-427 303-313 509-280-303-221-789 313-775z"},strong:{width:805,height:1024,path:"M317 869q42 18 80 18 214 0 214-191 0-65-23-102-15-25-35-42t-38-26-46-14-48-6-54-1q-41 0-57 5 0 30-0 90t-0 90q0 4-0 38t-0 55 2 47 6 38zM309 442q24 4 62 4 46 0 81-7t62-25 42-51 14-81q0-40-16-70t-45-46-61-24-70-8q-28 0-74 7 0 28 2 86t2 86q0 15-0 45t-0 45q0 26 0 39zM0 950l1-53q8-2 48-9t60-15q4-6 7-15t4-19 3-18 1-21 0-19v-37q0-561-12-585-2-4-12-8t-25-6-28-4-27-2-17-1l-2-47q56-1 194-6t213-5q13 0 39 0t38 0q40 0 78 7t73 24 61 40 42 59 16 78q0 29-9 54t-22 41-36 32-41 25-48 22q88 20 146 76t58 141q0 57-20 102t-53 74-78 48-93 27-100 8q-25 0-75-1t-75-1q-60 0-175 6t-132 6z"},em:{width:585,height:1024,path:"M0 949l9-48q3-1 46-12t63-21q16-20 23-57 0-4 35-165t65-310 29-169v-14q-13-7-31-10t-39-4-33-3l10-58q18 1 68 3t85 4 68 1q27 0 56-1t69-4 56-3q-2 22-10 50-17 5-58 16t-62 19q-4 10-8 24t-5 22-4 26-3 24q-15 84-50 239t-44 203q-1 5-7 33t-11 51-9 47-3 32l0 10q9 2 105 17-1 25-9 56-6 0-18 0t-18 0q-16 0-49-5t-49-5q-78-1-117-1-29 0-81 5t-69 6z"},code:{width:896,height:1024,path:"M608 192l-96 96 224 224-224 224 96 96 288-320-288-320zM288 192l-288 320 288 320 96-96-224-224 224-224-96-96z"},link:{width:951,height:1024,path:"M832 694q0-22-16-38l-118-118q-16-16-38-16-24 0-41 18 1 1 10 10t12 12 8 10 7 14 2 15q0 22-16 38t-38 16q-8 0-15-2t-14-7-10-8-12-12-10-10q-18 17-18 41 0 22 16 38l117 118q15 15 38 15 22 0 38-14l84-83q16-16 16-38zM430 292q0-22-16-38l-117-118q-16-16-38-16-22 0-38 15l-84 83q-16 16-16 38 0 22 16 38l118 118q15 15 38 15 24 0 41-17-1-1-10-10t-12-12-8-10-7-14-2-15q0-22 16-38t38-16q8 0 15 2t14 7 10 8 12 12 10 10q18-17 18-41zM941 694q0 68-48 116l-84 83q-47 47-116 47-69 0-116-48l-117-118q-47-47-47-116 0-70 50-119l-50-50q-49 50-118 50-68 0-116-48l-118-118q-48-48-48-116t48-116l84-83q47-47 116-47 69 0 116 48l117 118q47 47 47 116 0 70-50 119l50 50q49-50 118-50 68 0 116 48l118 118q48 48 48 116z"},bulletList:{width:768,height:896,path:"M0 512h128v-128h-128v128zM0 256h128v-128h-128v128zM0 768h128v-128h-128v128zM256 512h512v-128h-512v128zM256 256h512v-128h-512v128zM256 768h512v-128h-512v128z"},orderedList:{width:768,height:896,path:"M320 512h448v-128h-448v128zM320 768h448v-128h-448v128zM320 128v128h448v-128h-448zM79 384h78v-256h-36l-85 23v50l43-2v185zM189 590c0-36-12-78-96-78-33 0-64 6-83 16l1 66c21-10 42-15 67-15s32 11 32 28c0 26-30 58-110 112v50h192v-67l-91 2c49-30 87-66 87-113l1-1z"},blockquote:{width:640,height:896,path:"M0 448v256h256v-256h-128c0 0 0-128 128-128v-128c0 0-256 0-256 256zM640 320v-128c0 0-256 0-256 256v256h256v-256h-128c0 0 0-128 128-128z"}},$N=new rr({title:"Join with above block",run:Sp,select:t=>Sp(t),icon:xn.join}),WN=new rr({title:"Lift out of enclosing block",run:vp,select:t=>vp(t),icon:xn.lift}),qN=new rr({title:"Select parent node",run:kp,select:t=>kp(t),icon:xn.selectParentNode});let KN=new rr({title:"Undo last change",run:Mc,enable:t=>Mc(t),icon:xn.undo}),GN=new rr({title:"Redo last undone change",run:ma,enable:t=>ma(t),icon:xn.redo});function JN(t,e){let n={run(r,i){return _p(t,e.attrs)(r,i)},select(r){return _p(t,e.attrs)(r)}};for(let r in e)n[r]=e[r];return new rr(n)}function Oh(t,e){let n=Bu(t,e.attrs),r={run:n,enable(i){return n(i)},active(i){let{$from:s,to:o,node:l}=i.selection;return l?l.hasMarkup(t,e.attrs):o<=s.end()&&s.parent.hasMarkup(t,e.attrs)}};for(let i in e)r[i]=e[i];return new rr(r)}function Cp(t,e,n){n?t.classList.add(e):t.classList.remove(e)}const fu="ProseMirror-menubar";function YN(){if(typeof navigator>"u")return!1;let t=navigator.userAgent;return!/Edge\/\d/.test(t)&&/AppleWebKit/.test(t)&&/Mobile\/\w+/.test(t)}function QN(t){return new kr({view(e){return new ZN(e,t)}})}class ZN{constructor(e,n){this.editorView=e,this.options=n,this.spacer=null,this.maxHeight=0,this.widthForMaxHeight=0,this.floating=!1,this.scrollHandler=null,this.wrapper=gn("div",{class:fu+"-wrapper"}),this.menu=this.wrapper.appendChild(gn("div",{class:fu})),this.menu.className=fu,e.dom.parentNode&&e.dom.parentNode.replaceChild(this.wrapper,e.dom),this.wrapper.appendChild(e.dom);let{dom:r,update:i}=jN(this.editorView,this.options.content);if(this.contentUpdate=i,this.menu.appendChild(r),this.update(),n.floating&&!YN()){this.updateFloat();let s=tM(this.wrapper);this.scrollHandler=o=>{let l=this.editorView.root;(l.body||l).contains(this.wrapper)?this.updateFloat(o.target.getBoundingClientRect?o.target:void 0):s.forEach(a=>a.removeEventListener("scroll",this.scrollHandler))},s.forEach(o=>o.addEventListener("scroll",this.scrollHandler))}}update(){this.contentUpdate(this.editorView.state),this.floating?this.updateScrollCursor():(this.menu.offsetWidth!=this.widthForMaxHeight&&(this.widthForMaxHeight=this.menu.offsetWidth,this.maxHeight=0),this.menu.offsetHeight>this.maxHeight&&(this.maxHeight=this.menu.offsetHeight,this.menu.style.minHeight=this.maxHeight+"px"))}updateScrollCursor(){let e=this.editorView.root.getSelection();if(!e.focusNode)return;let n=e.getRangeAt(0).getClientRects(),r=n[XN(e)?0:n.length-1];if(!r)return;let i=this.menu.getBoundingClientRect();if(r.top<i.bottom&&r.bottom>i.top){let s=eM(this.wrapper);s&&(s.scrollTop-=i.bottom-r.top)}}updateFloat(e){let n=this.wrapper,r=n.getBoundingClientRect(),i=e?Math.max(0,e.getBoundingClientRect().top):0;if(this.floating)if(r.top>=i||r.bottom<this.menu.offsetHeight+10)this.floating=!1,this.menu.style.position=this.menu.style.left=this.menu.style.top=this.menu.style.width="",this.menu.style.display="",this.spacer.parentNode.removeChild(this.spacer),this.spacer=null;else{let s=(n.offsetWidth-n.clientWidth)/2;this.menu.style.left=r.left+s+"px",this.menu.style.display=r.top>(this.editorView.dom.ownerDocument.defaultView||window).innerHeight?"none":"",e&&(this.menu.style.top=i+"px")}else if(r.top<i&&r.bottom>=this.menu.offsetHeight+10){this.floating=!0;let s=this.menu.getBoundingClientRect();this.menu.style.left=s.left+"px",this.menu.style.width=s.width+"px",e&&(this.menu.style.top=i+"px"),this.menu.style.position="fixed",this.spacer=gn("div",{class:fu+"-spacer",style:`height: ${s.height}px`}),n.insertBefore(this.spacer,this.menu)}}destroy(){this.wrapper.parentNode&&this.wrapper.parentNode.replaceChild(this.editorView.dom,this.wrapper)}}function XN(t){return t.anchorNode==t.focusNode?t.anchorOffset>t.focusOffset:t.anchorNode.compareDocumentPosition(t.focusNode)==Node.DOCUMENT_POSITION_FOLLOWING}function eM(t){for(let e=t.parentNode;e;e=e.parentNode)if(e.scrollHeight>e.clientHeight)return e}function tM(t){let e=[t.ownerDocument.defaultView||window];for(let n=t.parentNode;n;n=n.parentNode)e.push(n);return e}function bp(t,e=null){return function(n,r){let{$from:i,$to:s}=n.selection,o=i.blockRange(s),l=!1,a=o;if(!o)return!1;if(o.depth>=2&&i.node(o.depth-1).type.compatibleContent(t)&&o.startIndex==0){if(i.index(o.depth-1)==0)return!1;let c=n.doc.resolve(o.start-2);a=new vc(c,c,o.depth),o.endIndex<o.parent.childCount&&(o=new vc(i,n.doc.resolve(s.end(o.depth)),o.depth)),l=!0}let u=Yg(a,t,e,o);return u?(r&&r(nM(n.tr,o,u,l,t).scrollIntoView()),!0):!1}}function nM(t,e,n,r,i){let s=H.empty;for(let c=n.length-1;c>=0;c--)s=H.from(n[c].type.create(n[c].attrs,s));t.step(new wt(e.start-(r?2:0),e.end,e.start,e.end,new J(s,0,0),n.length,!0));let o=0;for(let c=0;c<n.length;c++)n[c].type==i&&(o=c+1);let l=n.length-o,a=e.start+n.length-(r?2:0),u=e.parent;for(let c=e.startIndex,f=e.endIndex,h=!0;c<f;c++,h=!1)!h&&mo(t.doc,a,l)&&(t.split(a,l),a+=2*l),a+=u.child(c).nodeSize;return t}function rM(t,e){return function(n,r){let{$from:i,$to:s,node:o}=n.selection;if(o&&o.isBlock||i.depth<2||!i.sameParent(s))return!1;let l=i.node(-1);if(l.type!=t)return!1;if(i.parent.content.size==0&&i.node(-1).childCount==i.indexAfter(-1)){if(i.depth==3||i.node(-3).type!=t||i.index(-2)!=i.node(-2).childCount-1)return!1;if(r){let f=H.empty,h=i.index(-1)?1:i.index(-2)?2:3;for(let y=i.depth-h;y>=i.depth-3;y--)f=H.from(i.node(y).copy(f));let p=i.indexAfter(-1)<i.node(-2).childCount?1:i.indexAfter(-2)<i.node(-3).childCount?2:3;f=f.append(H.from(t.createAndFill()));let m=i.before(i.depth-(h-1)),v=n.tr.replace(m,i.after(-p),new J(f,4-h,0)),C=-1;v.doc.nodesBetween(m,v.doc.content.size,(y,_)=>{if(C>-1)return!1;y.isTextblock&&y.content.size==0&&(C=_+1)}),C>-1&&v.setSelection(me.near(v.doc.resolve(C))),r(v.scrollIntoView())}return!0}let a=s.pos==i.end()?l.contentMatchAt(0).defaultType:null,u=n.tr.delete(i.pos,s.pos),c=a?[e?{type:t,attrs:e}:null,{type:a}]:void 0;return mo(u.doc,i.pos,2,c)?(r&&r(u.split(i.pos,2,c).scrollIntoView()),!0):!1}}function iM(t){return function(e,n){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,o=>o.childCount>0&&o.firstChild.type==t);return s?n?r.node(s.depth-1).type==t?sM(e,n,t,s):oM(e,n,s):!0:!1}}function sM(t,e,n,r){let i=t.tr,s=r.end,o=r.$to.end(r.depth);s<o&&(i.step(new wt(s-1,o,s,o,new J(H.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new vc(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));const l=Oa(r);if(l==null)return!1;i.lift(r,l);let a=i.mapping.map(s,-1)-1;return $o(i.doc,a)&&i.join(a),e(i.scrollIntoView()),!0}function oM(t,e,n){let r=t.tr,i=n.parent;for(let p=n.end,m=n.endIndex-1,v=n.startIndex;m>v;m--)p-=i.child(m).nodeSize,r.delete(p-1,p+1);let s=r.doc.resolve(n.start),o=s.nodeAfter;if(r.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let l=n.startIndex==0,a=n.endIndex==i.childCount,u=s.node(-1),c=s.index(-1);if(!u.canReplace(c+(l?0:1),c+1,o.content.append(a?H.empty:H.from(i))))return!1;let f=s.pos,h=f+o.nodeSize;return r.step(new wt(f-(l?1:0),h+(a?1:0),f+1,h-1,new J((l?H.empty:H.from(i.copy(H.empty))).append(a?H.empty:H.from(i.copy(H.empty))),l?0:1,a?0:1),l?0:1)),e(r.scrollIntoView()),!0}function lM(t){return function(e,n){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,u=>u.childCount>0&&u.firstChild.type==t);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let l=s.parent,a=l.child(o-1);if(a.type!=t)return!1;if(n){let u=a.lastChild&&a.lastChild.type==l.type,c=H.from(u?t.create():null),f=new J(H.from(t.create(null,H.from(l.type.create(null,c)))),u?3:1,0),h=s.start,p=s.end;n(e.tr.step(new wt(h-(u?3:1),p,h,p,f,1,!0)).scrollIntoView())}return!0}}class Vi{constructor(e,n,r={}){this.match=e,this.match=e,this.handler=typeof n=="string"?aM(n):n,this.undoable=r.undoable!==!1,this.inCode=r.inCode||!1}}function aM(t){return function(e,n,r,i){let s=t;if(n[1]){let o=n[0].lastIndexOf(n[1]);s+=n[0].slice(o+n[1].length),r+=o;let l=r-i;l>0&&(s=n[0].slice(o-l,o)+s,r=i)}return e.tr.insertText(s,r,i)}}const uM=500;function cM({rules:t}){let e=new kr({state:{init(){return null},apply(n,r){let i=n.getMeta(this);return i||(n.selectionSet||n.docChanged?null:r)}},props:{handleTextInput(n,r,i,s){return d1(n,r,i,s,t,e)},handleDOMEvents:{compositionend:n=>{setTimeout(()=>{let{$cursor:r}=n.state.selection;r&&d1(n,r.pos,r.pos,"",t,e)})}}},isInputRules:!0});return e}function d1(t,e,n,r,i,s){if(t.composing)return!1;let o=t.state,l=o.doc.resolve(e),a=l.parent.textBetween(Math.max(0,l.parentOffset-uM),l.parentOffset,null,"")+r;for(let u=0;u<i.length;u++){let c=i[u];if(l.parent.type.spec.code){if(!c.inCode)continue}else if(c.inCode==="only")continue;let f=c.match.exec(a),h=f&&c.handler(o,f,e-(f[0].length-r.length),n);if(h)return c.undoable&&h.setMeta(s,{transform:h,from:e,to:n,text:r}),t.dispatch(h),!0}return!1}const fM=(t,e)=>{let n=t.plugins;for(let r=0;r<n.length;r++){let i=n[r],s;if(i.spec.isInputRules&&(s=i.getState(t))){if(e){let o=t.tr,l=s.transform;for(let a=l.steps.length-1;a>=0;a--)o.step(l.steps[a].invert(l.docs[a]));if(s.text){let a=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,t.schema.text(s.text,a))}else o.delete(s.from,s.to);e(o)}return!0}}return!1},hM=new Vi(/--$/,""),dM=new Vi(/\.\.\.$/,""),pM=new Vi(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,""),gM=new Vi(/"$/,""),mM=new Vi(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,""),yM=new Vi(/'$/,""),wM=[pM,gM,mM,yM];function dm(t,e,n=null,r){return new Vi(t,(i,s,o,l)=>{let a=n instanceof Function?n(s):n,u=i.tr.delete(o,l),c=u.doc.resolve(o),f=c.blockRange(),h=f&&Yg(f,e,a);if(!h)return null;u.wrap(f,h);let p=u.doc.resolve(o-1).nodeBefore;return p&&p.type==e&&$o(u.doc,o-1)&&(!r||r(s,p))&&u.join(o-1),u})}function q_(t,e,n=null){return new Vi(t,(r,i,s,o)=>{let l=r.doc.resolve(s),a=n instanceof Function?n(i):n;return l.node(-1).canReplaceWith(l.index(-1),l.indexAfter(-1),e)?r.tr.delete(s,o).setBlockType(s,s,e,a):null})}const hu="ProseMirror-prompt";function K_(t){let e=document.body.appendChild(document.createElement("div"));e.className=hu;let n=h=>{e.contains(h.target)||r()};setTimeout(()=>window.addEventListener("mousedown",n),50);let r=()=>{window.removeEventListener("mousedown",n),e.parentNode&&e.parentNode.removeChild(e)},i=[];for(let h in t.fields)i.push(t.fields[h].render());let s=document.createElement("button");s.type="submit",s.className=hu+"-submit",s.textContent="OK";let o=document.createElement("button");o.type="button",o.className=hu+"-cancel",o.textContent="Cancel",o.addEventListener("click",r);let l=e.appendChild(document.createElement("form"));t.title&&(l.appendChild(document.createElement("h5")).textContent=t.title),i.forEach(h=>{l.appendChild(document.createElement("div")).appendChild(h)});let a=l.appendChild(document.createElement("div"));a.className=hu+"-buttons",a.appendChild(s),a.appendChild(document.createTextNode(" ")),a.appendChild(o);let u=e.getBoundingClientRect();e.style.top=(window.innerHeight-u.height)/2+"px",e.style.left=(window.innerWidth-u.width)/2+"px";let c=()=>{let h=SM(t.fields,i);h&&(r(),t.callback(h))};l.addEventListener("submit",h=>{h.preventDefault(),c()}),l.addEventListener("keydown",h=>{h.keyCode==27?(h.preventDefault(),r()):h.keyCode==13&&!(h.ctrlKey||h.metaKey||h.shiftKey)?(h.preventDefault(),c()):h.keyCode==9&&window.setTimeout(()=>{e.contains(document.activeElement)||r()},500)});let f=l.elements[0];f&&f.focus()}function SM(t,e){let n=Object.create(null),r=0;for(let i in t){let s=t[i],o=e[r++],l=s.read(o),a=s.validate(l);if(a)return vM(o,a),null;n[i]=s.clean(l)}return n}function vM(t,e){let n=t.parentNode,r=n.appendChild(document.createElement("div"));r.style.left=t.offsetLeft+t.offsetWidth+2+"px",r.style.top=t.offsetTop-5+"px",r.className="ProseMirror-invalid",r.textContent=e,setTimeout(()=>n.removeChild(r),1500)}class kM{constructor(e){this.options=e}read(e){return e.value}validateType(e){return null}validate(e){return!e&&this.options.required?"Required field":this.validateType(e)||(this.options.validate?this.options.validate(e):null)}clean(e){return this.options.clean?this.options.clean(e):e}}class Al extends kM{render(){let e=document.createElement("input");return e.type="text",e.placeholder=this.options.label,e.value=this.options.value||"",e.autocomplete="off",e}}function G_(t,e){let n=t.selection.$from;for(let r=n.depth;r>=0;r--){let i=n.index(r);if(n.node(r).canReplaceWith(i,i,e))return!0}return!1}function _M(t){return new rr({title:"Insert image",label:"Image",enable(e){return G_(e,t)},run(e,n,r){let{from:i,to:s}=e.selection,o=null;e.selection instanceof ne&&e.selection.node.type==t&&(o=e.selection.node.attrs),K_({title:"Insert image",fields:{src:new Al({label:"Location",required:!0,value:o&&o.src}),title:new Al({label:"Title",value:o&&o.title}),alt:new Al({label:"Description",value:o?o.alt:e.doc.textBetween(i,s," ")})},callback(l){r.dispatch(r.state.tr.replaceSelectionWith(t.createAndFill(l))),r.focus()}})}})}function J_(t,e){let n={label:e.title,run:t};for(let r in e)n[r]=e[r];return!e.enable&&!e.select&&(n[e.enable?"enable":"select"]=r=>t(r)),new rr(n)}function xp(t,e){let{from:n,$from:r,to:i,empty:s}=t.selection;return s?!!e.isInSet(t.storedMarks||r.marks()):t.doc.rangeHasMark(n,i,e)}function Rh(t,e){let n={active(r){return xp(r,t)}};for(let r in e)n[r]=e[r];return J_(ai(t),n)}function EM(t){return new rr({title:"Add or remove link",icon:xn.link,active(e){return xp(e,t)},enable(e){return!e.selection.empty},run(e,n,r){if(xp(e,t))return ai(t)(e,n),!0;K_({title:"Create a link",fields:{href:new Al({label:"Link target",required:!0}),title:new Al({label:"Title"})},callback(i){ai(t,i)(r.state,r.dispatch),r.focus()}})}})}function p1(t,e){return J_(bp(t,e.attrs),e)}function CM(t){let e={},n;(n=t.marks.strong)&&(e.toggleStrong=Rh(n,{title:"Toggle strong style",icon:xn.strong})),(n=t.marks.em)&&(e.toggleEm=Rh(n,{title:"Toggle emphasis",icon:xn.em})),(n=t.marks.code)&&(e.toggleCode=Rh(n,{title:"Toggle code font",icon:xn.code})),(n=t.marks.link)&&(e.toggleLink=EM(n));let r;if((r=t.nodes.image)&&(e.insertImage=_M(r)),(r=t.nodes.bullet_list)&&(e.wrapBulletList=p1(r,{title:"Wrap in bullet list",icon:xn.bulletList})),(r=t.nodes.ordered_list)&&(e.wrapOrderedList=p1(r,{title:"Wrap in ordered list",icon:xn.orderedList})),(r=t.nodes.blockquote)&&(e.wrapBlockQuote=JN(r,{title:"Wrap in block quote",icon:xn.blockquote})),(r=t.nodes.paragraph)&&(e.makeParagraph=Oh(r,{title:"Change to paragraph",label:"Plain"})),(r=t.nodes.code_block)&&(e.makeCodeBlock=Oh(r,{title:"Change to code block",label:"Code"})),r=t.nodes.heading)for(let s=1;s<=10;s++)e["makeHead"+s]=Oh(r,{title:"Change to heading "+s,label:"Level "+s,attrs:{level:s}});if(r=t.nodes.horizontal_rule){let s=r;e.insertHorizontalRule=new rr({title:"Insert horizontal rule",label:"Horizontal rule",enable(o){return G_(o,s)},run(o,l){l(o.tr.replaceSelectionWith(s.create()))}})}let i=s=>s.filter(o=>o);return e.insertMenu=new h1(i([e.insertImage,e.insertHorizontalRule]),{label:"Insert"}),e.typeMenu=new h1(i([e.makeParagraph,e.makeCodeBlock,e.makeHead1&&new VN(i([e.makeHead1,e.makeHead2,e.makeHead3,e.makeHead4,e.makeHead5,e.makeHead6]),{label:"Heading"})]),{label:"Type..."}),e.inlineMenu=[i([e.toggleStrong,e.toggleEm,e.toggleCode,e.toggleLink])],e.blockMenu=[i([e.wrapBulletList,e.wrapOrderedList,e.wrapBlockQuote,$N,WN,qN])],e.fullMenu=e.inlineMenu.concat([[e.insertMenu,e.typeMenu]],[[KN,GN]],e.blockMenu),e}const g1=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function bM(t,e){let n={},r;function i(s,o){if(e){let l=e[s];if(l===!1)return;l&&(s=l)}n[s]=o}if(i("Mod-z",Mc),i("Shift-Mod-z",ma),i("Backspace",fM),g1||i("Mod-y",ma),i("Alt-ArrowUp",Sp),i("Alt-ArrowDown",gN),i("Mod-BracketLeft",vp),i("Escape",kp),(r=t.marks.strong)&&(i("Mod-b",ai(r)),i("Mod-B",ai(r))),(r=t.marks.em)&&(i("Mod-i",ai(r)),i("Mod-I",ai(r))),(r=t.marks.code)&&i("Mod-`",ai(r)),(r=t.nodes.bullet_list)&&i("Shift-Ctrl-8",bp(r)),(r=t.nodes.ordered_list)&&i("Shift-Ctrl-9",bp(r)),(r=t.nodes.blockquote)&&i("Ctrl->",_p(r)),r=t.nodes.hard_break){let s=r,o=mf(L_,(l,a)=>(a&&a(l.tr.replaceSelectionWith(s.create()).scrollIntoView()),!0));i("Mod-Enter",o),i("Shift-Enter",o),g1&&i("Ctrl-Enter",o)}if((r=t.nodes.list_item)&&(i("Enter",rM(r)),i("Mod-[",iM(r)),i("Mod-]",lM(r))),(r=t.nodes.paragraph)&&i("Shift-Ctrl-0",Bu(r)),(r=t.nodes.code_block)&&i("Shift-Ctrl-\\",Bu(r)),r=t.nodes.heading)for(let s=1;s<=6;s++)i("Shift-Ctrl-"+s,Bu(r,{level:s}));if(r=t.nodes.horizontal_rule){let s=r;i("Mod-_",(o,l)=>(l&&l(o.tr.replaceSelectionWith(s.create()).scrollIntoView()),!0))}return n}function xM(t){return dm(/^\s*>\s$/,t)}function TM(t){return dm(/^(\d+)\.\s$/,t,e=>({order:+e[1]}),(e,n)=>n.childCount+n.attrs.order==+e[1])}function IM(t){return dm(/^\s*([-+*])\s$/,t)}function OM(t){return q_(/^```$/,t)}function RM(t,e){return q_(new RegExp("^(#{1,"+e+"})\\s$"),t,n=>({level:n[1].length}))}function AM(t){let e=wM.concat(dM,hM),n;return(n=t.nodes.blockquote)&&e.push(xM(n)),(n=t.nodes.ordered_list)&&e.push(TM(n)),(n=t.nodes.bullet_list)&&e.push(IM(n)),(n=t.nodes.code_block)&&e.push(OM(n)),(n=t.nodes.heading)&&e.push(RM(n,6)),cM({rules:e})}function NM(t){let e=[AM(t.schema),wp(bM(t.schema,t.mapKeys)),wp(TN),IN(),NN()];return t.menuBar!==!1&&e.push(QN({floating:t.floatingMenu!==!1,content:t.menuContent||CM(t.schema).fullMenu})),t.history!==!1&&e.push(aN()),e.concat(new kr({props:{attributes:{class:"ProseMirror-example-setup-style"}}}))}/* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
*
* @author   Jimmy Wrting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
* @license  MIT
*/const Dc="0123456789abcdef",Y_=[],Bc=[];for(let t=0;t<256;t++)Y_[t]=Dc[t>>4&15]+Dc[t&15],t<16&&(t<10?Bc[48+t]=t:Bc[87+t]=t);const pm=t=>{const e=t.length;let n="",r=0;for(;r<e;)n+=Y_[t[r++]];return n},Q_=t=>{const e=t.length>>1,n=e<<1,r=new Uint8Array(e);let i=0,s=0;for(;s<n;)r[i++]=Bc[t.charCodeAt(s++)]<<4|Bc[t.charCodeAt(s++)];return r};var io="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",MM=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var du=0;du<io.length;du++)MM[io.charCodeAt(du)]=du;var DM=function(t){var e=new Uint8Array(t),n,r=e.length,i="";for(n=0;n<r;n+=3)i+=io[e[n]>>2],i+=io[(e[n]&3)<<4|e[n+1]>>4],i+=io[(e[n+1]&15)<<2|e[n+2]>>6],i+=io[e[n+2]&63];return r%3===2?i=i.substring(0,i.length-1)+"=":r%3===1&&(i=i.substring(0,i.length-2)+"=="),i};const BM=new TextDecoder,PM=(t,e)=>e?new TextDecoder(e).decode(t):BM.decode(t),LM=new TextEncoder,FM=t=>LM.encode(t),UM=t=>DM(t),Us=t=>{let e="",n,r=0;const i=t.length;for(;r<i;)n=t.charCodeAt(r++),e+=Dc[n>>4]+Dc[n&15];return e},m1=65536,Nl=t=>{const e=Q_(t);if(e.length<=m1)return String.fromCharCode(...e);let n="",r=0;for(;r<e.length;)n+=String.fromCharCode(...e.subarray(r,r+=m1));return n},y1=typeof window<"u"?window:self,Tp=y1.crypto||y1.msCrypto||{},w1=Tp.subtle||Tp.webkitSubtle,zM={hex:pm,base64:UM},VM=async(t,e,n="sha-1")=>{if(!w1)throw new Error("no web crypto support");typeof t=="string"&&(t=FM(t));const r=new Uint8Array(await w1.digest(n,t));return e?zM[e](r):r},Z_=t=>{const e=new Uint8Array(t);return Tp.getRandomValues(e)};var X_={exports:{}};(function(t){var e=function(){function n(h,p){return p!=null&&h instanceof p}var r;try{r=Map}catch{r=function(){}}var i;try{i=Set}catch{i=function(){}}var s;try{s=Promise}catch{s=function(){}}function o(h,p,m,v,C){typeof p=="object"&&(m=p.depth,v=p.prototype,C=p.includeNonEnumerable,p=p.circular);var y=[],_=[],x=typeof Buffer<"u";typeof p>"u"&&(p=!0),typeof m>"u"&&(m=1/0);function O(R,P){if(R===null)return null;if(P===0)return R;var F,V;if(typeof R!="object")return R;if(n(R,r))F=new r;else if(n(R,i))F=new i;else if(n(R,s))F=new s(function(qe,K){R.then(function(te){qe(O(te,P-1))},function(te){K(O(te,P-1))})});else if(o.__isArray(R))F=[];else if(o.__isRegExp(R))F=new RegExp(R.source,f(R)),R.lastIndex&&(F.lastIndex=R.lastIndex);else if(o.__isDate(R))F=new Date(R.getTime());else{if(x&&Buffer.isBuffer(R))return Buffer.allocUnsafe?F=Buffer.allocUnsafe(R.length):F=new Buffer(R.length),R.copy(F),F;n(R,Error)?F=Object.create(R):typeof v>"u"?(V=Object.getPrototypeOf(R),F=Object.create(V)):(F=Object.create(v),V=v)}if(p){var z=y.indexOf(R);if(z!=-1)return _[z];y.push(R),_.push(F)}n(R,r)&&R.forEach(function(qe,K){var te=O(K,P-1),re=O(qe,P-1);F.set(te,re)}),n(R,i)&&R.forEach(function(qe){var K=O(qe,P-1);F.add(K)});for(var Q in R){var ye;V&&(ye=Object.getOwnPropertyDescriptor(V,Q)),!(ye&&ye.set==null)&&(F[Q]=O(R[Q],P-1))}if(Object.getOwnPropertySymbols)for(var nt=Object.getOwnPropertySymbols(R),Q=0;Q<nt.length;Q++){var We=nt[Q],rt=Object.getOwnPropertyDescriptor(R,We);rt&&!rt.enumerable&&!C||(F[We]=O(R[We],P-1),rt.enumerable||Object.defineProperty(F,We,{enumerable:!1}))}if(C)for(var Kt=Object.getOwnPropertyNames(R),Q=0;Q<Kt.length;Q++){var vt=Kt[Q],rt=Object.getOwnPropertyDescriptor(R,vt);rt&&rt.enumerable||(F[vt]=O(R[vt],P-1),Object.defineProperty(F,vt,{enumerable:!1}))}return F}return O(h,m)}o.clonePrototype=function(p){if(p===null)return null;var m=function(){};return m.prototype=p,new m};function l(h){return Object.prototype.toString.call(h)}o.__objToStr=l;function a(h){return typeof h=="object"&&l(h)==="[object Date]"}o.__isDate=a;function u(h){return typeof h=="object"&&l(h)==="[object Array]"}o.__isArray=u;function c(h){return typeof h=="object"&&l(h)==="[object RegExp]"}o.__isRegExp=c;function f(h){var p="";return h.global&&(p+="g"),h.ignoreCase&&(p+="i"),h.multiline&&(p+="m"),p}return o.__getRegExpFlags=f,o}();t.exports&&(t.exports=e)})(X_);var jM=X_.exports;const HM=zc(jM);var Ip={exports:{}},Ah,S1;function $M(){if(S1)return Ah;S1=1;var t=1e3,e=t*60,n=e*60,r=n*24,i=r*7,s=r*365.25;Ah=function(c,f){f=f||{};var h=typeof c;if(h==="string"&&c.length>0)return o(c);if(h==="number"&&isFinite(c))return f.long?a(c):l(c);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(c))};function o(c){if(c=String(c),!(c.length>100)){var f=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(c);if(f){var h=parseFloat(f[1]),p=(f[2]||"ms").toLowerCase();switch(p){case"years":case"year":case"yrs":case"yr":case"y":return h*s;case"weeks":case"week":case"w":return h*i;case"days":case"day":case"d":return h*r;case"hours":case"hour":case"hrs":case"hr":case"h":return h*n;case"minutes":case"minute":case"mins":case"min":case"m":return h*e;case"seconds":case"second":case"secs":case"sec":case"s":return h*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return h;default:return}}}}function l(c){var f=Math.abs(c);return f>=r?Math.round(c/r)+"d":f>=n?Math.round(c/n)+"h":f>=e?Math.round(c/e)+"m":f>=t?Math.round(c/t)+"s":c+"ms"}function a(c){var f=Math.abs(c);return f>=r?u(c,f,r,"day"):f>=n?u(c,f,n,"hour"):f>=e?u(c,f,e,"minute"):f>=t?u(c,f,t,"second"):c+" ms"}function u(c,f,h,p){var m=f>=h*1.5;return Math.round(c/h)+" "+p+(m?"s":"")}return Ah}function WM(t){n.debug=n,n.default=n,n.coerce=a,n.disable=s,n.enable=i,n.enabled=o,n.humanize=$M(),n.destroy=u,Object.keys(t).forEach(c=>{n[c]=t[c]}),n.names=[],n.skips=[],n.formatters={};function e(c){let f=0;for(let h=0;h<c.length;h++)f=(f<<5)-f+c.charCodeAt(h),f|=0;return n.colors[Math.abs(f)%n.colors.length]}n.selectColor=e;function n(c){let f,h=null,p,m;function v(...C){if(!v.enabled)return;const y=v,_=Number(new Date),x=_-(f||_);y.diff=x,y.prev=f,y.curr=_,f=_,C[0]=n.coerce(C[0]),typeof C[0]!="string"&&C.unshift("%O");let O=0;C[0]=C[0].replace(/%([a-zA-Z%])/g,(P,F)=>{if(P==="%%")return"%";O++;const V=n.formatters[F];if(typeof V=="function"){const z=C[O];P=V.call(y,z),C.splice(O,1),O--}return P}),n.formatArgs.call(y,C),(y.log||n.log).apply(y,C)}return v.namespace=c,v.useColors=n.useColors(),v.color=n.selectColor(c),v.extend=r,v.destroy=n.destroy,Object.defineProperty(v,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(p!==n.namespaces&&(p=n.namespaces,m=n.enabled(c)),m),set:C=>{h=C}}),typeof n.init=="function"&&n.init(v),v}function r(c,f){const h=n(this.namespace+(typeof f>"u"?":":f)+c);return h.log=this.log,h}function i(c){n.save(c),n.namespaces=c,n.names=[],n.skips=[];let f;const h=(typeof c=="string"?c:"").split(/[\s,]+/),p=h.length;for(f=0;f<p;f++)h[f]&&(c=h[f].replace(/\*/g,".*?"),c[0]==="-"?n.skips.push(new RegExp("^"+c.slice(1)+"$")):n.names.push(new RegExp("^"+c+"$")))}function s(){const c=[...n.names.map(l),...n.skips.map(l).map(f=>"-"+f)].join(",");return n.enable(""),c}function o(c){if(c[c.length-1]==="*")return!0;let f,h;for(f=0,h=n.skips.length;f<h;f++)if(n.skips[f].test(c))return!1;for(f=0,h=n.names.length;f<h;f++)if(n.names[f].test(c))return!0;return!1}function l(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function a(c){return c instanceof Error?c.stack||c.message:c}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var qM=WM;(function(t,e){var n={};e.formatArgs=i,e.save=s,e.load=o,e.useColors=r,e.storage=l(),e.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const c="color: "+this.color;u.splice(1,0,c,"color: inherit");let f=0,h=0;u[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(f++,p==="%c"&&(h=f))}),u.splice(h,0,c)}e.log=console.debug||console.log||(()=>{});function s(u){try{u?e.storage.setItem("debug",u):e.storage.removeItem("debug")}catch{}}function o(){let u;try{u=e.storage.getItem("debug")}catch{}return!u&&typeof process<"u"&&"env"in process&&(u=n.DEBUG),u}function l(){try{return localStorage}catch{}}t.exports=qM(e);const{formatters:a}=t.exports;a.j=function(u){try{return JSON.stringify(u)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}})(Ip,Ip.exports);var eE=Ip.exports,KM=function(){if(typeof globalThis>"u")return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null},Op={exports:{}},Rp={exports:{}},Ms={},yf={};yf.byteLength=YM;yf.toByteArray=ZM;yf.fromByteArray=tD;var fr=[],_n=[],GM=typeof Uint8Array<"u"?Uint8Array:Array,Nh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var zs=0,JM=Nh.length;zs<JM;++zs)fr[zs]=Nh[zs],_n[Nh.charCodeAt(zs)]=zs;_n[45]=62;_n[95]=63;function tE(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function YM(t){var e=tE(t),n=e[0],r=e[1];return(n+r)*3/4-r}function QM(t,e,n){return(e+n)*3/4-n}function ZM(t){var e,n=tE(t),r=n[0],i=n[1],s=new GM(QM(t,r,i)),o=0,l=i>0?r-4:r,a;for(a=0;a<l;a+=4)e=_n[t.charCodeAt(a)]<<18|_n[t.charCodeAt(a+1)]<<12|_n[t.charCodeAt(a+2)]<<6|_n[t.charCodeAt(a+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=_n[t.charCodeAt(a)]<<2|_n[t.charCodeAt(a+1)]>>4,s[o++]=e&255),i===1&&(e=_n[t.charCodeAt(a)]<<10|_n[t.charCodeAt(a+1)]<<4|_n[t.charCodeAt(a+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function XM(t){return fr[t>>18&63]+fr[t>>12&63]+fr[t>>6&63]+fr[t&63]}function eD(t,e,n){for(var r,i=[],s=e;s<n;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),i.push(XM(r));return i.join("")}function tD(t){for(var e,n=t.length,r=n%3,i=[],s=16383,o=0,l=n-r;o<l;o+=s)i.push(eD(t,o,o+s>l?l:o+s));return r===1?(e=t[n-1],i.push(fr[e>>2]+fr[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],i.push(fr[e>>10]+fr[e>>4&63]+fr[e<<2&63]+"=")),i.join("")}var gm={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */gm.read=function(t,e,n,r,i){var s,o,l=i*8-r-1,a=(1<<l)-1,u=a>>1,c=-7,f=n?i-1:0,h=n?-1:1,p=t[e+f];for(f+=h,s=p&(1<<-c)-1,p>>=-c,c+=l;c>0;s=s*256+t[e+f],f+=h,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=r;c>0;o=o*256+t[e+f],f+=h,c-=8);if(s===0)s=1-u;else{if(s===a)return o?NaN:(p?-1:1)*(1/0);o=o+Math.pow(2,r),s=s-u}return(p?-1:1)*o*Math.pow(2,s-r)};gm.write=function(t,e,n,r,i,s){var o,l,a,u=s*8-i-1,c=(1<<u)-1,f=c>>1,h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:s-1,m=r?1:-1,v=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(a=Math.pow(2,-o))<1&&(o--,a*=2),o+f>=1?e+=h/a:e+=h*Math.pow(2,1-f),e*a>=2&&(o++,a/=2),o+f>=c?(l=0,o=c):o+f>=1?(l=(e*a-1)*Math.pow(2,i),o=o+f):(l=e*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;t[n+p]=l&255,p+=m,l/=256,i-=8);for(o=o<<i|l,u+=i;u>0;t[n+p]=o&255,p+=m,o/=256,u-=8);t[n+p-m]|=v*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=yf,n=gm,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=_,t.INSPECT_MAX_BYTES=50;const i=2147483647;t.kMaxLength=i,l.TYPED_ARRAY_SUPPORT=s(),!l.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const k=new Uint8Array(1),d={foo:function(){return 42}};return Object.setPrototypeOf(d,Uint8Array.prototype),Object.setPrototypeOf(k,d),k.foo()===42}catch{return!1}}Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}});function o(k){if(k>i)throw new RangeError('The value "'+k+'" is invalid for option "size"');const d=new Uint8Array(k);return Object.setPrototypeOf(d,l.prototype),d}function l(k,d,g){if(typeof k=="number"){if(typeof d=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(k)}return a(k,d,g)}l.poolSize=8192;function a(k,d,g){if(typeof k=="string")return h(k,d);if(ArrayBuffer.isView(k))return m(k);if(k==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof k);if(Nt(k,ArrayBuffer)||k&&Nt(k.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Nt(k,SharedArrayBuffer)||k&&Nt(k.buffer,SharedArrayBuffer)))return v(k,d,g);if(typeof k=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const b=k.valueOf&&k.valueOf();if(b!=null&&b!==k)return l.from(b,d,g);const A=C(k);if(A)return A;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof k[Symbol.toPrimitive]=="function")return l.from(k[Symbol.toPrimitive]("string"),d,g);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof k)}l.from=function(k,d,g){return a(k,d,g)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array);function u(k){if(typeof k!="number")throw new TypeError('"size" argument must be of type number');if(k<0)throw new RangeError('The value "'+k+'" is invalid for option "size"')}function c(k,d,g){return u(k),k<=0?o(k):d!==void 0?typeof g=="string"?o(k).fill(d,g):o(k).fill(d):o(k)}l.alloc=function(k,d,g){return c(k,d,g)};function f(k){return u(k),o(k<0?0:y(k)|0)}l.allocUnsafe=function(k){return f(k)},l.allocUnsafeSlow=function(k){return f(k)};function h(k,d){if((typeof d!="string"||d==="")&&(d="utf8"),!l.isEncoding(d))throw new TypeError("Unknown encoding: "+d);const g=x(k,d)|0;let b=o(g);const A=b.write(k,d);return A!==g&&(b=b.slice(0,A)),b}function p(k){const d=k.length<0?0:y(k.length)|0,g=o(d);for(let b=0;b<d;b+=1)g[b]=k[b]&255;return g}function m(k){if(Nt(k,Uint8Array)){const d=new Uint8Array(k);return v(d.buffer,d.byteOffset,d.byteLength)}return p(k)}function v(k,d,g){if(d<0||k.byteLength<d)throw new RangeError('"offset" is outside of buffer bounds');if(k.byteLength<d+(g||0))throw new RangeError('"length" is outside of buffer bounds');let b;return d===void 0&&g===void 0?b=new Uint8Array(k):g===void 0?b=new Uint8Array(k,d):b=new Uint8Array(k,d,g),Object.setPrototypeOf(b,l.prototype),b}function C(k){if(l.isBuffer(k)){const d=y(k.length)|0,g=o(d);return g.length===0||k.copy(g,0,0,d),g}if(k.length!==void 0)return typeof k.length!="number"||_r(k.length)?o(0):p(k);if(k.type==="Buffer"&&Array.isArray(k.data))return p(k.data)}function y(k){if(k>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return k|0}function _(k){return+k!=k&&(k=0),l.alloc(+k)}l.isBuffer=function(d){return d!=null&&d._isBuffer===!0&&d!==l.prototype},l.compare=function(d,g){if(Nt(d,Uint8Array)&&(d=l.from(d,d.offset,d.byteLength)),Nt(g,Uint8Array)&&(g=l.from(g,g.offset,g.byteLength)),!l.isBuffer(d)||!l.isBuffer(g))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(d===g)return 0;let b=d.length,A=g.length;for(let B=0,L=Math.min(b,A);B<L;++B)if(d[B]!==g[B]){b=d[B],A=g[B];break}return b<A?-1:A<b?1:0},l.isEncoding=function(d){switch(String(d).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(d,g){if(!Array.isArray(d))throw new TypeError('"list" argument must be an Array of Buffers');if(d.length===0)return l.alloc(0);let b;if(g===void 0)for(g=0,b=0;b<d.length;++b)g+=d[b].length;const A=l.allocUnsafe(g);let B=0;for(b=0;b<d.length;++b){let L=d[b];if(Nt(L,Uint8Array))B+L.length>A.length?(l.isBuffer(L)||(L=l.from(L)),L.copy(A,B)):Uint8Array.prototype.set.call(A,L,B);else if(l.isBuffer(L))L.copy(A,B);else throw new TypeError('"list" argument must be an Array of Buffers');B+=L.length}return A};function x(k,d){if(l.isBuffer(k))return k.length;if(ArrayBuffer.isView(k)||Nt(k,ArrayBuffer))return k.byteLength;if(typeof k!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof k);const g=k.length,b=arguments.length>2&&arguments[2]===!0;if(!b&&g===0)return 0;let A=!1;for(;;)switch(d){case"ascii":case"latin1":case"binary":return g;case"utf8":case"utf-8":return Se(k).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return g*2;case"hex":return g>>>1;case"base64":return ji(k).length;default:if(A)return b?-1:Se(k).length;d=(""+d).toLowerCase(),A=!0}}l.byteLength=x;function O(k,d,g){let b=!1;if((d===void 0||d<0)&&(d=0),d>this.length||((g===void 0||g>this.length)&&(g=this.length),g<=0)||(g>>>=0,d>>>=0,g<=d))return"";for(k||(k="utf8");;)switch(k){case"hex":return te(this,d,g);case"utf8":case"utf-8":return rt(this,d,g);case"ascii":return qe(this,d,g);case"latin1":case"binary":return K(this,d,g);case"base64":return We(this,d,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return re(this,d,g);default:if(b)throw new TypeError("Unknown encoding: "+k);k=(k+"").toLowerCase(),b=!0}}l.prototype._isBuffer=!0;function R(k,d,g){const b=k[d];k[d]=k[g],k[g]=b}l.prototype.swap16=function(){const d=this.length;if(d%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let g=0;g<d;g+=2)R(this,g,g+1);return this},l.prototype.swap32=function(){const d=this.length;if(d%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let g=0;g<d;g+=4)R(this,g,g+3),R(this,g+1,g+2);return this},l.prototype.swap64=function(){const d=this.length;if(d%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let g=0;g<d;g+=8)R(this,g,g+7),R(this,g+1,g+6),R(this,g+2,g+5),R(this,g+3,g+4);return this},l.prototype.toString=function(){const d=this.length;return d===0?"":arguments.length===0?rt(this,0,d):O.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(d){if(!l.isBuffer(d))throw new TypeError("Argument must be a Buffer");return this===d?!0:l.compare(this,d)===0},l.prototype.inspect=function(){let d="";const g=t.INSPECT_MAX_BYTES;return d=this.toString("hex",0,g).replace(/(.{2})/g,"$1 ").trim(),this.length>g&&(d+=" ... "),"<Buffer "+d+">"},r&&(l.prototype[r]=l.prototype.inspect),l.prototype.compare=function(d,g,b,A,B){if(Nt(d,Uint8Array)&&(d=l.from(d,d.offset,d.byteLength)),!l.isBuffer(d))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof d);if(g===void 0&&(g=0),b===void 0&&(b=d?d.length:0),A===void 0&&(A=0),B===void 0&&(B=this.length),g<0||b>d.length||A<0||B>this.length)throw new RangeError("out of range index");if(A>=B&&g>=b)return 0;if(A>=B)return-1;if(g>=b)return 1;if(g>>>=0,b>>>=0,A>>>=0,B>>>=0,this===d)return 0;let L=B-A,ue=b-g;const Be=Math.min(L,ue),be=this.slice(A,B),Pe=d.slice(g,b);for(let ke=0;ke<Be;++ke)if(be[ke]!==Pe[ke]){L=be[ke],ue=Pe[ke];break}return L<ue?-1:ue<L?1:0};function P(k,d,g,b,A){if(k.length===0)return-1;if(typeof g=="string"?(b=g,g=0):g>2147483647?g=2147483647:g<-2147483648&&(g=-2147483648),g=+g,_r(g)&&(g=A?0:k.length-1),g<0&&(g=k.length+g),g>=k.length){if(A)return-1;g=k.length-1}else if(g<0)if(A)g=0;else return-1;if(typeof d=="string"&&(d=l.from(d,b)),l.isBuffer(d))return d.length===0?-1:F(k,d,g,b,A);if(typeof d=="number")return d=d&255,typeof Uint8Array.prototype.indexOf=="function"?A?Uint8Array.prototype.indexOf.call(k,d,g):Uint8Array.prototype.lastIndexOf.call(k,d,g):F(k,[d],g,b,A);throw new TypeError("val must be string, number or Buffer")}function F(k,d,g,b,A){let B=1,L=k.length,ue=d.length;if(b!==void 0&&(b=String(b).toLowerCase(),b==="ucs2"||b==="ucs-2"||b==="utf16le"||b==="utf-16le")){if(k.length<2||d.length<2)return-1;B=2,L/=2,ue/=2,g/=2}function Be(Pe,ke){return B===1?Pe[ke]:Pe.readUInt16BE(ke*B)}let be;if(A){let Pe=-1;for(be=g;be<L;be++)if(Be(k,be)===Be(d,Pe===-1?0:be-Pe)){if(Pe===-1&&(Pe=be),be-Pe+1===ue)return Pe*B}else Pe!==-1&&(be-=be-Pe),Pe=-1}else for(g+ue>L&&(g=L-ue),be=g;be>=0;be--){let Pe=!0;for(let ke=0;ke<ue;ke++)if(Be(k,be+ke)!==Be(d,ke)){Pe=!1;break}if(Pe)return be}return-1}l.prototype.includes=function(d,g,b){return this.indexOf(d,g,b)!==-1},l.prototype.indexOf=function(d,g,b){return P(this,d,g,b,!0)},l.prototype.lastIndexOf=function(d,g,b){return P(this,d,g,b,!1)};function V(k,d,g,b){g=Number(g)||0;const A=k.length-g;b?(b=Number(b),b>A&&(b=A)):b=A;const B=d.length;b>B/2&&(b=B/2);let L;for(L=0;L<b;++L){const ue=parseInt(d.substr(L*2,2),16);if(_r(ue))return L;k[g+L]=ue}return L}function z(k,d,g,b){return Yr(Se(d,k.length-g),k,g,b)}function Q(k,d,g,b){return Yr(ir(d),k,g,b)}function ye(k,d,g,b){return Yr(ji(d),k,g,b)}function nt(k,d,g,b){return Yr(Jr(d,k.length-g),k,g,b)}l.prototype.write=function(d,g,b,A){if(g===void 0)A="utf8",b=this.length,g=0;else if(b===void 0&&typeof g=="string")A=g,b=this.length,g=0;else if(isFinite(g))g=g>>>0,isFinite(b)?(b=b>>>0,A===void 0&&(A="utf8")):(A=b,b=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const B=this.length-g;if((b===void 0||b>B)&&(b=B),d.length>0&&(b<0||g<0)||g>this.length)throw new RangeError("Attempt to write outside buffer bounds");A||(A="utf8");let L=!1;for(;;)switch(A){case"hex":return V(this,d,g,b);case"utf8":case"utf-8":return z(this,d,g,b);case"ascii":case"latin1":case"binary":return Q(this,d,g,b);case"base64":return ye(this,d,g,b);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return nt(this,d,g,b);default:if(L)throw new TypeError("Unknown encoding: "+A);A=(""+A).toLowerCase(),L=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function We(k,d,g){return d===0&&g===k.length?e.fromByteArray(k):e.fromByteArray(k.slice(d,g))}function rt(k,d,g){g=Math.min(k.length,g);const b=[];let A=d;for(;A<g;){const B=k[A];let L=null,ue=B>239?4:B>223?3:B>191?2:1;if(A+ue<=g){let Be,be,Pe,ke;switch(ue){case 1:B<128&&(L=B);break;case 2:Be=k[A+1],(Be&192)===128&&(ke=(B&31)<<6|Be&63,ke>127&&(L=ke));break;case 3:Be=k[A+1],be=k[A+2],(Be&192)===128&&(be&192)===128&&(ke=(B&15)<<12|(Be&63)<<6|be&63,ke>2047&&(ke<55296||ke>57343)&&(L=ke));break;case 4:Be=k[A+1],be=k[A+2],Pe=k[A+3],(Be&192)===128&&(be&192)===128&&(Pe&192)===128&&(ke=(B&15)<<18|(Be&63)<<12|(be&63)<<6|Pe&63,ke>65535&&ke<1114112&&(L=ke))}}L===null?(L=65533,ue=1):L>65535&&(L-=65536,b.push(L>>>10&1023|55296),L=56320|L&1023),b.push(L),A+=ue}return vt(b)}const Kt=4096;function vt(k){const d=k.length;if(d<=Kt)return String.fromCharCode.apply(String,k);let g="",b=0;for(;b<d;)g+=String.fromCharCode.apply(String,k.slice(b,b+=Kt));return g}function qe(k,d,g){let b="";g=Math.min(k.length,g);for(let A=d;A<g;++A)b+=String.fromCharCode(k[A]&127);return b}function K(k,d,g){let b="";g=Math.min(k.length,g);for(let A=d;A<g;++A)b+=String.fromCharCode(k[A]);return b}function te(k,d,g){const b=k.length;(!d||d<0)&&(d=0),(!g||g<0||g>b)&&(g=b);let A="";for(let B=d;B<g;++B)A+=Hi[k[B]];return A}function re(k,d,g){const b=k.slice(d,g);let A="";for(let B=0;B<b.length-1;B+=2)A+=String.fromCharCode(b[B]+b[B+1]*256);return A}l.prototype.slice=function(d,g){const b=this.length;d=~~d,g=g===void 0?b:~~g,d<0?(d+=b,d<0&&(d=0)):d>b&&(d=b),g<0?(g+=b,g<0&&(g=0)):g>b&&(g=b),g<d&&(g=d);const A=this.subarray(d,g);return Object.setPrototypeOf(A,l.prototype),A};function se(k,d,g){if(k%1!==0||k<0)throw new RangeError("offset is not uint");if(k+d>g)throw new RangeError("Trying to access beyond buffer length")}l.prototype.readUintLE=l.prototype.readUIntLE=function(d,g,b){d=d>>>0,g=g>>>0,b||se(d,g,this.length);let A=this[d],B=1,L=0;for(;++L<g&&(B*=256);)A+=this[d+L]*B;return A},l.prototype.readUintBE=l.prototype.readUIntBE=function(d,g,b){d=d>>>0,g=g>>>0,b||se(d,g,this.length);let A=this[d+--g],B=1;for(;g>0&&(B*=256);)A+=this[d+--g]*B;return A},l.prototype.readUint8=l.prototype.readUInt8=function(d,g){return d=d>>>0,g||se(d,1,this.length),this[d]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(d,g){return d=d>>>0,g||se(d,2,this.length),this[d]|this[d+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(d,g){return d=d>>>0,g||se(d,2,this.length),this[d]<<8|this[d+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(d,g){return d=d>>>0,g||se(d,4,this.length),(this[d]|this[d+1]<<8|this[d+2]<<16)+this[d+3]*16777216},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(d,g){return d=d>>>0,g||se(d,4,this.length),this[d]*16777216+(this[d+1]<<16|this[d+2]<<8|this[d+3])},l.prototype.readBigUInt64LE=Gt(function(d){d=d>>>0,j(d,"offset");const g=this[d],b=this[d+7];(g===void 0||b===void 0)&&Y(d,this.length-8);const A=g+this[++d]*2**8+this[++d]*2**16+this[++d]*2**24,B=this[++d]+this[++d]*2**8+this[++d]*2**16+b*2**24;return BigInt(A)+(BigInt(B)<<BigInt(32))}),l.prototype.readBigUInt64BE=Gt(function(d){d=d>>>0,j(d,"offset");const g=this[d],b=this[d+7];(g===void 0||b===void 0)&&Y(d,this.length-8);const A=g*2**24+this[++d]*2**16+this[++d]*2**8+this[++d],B=this[++d]*2**24+this[++d]*2**16+this[++d]*2**8+b;return(BigInt(A)<<BigInt(32))+BigInt(B)}),l.prototype.readIntLE=function(d,g,b){d=d>>>0,g=g>>>0,b||se(d,g,this.length);let A=this[d],B=1,L=0;for(;++L<g&&(B*=256);)A+=this[d+L]*B;return B*=128,A>=B&&(A-=Math.pow(2,8*g)),A},l.prototype.readIntBE=function(d,g,b){d=d>>>0,g=g>>>0,b||se(d,g,this.length);let A=g,B=1,L=this[d+--A];for(;A>0&&(B*=256);)L+=this[d+--A]*B;return B*=128,L>=B&&(L-=Math.pow(2,8*g)),L},l.prototype.readInt8=function(d,g){return d=d>>>0,g||se(d,1,this.length),this[d]&128?(255-this[d]+1)*-1:this[d]},l.prototype.readInt16LE=function(d,g){d=d>>>0,g||se(d,2,this.length);const b=this[d]|this[d+1]<<8;return b&32768?b|4294901760:b},l.prototype.readInt16BE=function(d,g){d=d>>>0,g||se(d,2,this.length);const b=this[d+1]|this[d]<<8;return b&32768?b|4294901760:b},l.prototype.readInt32LE=function(d,g){return d=d>>>0,g||se(d,4,this.length),this[d]|this[d+1]<<8|this[d+2]<<16|this[d+3]<<24},l.prototype.readInt32BE=function(d,g){return d=d>>>0,g||se(d,4,this.length),this[d]<<24|this[d+1]<<16|this[d+2]<<8|this[d+3]},l.prototype.readBigInt64LE=Gt(function(d){d=d>>>0,j(d,"offset");const g=this[d],b=this[d+7];(g===void 0||b===void 0)&&Y(d,this.length-8);const A=this[d+4]+this[d+5]*2**8+this[d+6]*2**16+(b<<24);return(BigInt(A)<<BigInt(32))+BigInt(g+this[++d]*2**8+this[++d]*2**16+this[++d]*2**24)}),l.prototype.readBigInt64BE=Gt(function(d){d=d>>>0,j(d,"offset");const g=this[d],b=this[d+7];(g===void 0||b===void 0)&&Y(d,this.length-8);const A=(g<<24)+this[++d]*2**16+this[++d]*2**8+this[++d];return(BigInt(A)<<BigInt(32))+BigInt(this[++d]*2**24+this[++d]*2**16+this[++d]*2**8+b)}),l.prototype.readFloatLE=function(d,g){return d=d>>>0,g||se(d,4,this.length),n.read(this,d,!0,23,4)},l.prototype.readFloatBE=function(d,g){return d=d>>>0,g||se(d,4,this.length),n.read(this,d,!1,23,4)},l.prototype.readDoubleLE=function(d,g){return d=d>>>0,g||se(d,8,this.length),n.read(this,d,!0,52,8)},l.prototype.readDoubleBE=function(d,g){return d=d>>>0,g||se(d,8,this.length),n.read(this,d,!1,52,8)};function oe(k,d,g,b,A,B){if(!l.isBuffer(k))throw new TypeError('"buffer" argument must be a Buffer instance');if(d>A||d<B)throw new RangeError('"value" argument is out of bounds');if(g+b>k.length)throw new RangeError("Index out of range")}l.prototype.writeUintLE=l.prototype.writeUIntLE=function(d,g,b,A){if(d=+d,g=g>>>0,b=b>>>0,!A){const ue=Math.pow(2,8*b)-1;oe(this,d,g,b,ue,0)}let B=1,L=0;for(this[g]=d&255;++L<b&&(B*=256);)this[g+L]=d/B&255;return g+b},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(d,g,b,A){if(d=+d,g=g>>>0,b=b>>>0,!A){const ue=Math.pow(2,8*b)-1;oe(this,d,g,b,ue,0)}let B=b-1,L=1;for(this[g+B]=d&255;--B>=0&&(L*=256);)this[g+B]=d/L&255;return g+b},l.prototype.writeUint8=l.prototype.writeUInt8=function(d,g,b){return d=+d,g=g>>>0,b||oe(this,d,g,1,255,0),this[g]=d&255,g+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(d,g,b){return d=+d,g=g>>>0,b||oe(this,d,g,2,65535,0),this[g]=d&255,this[g+1]=d>>>8,g+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(d,g,b){return d=+d,g=g>>>0,b||oe(this,d,g,2,65535,0),this[g]=d>>>8,this[g+1]=d&255,g+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(d,g,b){return d=+d,g=g>>>0,b||oe(this,d,g,4,4294967295,0),this[g+3]=d>>>24,this[g+2]=d>>>16,this[g+1]=d>>>8,this[g]=d&255,g+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(d,g,b){return d=+d,g=g>>>0,b||oe(this,d,g,4,4294967295,0),this[g]=d>>>24,this[g+1]=d>>>16,this[g+2]=d>>>8,this[g+3]=d&255,g+4};function ht(k,d,g,b,A){I(d,b,A,k,g,7);let B=Number(d&BigInt(4294967295));k[g++]=B,B=B>>8,k[g++]=B,B=B>>8,k[g++]=B,B=B>>8,k[g++]=B;let L=Number(d>>BigInt(32)&BigInt(4294967295));return k[g++]=L,L=L>>8,k[g++]=L,L=L>>8,k[g++]=L,L=L>>8,k[g++]=L,g}function kt(k,d,g,b,A){I(d,b,A,k,g,7);let B=Number(d&BigInt(4294967295));k[g+7]=B,B=B>>8,k[g+6]=B,B=B>>8,k[g+5]=B,B=B>>8,k[g+4]=B;let L=Number(d>>BigInt(32)&BigInt(4294967295));return k[g+3]=L,L=L>>8,k[g+2]=L,L=L>>8,k[g+1]=L,L=L>>8,k[g]=L,g+8}l.prototype.writeBigUInt64LE=Gt(function(d,g=0){return ht(this,d,g,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeBigUInt64BE=Gt(function(d,g=0){return kt(this,d,g,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeIntLE=function(d,g,b,A){if(d=+d,g=g>>>0,!A){const Be=Math.pow(2,8*b-1);oe(this,d,g,b,Be-1,-Be)}let B=0,L=1,ue=0;for(this[g]=d&255;++B<b&&(L*=256);)d<0&&ue===0&&this[g+B-1]!==0&&(ue=1),this[g+B]=(d/L>>0)-ue&255;return g+b},l.prototype.writeIntBE=function(d,g,b,A){if(d=+d,g=g>>>0,!A){const Be=Math.pow(2,8*b-1);oe(this,d,g,b,Be-1,-Be)}let B=b-1,L=1,ue=0;for(this[g+B]=d&255;--B>=0&&(L*=256);)d<0&&ue===0&&this[g+B+1]!==0&&(ue=1),this[g+B]=(d/L>>0)-ue&255;return g+b},l.prototype.writeInt8=function(d,g,b){return d=+d,g=g>>>0,b||oe(this,d,g,1,127,-128),d<0&&(d=255+d+1),this[g]=d&255,g+1},l.prototype.writeInt16LE=function(d,g,b){return d=+d,g=g>>>0,b||oe(this,d,g,2,32767,-32768),this[g]=d&255,this[g+1]=d>>>8,g+2},l.prototype.writeInt16BE=function(d,g,b){return d=+d,g=g>>>0,b||oe(this,d,g,2,32767,-32768),this[g]=d>>>8,this[g+1]=d&255,g+2},l.prototype.writeInt32LE=function(d,g,b){return d=+d,g=g>>>0,b||oe(this,d,g,4,2147483647,-2147483648),this[g]=d&255,this[g+1]=d>>>8,this[g+2]=d>>>16,this[g+3]=d>>>24,g+4},l.prototype.writeInt32BE=function(d,g,b){return d=+d,g=g>>>0,b||oe(this,d,g,4,2147483647,-2147483648),d<0&&(d=4294967295+d+1),this[g]=d>>>24,this[g+1]=d>>>16,this[g+2]=d>>>8,this[g+3]=d&255,g+4},l.prototype.writeBigInt64LE=Gt(function(d,g=0){return ht(this,d,g,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeBigInt64BE=Gt(function(d,g=0){return kt(this,d,g,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Sn(k,d,g,b,A,B){if(g+b>k.length)throw new RangeError("Index out of range");if(g<0)throw new RangeError("Index out of range")}function D(k,d,g,b,A){return d=+d,g=g>>>0,A||Sn(k,d,g,4),n.write(k,d,g,b,23,4),g+4}l.prototype.writeFloatLE=function(d,g,b){return D(this,d,g,!0,b)},l.prototype.writeFloatBE=function(d,g,b){return D(this,d,g,!1,b)};function M(k,d,g,b,A){return d=+d,g=g>>>0,A||Sn(k,d,g,8),n.write(k,d,g,b,52,8),g+8}l.prototype.writeDoubleLE=function(d,g,b){return M(this,d,g,!0,b)},l.prototype.writeDoubleBE=function(d,g,b){return M(this,d,g,!1,b)},l.prototype.copy=function(d,g,b,A){if(!l.isBuffer(d))throw new TypeError("argument should be a Buffer");if(b||(b=0),!A&&A!==0&&(A=this.length),g>=d.length&&(g=d.length),g||(g=0),A>0&&A<b&&(A=b),A===b||d.length===0||this.length===0)return 0;if(g<0)throw new RangeError("targetStart out of bounds");if(b<0||b>=this.length)throw new RangeError("Index out of range");if(A<0)throw new RangeError("sourceEnd out of bounds");A>this.length&&(A=this.length),d.length-g<A-b&&(A=d.length-g+b);const B=A-b;return this===d&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(g,b,A):Uint8Array.prototype.set.call(d,this.subarray(b,A),g),B},l.prototype.fill=function(d,g,b,A){if(typeof d=="string"){if(typeof g=="string"?(A=g,g=0,b=this.length):typeof b=="string"&&(A=b,b=this.length),A!==void 0&&typeof A!="string")throw new TypeError("encoding must be a string");if(typeof A=="string"&&!l.isEncoding(A))throw new TypeError("Unknown encoding: "+A);if(d.length===1){const L=d.charCodeAt(0);(A==="utf8"&&L<128||A==="latin1")&&(d=L)}}else typeof d=="number"?d=d&255:typeof d=="boolean"&&(d=Number(d));if(g<0||this.length<g||this.length<b)throw new RangeError("Out of range index");if(b<=g)return this;g=g>>>0,b=b===void 0?this.length:b>>>0,d||(d=0);let B;if(typeof d=="number")for(B=g;B<b;++B)this[B]=d;else{const L=l.isBuffer(d)?d:l.from(d,A),ue=L.length;if(ue===0)throw new TypeError('The value "'+d+'" is invalid for argument "value"');for(B=0;B<b-g;++B)this[B+g]=L[B%ue]}return this};const W={};function ee(k,d,g){W[k]=class extends g{constructor(){super(),Object.defineProperty(this,"message",{value:d.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${k}]`,this.stack,delete this.name}get code(){return k}set code(A){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:A,writable:!0})}toString(){return`${this.name} [${k}]: ${this.message}`}}}ee("ERR_BUFFER_OUT_OF_BOUNDS",function(k){return k?`${k} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ee("ERR_INVALID_ARG_TYPE",function(k,d){return`The "${k}" argument must be of type number. Received type ${typeof d}`},TypeError),ee("ERR_OUT_OF_RANGE",function(k,d,g){let b=`The value of "${k}" is out of range.`,A=g;return Number.isInteger(g)&&Math.abs(g)>2**32?A=ce(String(g)):typeof g=="bigint"&&(A=String(g),(g>BigInt(2)**BigInt(32)||g<-(BigInt(2)**BigInt(32)))&&(A=ce(A)),A+="n"),b+=` It must be ${d}. Received ${A}`,b},RangeError);function ce(k){let d="",g=k.length;const b=k[0]==="-"?1:0;for(;g>=b+4;g-=3)d=`_${k.slice(g-3,g)}${d}`;return`${k.slice(0,g)}${d}`}function T(k,d,g){j(d,"offset"),(k[d]===void 0||k[d+g]===void 0)&&Y(d,k.length-(g+1))}function I(k,d,g,b,A,B){if(k>g||k<d){const L=typeof d=="bigint"?"n":"";let ue;throw B>3?d===0||d===BigInt(0)?ue=`>= 0${L} and < 2${L} ** ${(B+1)*8}${L}`:ue=`>= -(2${L} ** ${(B+1)*8-1}${L}) and < 2 ** ${(B+1)*8-1}${L}`:ue=`>= ${d}${L} and <= ${g}${L}`,new W.ERR_OUT_OF_RANGE("value",ue,k)}T(b,A,B)}function j(k,d){if(typeof k!="number")throw new W.ERR_INVALID_ARG_TYPE(d,"number",k)}function Y(k,d,g){throw Math.floor(k)!==k?(j(k,g),new W.ERR_OUT_OF_RANGE(g||"offset","an integer",k)):d<0?new W.ERR_BUFFER_OUT_OF_BOUNDS:new W.ERR_OUT_OF_RANGE(g||"offset",`>= ${g?1:0} and <= ${d}`,k)}const Ie=/[^+/0-9A-Za-z-_]/g;function fe(k){if(k=k.split("=")[0],k=k.trim().replace(Ie,""),k.length<2)return"";for(;k.length%4!==0;)k=k+"=";return k}function Se(k,d){d=d||1/0;let g;const b=k.length;let A=null;const B=[];for(let L=0;L<b;++L){if(g=k.charCodeAt(L),g>55295&&g<57344){if(!A){if(g>56319){(d-=3)>-1&&B.push(239,191,189);continue}else if(L+1===b){(d-=3)>-1&&B.push(239,191,189);continue}A=g;continue}if(g<56320){(d-=3)>-1&&B.push(239,191,189),A=g;continue}g=(A-55296<<10|g-56320)+65536}else A&&(d-=3)>-1&&B.push(239,191,189);if(A=null,g<128){if((d-=1)<0)break;B.push(g)}else if(g<2048){if((d-=2)<0)break;B.push(g>>6|192,g&63|128)}else if(g<65536){if((d-=3)<0)break;B.push(g>>12|224,g>>6&63|128,g&63|128)}else if(g<1114112){if((d-=4)<0)break;B.push(g>>18|240,g>>12&63|128,g>>6&63|128,g&63|128)}else throw new Error("Invalid code point")}return B}function ir(k){const d=[];for(let g=0;g<k.length;++g)d.push(k.charCodeAt(g)&255);return d}function Jr(k,d){let g,b,A;const B=[];for(let L=0;L<k.length&&!((d-=2)<0);++L)g=k.charCodeAt(L),b=g>>8,A=g%256,B.push(A),B.push(b);return B}function ji(k){return e.toByteArray(fe(k))}function Yr(k,d,g,b){let A;for(A=0;A<b&&!(A+g>=d.length||A>=k.length);++A)d[A+g]=k[A];return A}function Nt(k,d){return k instanceof d||k!=null&&k.constructor!=null&&k.constructor.name!=null&&k.constructor.name===d.name}function _r(k){return k!==k}const Hi=function(){const k="0123456789abcdef",d=new Array(256);for(let g=0;g<16;++g){const b=g*16;for(let A=0;A<16;++A)d[b+A]=k[g]+k[A]}return d}();function Gt(k){return typeof BigInt>"u"?Er:k}function Er(){throw new Error("BigInt not supported")}})(Ms);/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(t,e){var n=Ms,r=n.Buffer;function i(o,l){for(var a in o)l[a]=o[a]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?t.exports=n:(i(n,e),e.Buffer=s);function s(o,l,a){return r(o,l,a)}s.prototype=Object.create(r.prototype),i(r,s),s.from=function(o,l,a){if(typeof o=="number")throw new TypeError("Argument must not be a number");return r(o,l,a)},s.alloc=function(o,l,a){if(typeof o!="number")throw new TypeError("Argument must be a number");var u=r(o);return l!==void 0?typeof a=="string"?u.fill(l,a):u.fill(l):u.fill(0),u},s.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return r(o)},s.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(o)}})(Rp,Rp.exports);var nE=Rp.exports,Mh=65536,nD=4294967295;function rD(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var iD=nE.Buffer,Pc=de.crypto||de.msCrypto;Pc&&Pc.getRandomValues?Op.exports=sD:Op.exports=rD;function sD(t,e){if(t>nD)throw new RangeError("requested too many random bytes");var n=iD.allocUnsafe(t);if(t>0)if(t>Mh)for(var r=0;r<t;r+=Mh)Pc.getRandomValues(n.slice(r,r+Mh));else Pc.getRandomValues(n);return typeof e=="function"?process.nextTick(function(){e(null,n)}):n}var rE=Op.exports,Ap={exports:{}},mm={exports:{}},vo=typeof Reflect=="object"?Reflect:null,v1=vo&&typeof vo.apply=="function"?vo.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},Pu;vo&&typeof vo.ownKeys=="function"?Pu=vo.ownKeys:Object.getOwnPropertySymbols?Pu=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Pu=function(e){return Object.getOwnPropertyNames(e)};function oD(t){console&&console.warn&&console.warn(t)}var iE=Number.isNaN||function(e){return e!==e};function Ce(){Ce.init.call(this)}mm.exports=Ce;mm.exports.once=cD;Ce.EventEmitter=Ce;Ce.prototype._events=void 0;Ce.prototype._eventsCount=0;Ce.prototype._maxListeners=void 0;var k1=10;function wf(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Ce,"defaultMaxListeners",{enumerable:!0,get:function(){return k1},set:function(t){if(typeof t!="number"||t<0||iE(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");k1=t}});Ce.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ce.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||iE(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function sE(t){return t._maxListeners===void 0?Ce.defaultMaxListeners:t._maxListeners}Ce.prototype.getMaxListeners=function(){return sE(this)};Ce.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var l=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw l.context=o,l}var a=s[e];if(a===void 0)return!1;if(typeof a=="function")v1(a,this,n);else for(var u=a.length,c=cE(a,u),r=0;r<u;++r)v1(c[r],this,n);return!0};function oE(t,e,n,r){var i,s,o;if(wf(n),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]),o===void 0)o=s[e]=n,++t._eventsCount;else if(typeof o=="function"?o=s[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),i=sE(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=o.length,oD(l)}return t}Ce.prototype.addListener=function(e,n){return oE(this,e,n,!1)};Ce.prototype.on=Ce.prototype.addListener;Ce.prototype.prependListener=function(e,n){return oE(this,e,n,!0)};function lD(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function lE(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=lD.bind(r);return i.listener=n,r.wrapFn=i,i}Ce.prototype.once=function(e,n){return wf(n),this.on(e,lE(this,e,n)),this};Ce.prototype.prependOnceListener=function(e,n){return wf(n),this.prependListener(e,lE(this,e,n)),this};Ce.prototype.removeListener=function(e,n){var r,i,s,o,l;if(wf(n),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){l=r[o].listener,s=o;break}if(s<0)return this;s===0?r.shift():aD(r,s),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,l||n)}return this};Ce.prototype.off=Ce.prototype.removeListener;Ce.prototype.removeAllListeners=function(e){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var s=Object.keys(r),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(e,n[i]);return this};function aE(t,e,n){var r=t._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?uD(i):cE(i,i.length)}Ce.prototype.listeners=function(e){return aE(this,e,!0)};Ce.prototype.rawListeners=function(e){return aE(this,e,!1)};Ce.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):uE.call(t,e)};Ce.prototype.listenerCount=uE;function uE(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}Ce.prototype.eventNames=function(){return this._eventsCount>0?Pu(this._events):[]};function cE(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function aD(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function uD(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function cD(t,e){return new Promise(function(n,r){function i(o){t.removeListener(e,s),r(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),n([].slice.call(arguments))}fE(t,e,s,{once:!0}),e!=="error"&&fD(t,i,{once:!0})})}function fD(t,e,n){typeof t.on=="function"&&fE(t,"error",e,n)}function fE(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){r.once&&t.removeEventListener(e,i),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var ym=mm.exports,hE=ym.EventEmitter;const hD={},dD=Object.freeze(Object.defineProperty({__proto__:null,default:hD},Symbol.toStringTag,{value:"Module"})),Wo=LC(dD);var Dh,_1;function pD(){if(_1)return Dh;_1=1;function t(m,v){var C=Object.keys(m);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(m);v&&(y=y.filter(function(_){return Object.getOwnPropertyDescriptor(m,_).enumerable})),C.push.apply(C,y)}return C}function e(m){for(var v=1;v<arguments.length;v++){var C=arguments[v]!=null?arguments[v]:{};v%2?t(Object(C),!0).forEach(function(y){n(m,y,C[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(C)):t(Object(C)).forEach(function(y){Object.defineProperty(m,y,Object.getOwnPropertyDescriptor(C,y))})}return m}function n(m,v,C){return v=o(v),v in m?Object.defineProperty(m,v,{value:C,enumerable:!0,configurable:!0,writable:!0}):m[v]=C,m}function r(m,v){if(!(m instanceof v))throw new TypeError("Cannot call a class as a function")}function i(m,v){for(var C=0;C<v.length;C++){var y=v[C];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(m,o(y.key),y)}}function s(m,v,C){return v&&i(m.prototype,v),C&&i(m,C),Object.defineProperty(m,"prototype",{writable:!1}),m}function o(m){var v=l(m,"string");return typeof v=="symbol"?v:String(v)}function l(m,v){if(typeof m!="object"||m===null)return m;var C=m[Symbol.toPrimitive];if(C!==void 0){var y=C.call(m,v||"default");if(typeof y!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return(v==="string"?String:Number)(m)}var a=Ms,u=a.Buffer,c=Wo,f=c.inspect,h=f&&f.custom||"inspect";function p(m,v,C){u.prototype.copy.call(m,v,C)}return Dh=function(){function m(){r(this,m),this.head=null,this.tail=null,this.length=0}return s(m,[{key:"push",value:function(C){var y={data:C,next:null};this.length>0?this.tail.next=y:this.head=y,this.tail=y,++this.length}},{key:"unshift",value:function(C){var y={data:C,next:this.head};this.length===0&&(this.tail=y),this.head=y,++this.length}},{key:"shift",value:function(){if(this.length!==0){var C=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,C}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(C){if(this.length===0)return"";for(var y=this.head,_=""+y.data;y=y.next;)_+=C+y.data;return _}},{key:"concat",value:function(C){if(this.length===0)return u.alloc(0);for(var y=u.allocUnsafe(C>>>0),_=this.head,x=0;_;)p(_.data,y,x),x+=_.data.length,_=_.next;return y}},{key:"consume",value:function(C,y){var _;return C<this.head.data.length?(_=this.head.data.slice(0,C),this.head.data=this.head.data.slice(C)):C===this.head.data.length?_=this.shift():_=y?this._getString(C):this._getBuffer(C),_}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(C){var y=this.head,_=1,x=y.data;for(C-=x.length;y=y.next;){var O=y.data,R=C>O.length?O.length:C;if(R===O.length?x+=O:x+=O.slice(0,C),C-=R,C===0){R===O.length?(++_,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=O.slice(R));break}++_}return this.length-=_,x}},{key:"_getBuffer",value:function(C){var y=u.allocUnsafe(C),_=this.head,x=1;for(_.data.copy(y),C-=_.data.length;_=_.next;){var O=_.data,R=C>O.length?O.length:C;if(O.copy(y,y.length-C,0,R),C-=R,C===0){R===O.length?(++x,_.next?this.head=_.next:this.head=this.tail=null):(this.head=_,_.data=O.slice(R));break}++x}return this.length-=x,y}},{key:h,value:function(C,y){return f(this,e(e({},y),{},{depth:0,customInspect:!1}))}}]),m}(),Dh}function gD(t,e){var n=this,r=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return r||i?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(Np,this,t)):process.nextTick(Np,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(s){!e&&s?n._writableState?n._writableState.errorEmitted?process.nextTick(Lu,n):(n._writableState.errorEmitted=!0,process.nextTick(E1,n,s)):process.nextTick(E1,n,s):e?(process.nextTick(Lu,n),e(s)):process.nextTick(Lu,n)}),this)}function E1(t,e){Np(t,e),Lu(t)}function Lu(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function mD(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function Np(t,e){t.emit("error",e)}function yD(t,e){var n=t._readableState,r=t._writableState;n&&n.autoDestroy||r&&r.autoDestroy?t.destroy(e):t.emit("error",e)}var dE={destroy:gD,undestroy:mD,errorOrDestroy:yD},Ds={};function wD(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var pE={};function Ln(t,e,n){n||(n=Error);function r(s,o,l){return typeof e=="string"?e:e(s,o,l)}var i=function(s){wD(o,s);function o(l,a,u){return s.call(this,r(l,a,u))||this}return o}(n);i.prototype.name=n.name,i.prototype.code=t,pE[t]=i}function C1(t,e){if(Array.isArray(t)){var n=t.length;return t=t.map(function(r){return String(r)}),n>2?"one of ".concat(e," ").concat(t.slice(0,n-1).join(", "),", or ")+t[n-1]:n===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}else return"of ".concat(e," ").concat(String(t))}function SD(t,e,n){return t.substr(!n||n<0?0:+n,e.length)===e}function vD(t,e,n){return(n===void 0||n>t.length)&&(n=t.length),t.substring(n-e.length,n)===e}function kD(t,e,n){return typeof n!="number"&&(n=0),n+e.length>t.length?!1:t.indexOf(e,n)!==-1}Ln("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);Ln("ERR_INVALID_ARG_TYPE",function(t,e,n){var r;typeof e=="string"&&SD(e,"not ")?(r="must not be",e=e.replace(/^not /,"")):r="must be";var i;if(vD(t," argument"))i="The ".concat(t," ").concat(r," ").concat(C1(e,"type"));else{var s=kD(t,".")?"property":"argument";i='The "'.concat(t,'" ').concat(s," ").concat(r," ").concat(C1(e,"type"))}return i+=". Received type ".concat(typeof n),i},TypeError);Ln("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");Ln("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});Ln("ERR_STREAM_PREMATURE_CLOSE","Premature close");Ln("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});Ln("ERR_MULTIPLE_CALLBACK","Callback called multiple times");Ln("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");Ln("ERR_STREAM_WRITE_AFTER_END","write after end");Ln("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Ln("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);Ln("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");Ds.codes=pE;var _D=Ds.codes.ERR_INVALID_OPT_VALUE;function ED(t,e,n){return t.highWaterMark!=null?t.highWaterMark:e?t[n]:null}function CD(t,e,n,r){var i=ED(e,r,n);if(i!=null){if(!(isFinite(i)&&Math.floor(i)===i)||i<0){var s=r?n:"highWaterMark";throw new _D(s,i)}return Math.floor(i)}return t.objectMode?16:16*1024}var gE={getHighWaterMark:CD},Mp={exports:{}};typeof Object.create=="function"?Mp.exports=function(e,n){n&&(e.super_=n,e.prototype=Object.create(n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:Mp.exports=function(e,n){if(n){e.super_=n;var r=function(){};r.prototype=n.prototype,e.prototype=new r,e.prototype.constructor=e}};var Ma=Mp.exports,bD=xD;function xD(t,e){if(Bh("noDeprecation"))return t;var n=!1;function r(){if(!n){if(Bh("throwDeprecation"))throw new Error(e);Bh("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}return r}function Bh(t){try{if(!de.localStorage)return!1}catch{return!1}var e=de.localStorage[t];return e==null?!1:String(e).toLowerCase()==="true"}var Ph,b1;function mE(){if(b1)return Ph;b1=1,Ph=V;function t(D){var M=this;this.next=null,this.entry=null,this.finish=function(){Sn(M,D)}}var e;V.WritableState=P;var n={deprecate:bD},r=hE,i=Ms.Buffer,s=(typeof de<"u"?de:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function o(D){return i.from(D)}function l(D){return i.isBuffer(D)||D instanceof s}var a=dE,u=gE,c=u.getHighWaterMark,f=Ds.codes,h=f.ERR_INVALID_ARG_TYPE,p=f.ERR_METHOD_NOT_IMPLEMENTED,m=f.ERR_MULTIPLE_CALLBACK,v=f.ERR_STREAM_CANNOT_PIPE,C=f.ERR_STREAM_DESTROYED,y=f.ERR_STREAM_NULL_VALUES,_=f.ERR_STREAM_WRITE_AFTER_END,x=f.ERR_UNKNOWN_ENCODING,O=a.errorOrDestroy;Ma(V,r);function R(){}function P(D,M,W){e=e||Bo(),D=D||{},typeof W!="boolean"&&(W=M instanceof e),this.objectMode=!!D.objectMode,W&&(this.objectMode=this.objectMode||!!D.writableObjectMode),this.highWaterMark=c(this,D,"writableHighWaterMark",W),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var ee=D.decodeStrings===!1;this.decodeStrings=!ee,this.defaultEncoding=D.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(ce){vt(M,ce)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=D.emitClose!==!1,this.autoDestroy=!!D.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new t(this)}P.prototype.getBuffer=function(){for(var M=this.bufferedRequest,W=[];M;)W.push(M),M=M.next;return W},function(){try{Object.defineProperty(P.prototype,"buffer",{get:n.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var F;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(F=Function.prototype[Symbol.hasInstance],Object.defineProperty(V,Symbol.hasInstance,{value:function(M){return F.call(this,M)?!0:this!==V?!1:M&&M._writableState instanceof P}})):F=function(M){return M instanceof this};function V(D){e=e||Bo();var M=this instanceof e;if(!M&&!F.call(V,this))return new V(D);this._writableState=new P(D,this,M),this.writable=!0,D&&(typeof D.write=="function"&&(this._write=D.write),typeof D.writev=="function"&&(this._writev=D.writev),typeof D.destroy=="function"&&(this._destroy=D.destroy),typeof D.final=="function"&&(this._final=D.final)),r.call(this)}V.prototype.pipe=function(){O(this,new v)};function z(D,M){var W=new _;O(D,W),process.nextTick(M,W)}function Q(D,M,W,ee){var ce;return W===null?ce=new y:typeof W!="string"&&!M.objectMode&&(ce=new h("chunk",["string","Buffer"],W)),ce?(O(D,ce),process.nextTick(ee,ce),!1):!0}V.prototype.write=function(D,M,W){var ee=this._writableState,ce=!1,T=!ee.objectMode&&l(D);return T&&!i.isBuffer(D)&&(D=o(D)),typeof M=="function"&&(W=M,M=null),T?M="buffer":M||(M=ee.defaultEncoding),typeof W!="function"&&(W=R),ee.ending?z(this,W):(T||Q(this,ee,D,W))&&(ee.pendingcb++,ce=nt(this,ee,T,D,M,W)),ce},V.prototype.cork=function(){this._writableState.corked++},V.prototype.uncork=function(){var D=this._writableState;D.corked&&(D.corked--,!D.writing&&!D.corked&&!D.bufferProcessing&&D.bufferedRequest&&te(this,D))},V.prototype.setDefaultEncoding=function(M){if(typeof M=="string"&&(M=M.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((M+"").toLowerCase())>-1))throw new x(M);return this._writableState.defaultEncoding=M,this},Object.defineProperty(V.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function ye(D,M,W){return!D.objectMode&&D.decodeStrings!==!1&&typeof M=="string"&&(M=i.from(M,W)),M}Object.defineProperty(V.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function nt(D,M,W,ee,ce,T){if(!W){var I=ye(M,ee,ce);ee!==I&&(W=!0,ce="buffer",ee=I)}var j=M.objectMode?1:ee.length;M.length+=j;var Y=M.length<M.highWaterMark;if(Y||(M.needDrain=!0),M.writing||M.corked){var Ie=M.lastBufferedRequest;M.lastBufferedRequest={chunk:ee,encoding:ce,isBuf:W,callback:T,next:null},Ie?Ie.next=M.lastBufferedRequest:M.bufferedRequest=M.lastBufferedRequest,M.bufferedRequestCount+=1}else We(D,M,!1,j,ee,ce,T);return Y}function We(D,M,W,ee,ce,T,I){M.writelen=ee,M.writecb=I,M.writing=!0,M.sync=!0,M.destroyed?M.onwrite(new C("write")):W?D._writev(ce,M.onwrite):D._write(ce,T,M.onwrite),M.sync=!1}function rt(D,M,W,ee,ce){--M.pendingcb,W?(process.nextTick(ce,ee),process.nextTick(ht,D,M),D._writableState.errorEmitted=!0,O(D,ee)):(ce(ee),D._writableState.errorEmitted=!0,O(D,ee),ht(D,M))}function Kt(D){D.writing=!1,D.writecb=null,D.length-=D.writelen,D.writelen=0}function vt(D,M){var W=D._writableState,ee=W.sync,ce=W.writecb;if(typeof ce!="function")throw new m;if(Kt(W),M)rt(D,W,ee,M,ce);else{var T=re(W)||D.destroyed;!T&&!W.corked&&!W.bufferProcessing&&W.bufferedRequest&&te(D,W),ee?process.nextTick(qe,D,W,T,ce):qe(D,W,T,ce)}}function qe(D,M,W,ee){W||K(D,M),M.pendingcb--,ee(),ht(D,M)}function K(D,M){M.length===0&&M.needDrain&&(M.needDrain=!1,D.emit("drain"))}function te(D,M){M.bufferProcessing=!0;var W=M.bufferedRequest;if(D._writev&&W&&W.next){var ee=M.bufferedRequestCount,ce=new Array(ee),T=M.corkedRequestsFree;T.entry=W;for(var I=0,j=!0;W;)ce[I]=W,W.isBuf||(j=!1),W=W.next,I+=1;ce.allBuffers=j,We(D,M,!0,M.length,ce,"",T.finish),M.pendingcb++,M.lastBufferedRequest=null,T.next?(M.corkedRequestsFree=T.next,T.next=null):M.corkedRequestsFree=new t(M),M.bufferedRequestCount=0}else{for(;W;){var Y=W.chunk,Ie=W.encoding,fe=W.callback,Se=M.objectMode?1:Y.length;if(We(D,M,!1,Se,Y,Ie,fe),W=W.next,M.bufferedRequestCount--,M.writing)break}W===null&&(M.lastBufferedRequest=null)}M.bufferedRequest=W,M.bufferProcessing=!1}V.prototype._write=function(D,M,W){W(new p("_write()"))},V.prototype._writev=null,V.prototype.end=function(D,M,W){var ee=this._writableState;return typeof D=="function"?(W=D,D=null,M=null):typeof M=="function"&&(W=M,M=null),D!=null&&this.write(D,M),ee.corked&&(ee.corked=1,this.uncork()),ee.ending||kt(this,ee,W),this},Object.defineProperty(V.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function re(D){return D.ending&&D.length===0&&D.bufferedRequest===null&&!D.finished&&!D.writing}function se(D,M){D._final(function(W){M.pendingcb--,W&&O(D,W),M.prefinished=!0,D.emit("prefinish"),ht(D,M)})}function oe(D,M){!M.prefinished&&!M.finalCalled&&(typeof D._final=="function"&&!M.destroyed?(M.pendingcb++,M.finalCalled=!0,process.nextTick(se,D,M)):(M.prefinished=!0,D.emit("prefinish")))}function ht(D,M){var W=re(M);if(W&&(oe(D,M),M.pendingcb===0&&(M.finished=!0,D.emit("finish"),M.autoDestroy))){var ee=D._readableState;(!ee||ee.autoDestroy&&ee.endEmitted)&&D.destroy()}return W}function kt(D,M,W){M.ending=!0,ht(D,M),W&&(M.finished?process.nextTick(W):D.once("finish",W)),M.ended=!0,D.writable=!1}function Sn(D,M,W){var ee=D.entry;for(D.entry=null;ee;){var ce=ee.callback;M.pendingcb--,ce(W),ee=ee.next}M.corkedRequestsFree.next=D}return Object.defineProperty(V.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(M){this._writableState&&(this._writableState.destroyed=M)}}),V.prototype.destroy=a.destroy,V.prototype._undestroy=a.undestroy,V.prototype._destroy=function(D,M){M(D)},Ph}var Lh,x1;function Bo(){if(x1)return Lh;x1=1;var t=Object.keys||function(u){var c=[];for(var f in u)c.push(f);return c};Lh=o;var e=wE(),n=mE();Ma(o,e);for(var r=t(n.prototype),i=0;i<r.length;i++){var s=r[i];o.prototype[s]||(o.prototype[s]=n.prototype[s])}function o(u){if(!(this instanceof o))return new o(u);e.call(this,u),n.call(this,u),this.allowHalfOpen=!0,u&&(u.readable===!1&&(this.readable=!1),u.writable===!1&&(this.writable=!1),u.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",l)))}Object.defineProperty(o.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(o.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(o.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function l(){this._writableState.ended||process.nextTick(a,this)}function a(u){u.end()}return Object.defineProperty(o.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(c){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=c,this._writableState.destroyed=c)}}),Lh}var Fh={},T1;function I1(){if(T1)return Fh;T1=1;var t=nE.Buffer,e=t.isEncoding||function(y){switch(y=""+y,y&&y.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(y){if(!y)return"utf8";for(var _;;)switch(y){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return y;default:if(_)return;y=(""+y).toLowerCase(),_=!0}}function r(y){var _=n(y);if(typeof _!="string"&&(t.isEncoding===e||!e(y)))throw new Error("Unknown encoding: "+y);return _||y}Fh.StringDecoder=i;function i(y){this.encoding=r(y);var _;switch(this.encoding){case"utf16le":this.text=f,this.end=h,_=4;break;case"utf8":this.fillLast=a,_=4;break;case"base64":this.text=p,this.end=m,_=3;break;default:this.write=v,this.end=C;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(_)}i.prototype.write=function(y){if(y.length===0)return"";var _,x;if(this.lastNeed){if(_=this.fillLast(y),_===void 0)return"";x=this.lastNeed,this.lastNeed=0}else x=0;return x<y.length?_?_+this.text(y,x):this.text(y,x):_||""},i.prototype.end=c,i.prototype.text=u,i.prototype.fillLast=function(y){if(this.lastNeed<=y.length)return y.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);y.copy(this.lastChar,this.lastTotal-this.lastNeed,0,y.length),this.lastNeed-=y.length};function s(y){return y<=127?0:y>>5===6?2:y>>4===14?3:y>>3===30?4:y>>6===2?-1:-2}function o(y,_,x){var O=_.length-1;if(O<x)return 0;var R=s(_[O]);return R>=0?(R>0&&(y.lastNeed=R-1),R):--O<x||R===-2?0:(R=s(_[O]),R>=0?(R>0&&(y.lastNeed=R-2),R):--O<x||R===-2?0:(R=s(_[O]),R>=0?(R>0&&(R===2?R=0:y.lastNeed=R-3),R):0))}function l(y,_,x){if((_[0]&192)!==128)return y.lastNeed=0,"";if(y.lastNeed>1&&_.length>1){if((_[1]&192)!==128)return y.lastNeed=1,"";if(y.lastNeed>2&&_.length>2&&(_[2]&192)!==128)return y.lastNeed=2,""}}function a(y){var _=this.lastTotal-this.lastNeed,x=l(this,y);if(x!==void 0)return x;if(this.lastNeed<=y.length)return y.copy(this.lastChar,_,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);y.copy(this.lastChar,_,0,y.length),this.lastNeed-=y.length}function u(y,_){var x=o(this,y,_);if(!this.lastNeed)return y.toString("utf8",_);this.lastTotal=x;var O=y.length-(x-this.lastNeed);return y.copy(this.lastChar,0,O),y.toString("utf8",_,O)}function c(y){var _=y&&y.length?this.write(y):"";return this.lastNeed?_+"":_}function f(y,_){if((y.length-_)%2===0){var x=y.toString("utf16le",_);if(x){var O=x.charCodeAt(x.length-1);if(O>=55296&&O<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=y[y.length-2],this.lastChar[1]=y[y.length-1],x.slice(0,-1)}return x}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=y[y.length-1],y.toString("utf16le",_,y.length-1)}function h(y){var _=y&&y.length?this.write(y):"";if(this.lastNeed){var x=this.lastTotal-this.lastNeed;return _+this.lastChar.toString("utf16le",0,x)}return _}function p(y,_){var x=(y.length-_)%3;return x===0?y.toString("base64",_):(this.lastNeed=3-x,this.lastTotal=3,x===1?this.lastChar[0]=y[y.length-1]:(this.lastChar[0]=y[y.length-2],this.lastChar[1]=y[y.length-1]),y.toString("base64",_,y.length-x))}function m(y){var _=y&&y.length?this.write(y):"";return this.lastNeed?_+this.lastChar.toString("base64",0,3-this.lastNeed):_}function v(y){return y.toString(this.encoding)}function C(y){return y&&y.length?this.write(y):""}return Fh}var O1=Ds.codes.ERR_STREAM_PREMATURE_CLOSE;function TD(t){var e=!1;return function(){if(!e){e=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t.apply(this,r)}}}function ID(){}function OD(t){return t.setHeader&&typeof t.abort=="function"}function yE(t,e,n){if(typeof e=="function")return yE(t,null,e);e||(e={}),n=TD(n||ID);var r=e.readable||e.readable!==!1&&t.readable,i=e.writable||e.writable!==!1&&t.writable,s=function(){t.writable||l()},o=t._writableState&&t._writableState.finished,l=function(){i=!1,o=!0,r||n.call(t)},a=t._readableState&&t._readableState.endEmitted,u=function(){r=!1,a=!0,i||n.call(t)},c=function(m){n.call(t,m)},f=function(){var m;if(r&&!a)return(!t._readableState||!t._readableState.ended)&&(m=new O1),n.call(t,m);if(i&&!o)return(!t._writableState||!t._writableState.ended)&&(m=new O1),n.call(t,m)},h=function(){t.req.on("finish",l)};return OD(t)?(t.on("complete",l),t.on("abort",f),t.req?h():t.on("request",h)):i&&!t._writableState&&(t.on("end",s),t.on("close",s)),t.on("end",u),t.on("finish",l),e.error!==!1&&t.on("error",c),t.on("close",f),function(){t.removeListener("complete",l),t.removeListener("abort",f),t.removeListener("request",h),t.req&&t.req.removeListener("finish",l),t.removeListener("end",s),t.removeListener("close",s),t.removeListener("finish",l),t.removeListener("end",u),t.removeListener("error",c),t.removeListener("close",f)}}var wm=yE,Uh,R1;function RD(){if(R1)return Uh;R1=1;var t;function e(x,O,R){return O=n(O),O in x?Object.defineProperty(x,O,{value:R,enumerable:!0,configurable:!0,writable:!0}):x[O]=R,x}function n(x){var O=r(x,"string");return typeof O=="symbol"?O:String(O)}function r(x,O){if(typeof x!="object"||x===null)return x;var R=x[Symbol.toPrimitive];if(R!==void 0){var P=R.call(x,O||"default");if(typeof P!="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return(O==="string"?String:Number)(x)}var i=wm,s=Symbol("lastResolve"),o=Symbol("lastReject"),l=Symbol("error"),a=Symbol("ended"),u=Symbol("lastPromise"),c=Symbol("handlePromise"),f=Symbol("stream");function h(x,O){return{value:x,done:O}}function p(x){var O=x[s];if(O!==null){var R=x[f].read();R!==null&&(x[u]=null,x[s]=null,x[o]=null,O(h(R,!1)))}}function m(x){process.nextTick(p,x)}function v(x,O){return function(R,P){x.then(function(){if(O[a]){R(h(void 0,!0));return}O[c](R,P)},P)}}var C=Object.getPrototypeOf(function(){}),y=Object.setPrototypeOf((t={get stream(){return this[f]},next:function(){var O=this,R=this[l];if(R!==null)return Promise.reject(R);if(this[a])return Promise.resolve(h(void 0,!0));if(this[f].destroyed)return new Promise(function(z,Q){process.nextTick(function(){O[l]?Q(O[l]):z(h(void 0,!0))})});var P=this[u],F;if(P)F=new Promise(v(P,this));else{var V=this[f].read();if(V!==null)return Promise.resolve(h(V,!1));F=new Promise(this[c])}return this[u]=F,F}},e(t,Symbol.asyncIterator,function(){return this}),e(t,"return",function(){var O=this;return new Promise(function(R,P){O[f].destroy(null,function(F){if(F){P(F);return}R(h(void 0,!0))})})}),t),C),_=function(O){var R,P=Object.create(y,(R={},e(R,f,{value:O,writable:!0}),e(R,s,{value:null,writable:!0}),e(R,o,{value:null,writable:!0}),e(R,l,{value:null,writable:!0}),e(R,a,{value:O._readableState.endEmitted,writable:!0}),e(R,c,{value:function(V,z){var Q=P[f].read();Q?(P[u]=null,P[s]=null,P[o]=null,V(h(Q,!1))):(P[s]=V,P[o]=z)},writable:!0}),R));return P[u]=null,i(O,function(F){if(F&&F.code!=="ERR_STREAM_PREMATURE_CLOSE"){var V=P[o];V!==null&&(P[u]=null,P[s]=null,P[o]=null,V(F)),P[l]=F;return}var z=P[s];z!==null&&(P[u]=null,P[s]=null,P[o]=null,z(h(void 0,!0))),P[a]=!0}),O.on("readable",m.bind(null,P)),P};return Uh=_,Uh}var zh,A1;function AD(){return A1||(A1=1,zh=function(){throw new Error("Readable.from is not available in the browser")}),zh}var Vh,N1;function wE(){if(N1)return Vh;N1=1,Vh=z;var t;z.ReadableState=V,ym.EventEmitter;var e=function(I,j){return I.listeners(j).length},n=hE,r=Ms.Buffer,i=(typeof de<"u"?de:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function s(T){return r.from(T)}function o(T){return r.isBuffer(T)||T instanceof i}var l=Wo,a;l&&l.debuglog?a=l.debuglog("stream"):a=function(){};var u=pD(),c=dE,f=gE,h=f.getHighWaterMark,p=Ds.codes,m=p.ERR_INVALID_ARG_TYPE,v=p.ERR_STREAM_PUSH_AFTER_EOF,C=p.ERR_METHOD_NOT_IMPLEMENTED,y=p.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,_,x,O;Ma(z,n);var R=c.errorOrDestroy,P=["error","close","destroy","pause","resume"];function F(T,I,j){if(typeof T.prependListener=="function")return T.prependListener(I,j);!T._events||!T._events[I]?T.on(I,j):Array.isArray(T._events[I])?T._events[I].unshift(j):T._events[I]=[j,T._events[I]]}function V(T,I,j){t=t||Bo(),T=T||{},typeof j!="boolean"&&(j=I instanceof t),this.objectMode=!!T.objectMode,j&&(this.objectMode=this.objectMode||!!T.readableObjectMode),this.highWaterMark=h(this,T,"readableHighWaterMark",j),this.buffer=new u,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=T.emitClose!==!1,this.autoDestroy=!!T.autoDestroy,this.destroyed=!1,this.defaultEncoding=T.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,T.encoding&&(_||(_=I1().StringDecoder),this.decoder=new _(T.encoding),this.encoding=T.encoding)}function z(T){if(t=t||Bo(),!(this instanceof z))return new z(T);var I=this instanceof t;this._readableState=new V(T,this,I),this.readable=!0,T&&(typeof T.read=="function"&&(this._read=T.read),typeof T.destroy=="function"&&(this._destroy=T.destroy)),n.call(this)}Object.defineProperty(z.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(I){this._readableState&&(this._readableState.destroyed=I)}}),z.prototype.destroy=c.destroy,z.prototype._undestroy=c.undestroy,z.prototype._destroy=function(T,I){I(T)},z.prototype.push=function(T,I){var j=this._readableState,Y;return j.objectMode?Y=!0:typeof T=="string"&&(I=I||j.defaultEncoding,I!==j.encoding&&(T=r.from(T,I),I=""),Y=!0),Q(this,T,I,!1,Y)},z.prototype.unshift=function(T){return Q(this,T,null,!0,!1)};function Q(T,I,j,Y,Ie){a("readableAddChunk",I);var fe=T._readableState;if(I===null)fe.reading=!1,vt(T,fe);else{var Se;if(Ie||(Se=nt(fe,I)),Se)R(T,Se);else if(fe.objectMode||I&&I.length>0)if(typeof I!="string"&&!fe.objectMode&&Object.getPrototypeOf(I)!==r.prototype&&(I=s(I)),Y)fe.endEmitted?R(T,new y):ye(T,fe,I,!0);else if(fe.ended)R(T,new v);else{if(fe.destroyed)return!1;fe.reading=!1,fe.decoder&&!j?(I=fe.decoder.write(I),fe.objectMode||I.length!==0?ye(T,fe,I,!1):te(T,fe)):ye(T,fe,I,!1)}else Y||(fe.reading=!1,te(T,fe))}return!fe.ended&&(fe.length<fe.highWaterMark||fe.length===0)}function ye(T,I,j,Y){I.flowing&&I.length===0&&!I.sync?(I.awaitDrain=0,T.emit("data",j)):(I.length+=I.objectMode?1:j.length,Y?I.buffer.unshift(j):I.buffer.push(j),I.needReadable&&qe(T)),te(T,I)}function nt(T,I){var j;return!o(I)&&typeof I!="string"&&I!==void 0&&!T.objectMode&&(j=new m("chunk",["string","Buffer","Uint8Array"],I)),j}z.prototype.isPaused=function(){return this._readableState.flowing===!1},z.prototype.setEncoding=function(T){_||(_=I1().StringDecoder);var I=new _(T);this._readableState.decoder=I,this._readableState.encoding=this._readableState.decoder.encoding;for(var j=this._readableState.buffer.head,Y="";j!==null;)Y+=I.write(j.data),j=j.next;return this._readableState.buffer.clear(),Y!==""&&this._readableState.buffer.push(Y),this._readableState.length=Y.length,this};var We=1073741824;function rt(T){return T>=We?T=We:(T--,T|=T>>>1,T|=T>>>2,T|=T>>>4,T|=T>>>8,T|=T>>>16,T++),T}function Kt(T,I){return T<=0||I.length===0&&I.ended?0:I.objectMode?1:T!==T?I.flowing&&I.length?I.buffer.head.data.length:I.length:(T>I.highWaterMark&&(I.highWaterMark=rt(T)),T<=I.length?T:I.ended?I.length:(I.needReadable=!0,0))}z.prototype.read=function(T){a("read",T),T=parseInt(T,10);var I=this._readableState,j=T;if(T!==0&&(I.emittedReadable=!1),T===0&&I.needReadable&&((I.highWaterMark!==0?I.length>=I.highWaterMark:I.length>0)||I.ended))return a("read: emitReadable",I.length,I.ended),I.length===0&&I.ended?W(this):qe(this),null;if(T=Kt(T,I),T===0&&I.ended)return I.length===0&&W(this),null;var Y=I.needReadable;a("need readable",Y),(I.length===0||I.length-T<I.highWaterMark)&&(Y=!0,a("length less than watermark",Y)),I.ended||I.reading?(Y=!1,a("reading or ended",Y)):Y&&(a("do read"),I.reading=!0,I.sync=!0,I.length===0&&(I.needReadable=!0),this._read(I.highWaterMark),I.sync=!1,I.reading||(T=Kt(j,I)));var Ie;return T>0?Ie=M(T,I):Ie=null,Ie===null?(I.needReadable=I.length<=I.highWaterMark,T=0):(I.length-=T,I.awaitDrain=0),I.length===0&&(I.ended||(I.needReadable=!0),j!==T&&I.ended&&W(this)),Ie!==null&&this.emit("data",Ie),Ie};function vt(T,I){if(a("onEofChunk"),!I.ended){if(I.decoder){var j=I.decoder.end();j&&j.length&&(I.buffer.push(j),I.length+=I.objectMode?1:j.length)}I.ended=!0,I.sync?qe(T):(I.needReadable=!1,I.emittedReadable||(I.emittedReadable=!0,K(T)))}}function qe(T){var I=T._readableState;a("emitReadable",I.needReadable,I.emittedReadable),I.needReadable=!1,I.emittedReadable||(a("emitReadable",I.flowing),I.emittedReadable=!0,process.nextTick(K,T))}function K(T){var I=T._readableState;a("emitReadable_",I.destroyed,I.length,I.ended),!I.destroyed&&(I.length||I.ended)&&(T.emit("readable"),I.emittedReadable=!1),I.needReadable=!I.flowing&&!I.ended&&I.length<=I.highWaterMark,D(T)}function te(T,I){I.readingMore||(I.readingMore=!0,process.nextTick(re,T,I))}function re(T,I){for(;!I.reading&&!I.ended&&(I.length<I.highWaterMark||I.flowing&&I.length===0);){var j=I.length;if(a("maybeReadMore read 0"),T.read(0),j===I.length)break}I.readingMore=!1}z.prototype._read=function(T){R(this,new C("_read()"))},z.prototype.pipe=function(T,I){var j=this,Y=this._readableState;switch(Y.pipesCount){case 0:Y.pipes=T;break;case 1:Y.pipes=[Y.pipes,T];break;default:Y.pipes.push(T);break}Y.pipesCount+=1,a("pipe count=%d opts=%j",Y.pipesCount,I);var Ie=(!I||I.end!==!1)&&T!==process.stdout&&T!==process.stderr,fe=Ie?ir:Er;Y.endEmitted?process.nextTick(fe):j.once("end",fe),T.on("unpipe",Se);function Se(k,d){a("onunpipe"),k===j&&d&&d.hasUnpiped===!1&&(d.hasUnpiped=!0,Yr())}function ir(){a("onend"),T.end()}var Jr=se(j);T.on("drain",Jr);var ji=!1;function Yr(){a("cleanup"),T.removeListener("close",Hi),T.removeListener("finish",Gt),T.removeListener("drain",Jr),T.removeListener("error",_r),T.removeListener("unpipe",Se),j.removeListener("end",ir),j.removeListener("end",Er),j.removeListener("data",Nt),ji=!0,Y.awaitDrain&&(!T._writableState||T._writableState.needDrain)&&Jr()}j.on("data",Nt);function Nt(k){a("ondata");var d=T.write(k);a("dest.write",d),d===!1&&((Y.pipesCount===1&&Y.pipes===T||Y.pipesCount>1&&ce(Y.pipes,T)!==-1)&&!ji&&(a("false write response, pause",Y.awaitDrain),Y.awaitDrain++),j.pause())}function _r(k){a("onerror",k),Er(),T.removeListener("error",_r),e(T,"error")===0&&R(T,k)}F(T,"error",_r);function Hi(){T.removeListener("finish",Gt),Er()}T.once("close",Hi);function Gt(){a("onfinish"),T.removeListener("close",Hi),Er()}T.once("finish",Gt);function Er(){a("unpipe"),j.unpipe(T)}return T.emit("pipe",j),Y.flowing||(a("pipe resume"),j.resume()),T};function se(T){return function(){var j=T._readableState;a("pipeOnDrain",j.awaitDrain),j.awaitDrain&&j.awaitDrain--,j.awaitDrain===0&&e(T,"data")&&(j.flowing=!0,D(T))}}z.prototype.unpipe=function(T){var I=this._readableState,j={hasUnpiped:!1};if(I.pipesCount===0)return this;if(I.pipesCount===1)return T&&T!==I.pipes?this:(T||(T=I.pipes),I.pipes=null,I.pipesCount=0,I.flowing=!1,T&&T.emit("unpipe",this,j),this);if(!T){var Y=I.pipes,Ie=I.pipesCount;I.pipes=null,I.pipesCount=0,I.flowing=!1;for(var fe=0;fe<Ie;fe++)Y[fe].emit("unpipe",this,{hasUnpiped:!1});return this}var Se=ce(I.pipes,T);return Se===-1?this:(I.pipes.splice(Se,1),I.pipesCount-=1,I.pipesCount===1&&(I.pipes=I.pipes[0]),T.emit("unpipe",this,j),this)},z.prototype.on=function(T,I){var j=n.prototype.on.call(this,T,I),Y=this._readableState;return T==="data"?(Y.readableListening=this.listenerCount("readable")>0,Y.flowing!==!1&&this.resume()):T==="readable"&&!Y.endEmitted&&!Y.readableListening&&(Y.readableListening=Y.needReadable=!0,Y.flowing=!1,Y.emittedReadable=!1,a("on readable",Y.length,Y.reading),Y.length?qe(this):Y.reading||process.nextTick(ht,this)),j},z.prototype.addListener=z.prototype.on,z.prototype.removeListener=function(T,I){var j=n.prototype.removeListener.call(this,T,I);return T==="readable"&&process.nextTick(oe,this),j},z.prototype.removeAllListeners=function(T){var I=n.prototype.removeAllListeners.apply(this,arguments);return(T==="readable"||T===void 0)&&process.nextTick(oe,this),I};function oe(T){var I=T._readableState;I.readableListening=T.listenerCount("readable")>0,I.resumeScheduled&&!I.paused?I.flowing=!0:T.listenerCount("data")>0&&T.resume()}function ht(T){a("readable nexttick read 0"),T.read(0)}z.prototype.resume=function(){var T=this._readableState;return T.flowing||(a("resume"),T.flowing=!T.readableListening,kt(this,T)),T.paused=!1,this};function kt(T,I){I.resumeScheduled||(I.resumeScheduled=!0,process.nextTick(Sn,T,I))}function Sn(T,I){a("resume",I.reading),I.reading||T.read(0),I.resumeScheduled=!1,T.emit("resume"),D(T),I.flowing&&!I.reading&&T.read(0)}z.prototype.pause=function(){return a("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(a("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function D(T){var I=T._readableState;for(a("flow",I.flowing);I.flowing&&T.read()!==null;);}z.prototype.wrap=function(T){var I=this,j=this._readableState,Y=!1;T.on("end",function(){if(a("wrapped end"),j.decoder&&!j.ended){var Se=j.decoder.end();Se&&Se.length&&I.push(Se)}I.push(null)}),T.on("data",function(Se){if(a("wrapped data"),j.decoder&&(Se=j.decoder.write(Se)),!(j.objectMode&&Se==null)&&!(!j.objectMode&&(!Se||!Se.length))){var ir=I.push(Se);ir||(Y=!0,T.pause())}});for(var Ie in T)this[Ie]===void 0&&typeof T[Ie]=="function"&&(this[Ie]=function(ir){return function(){return T[ir].apply(T,arguments)}}(Ie));for(var fe=0;fe<P.length;fe++)T.on(P[fe],this.emit.bind(this,P[fe]));return this._read=function(Se){a("wrapped _read",Se),Y&&(Y=!1,T.resume())},this},typeof Symbol=="function"&&(z.prototype[Symbol.asyncIterator]=function(){return x===void 0&&(x=RD()),x(this)}),Object.defineProperty(z.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(z.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(z.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(I){this._readableState&&(this._readableState.flowing=I)}}),z._fromList=M,Object.defineProperty(z.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function M(T,I){if(I.length===0)return null;var j;return I.objectMode?j=I.buffer.shift():!T||T>=I.length?(I.decoder?j=I.buffer.join(""):I.buffer.length===1?j=I.buffer.first():j=I.buffer.concat(I.length),I.buffer.clear()):j=I.buffer.consume(T,I.decoder),j}function W(T){var I=T._readableState;a("endReadable",I.endEmitted),I.endEmitted||(I.ended=!0,process.nextTick(ee,I,T))}function ee(T,I){if(a("endReadableNT",T.endEmitted,T.length),!T.endEmitted&&T.length===0&&(T.endEmitted=!0,I.readable=!1,I.emit("end"),T.autoDestroy)){var j=I._writableState;(!j||j.autoDestroy&&j.finished)&&I.destroy()}}typeof Symbol=="function"&&(z.from=function(T,I){return O===void 0&&(O=AD()),O(z,T,I)});function ce(T,I){for(var j=0,Y=T.length;j<Y;j++)if(T[j]===I)return j;return-1}return Vh}var SE=Wr,Sf=Ds.codes,ND=Sf.ERR_METHOD_NOT_IMPLEMENTED,MD=Sf.ERR_MULTIPLE_CALLBACK,DD=Sf.ERR_TRANSFORM_ALREADY_TRANSFORMING,BD=Sf.ERR_TRANSFORM_WITH_LENGTH_0,vf=Bo();Ma(Wr,vf);function PD(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(r===null)return this.emit("error",new MD);n.writechunk=null,n.writecb=null,e!=null&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function Wr(t){if(!(this instanceof Wr))return new Wr(t);vf.call(this,t),this._transformState={afterTransform:PD.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",LD)}function LD(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,n){M1(t,e,n)}):M1(this,null,null)}Wr.prototype.push=function(t,e){return this._transformState.needTransform=!1,vf.prototype.push.call(this,t,e)};Wr.prototype._transform=function(t,e,n){n(new ND("_transform()"))};Wr.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}};Wr.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};Wr.prototype._destroy=function(t,e){vf.prototype._destroy.call(this,t,function(n){e(n)})};function M1(t,e,n){if(e)return t.emit("error",e);if(n!=null&&t.push(n),t._writableState.length)throw new BD;if(t._transformState.transforming)throw new DD;return t.push(null)}var FD=wa,vE=SE;Ma(wa,vE);function wa(t){if(!(this instanceof wa))return new wa(t);vE.call(this,t)}wa.prototype._transform=function(t,e,n){n(null,t)};var jh;function UD(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var kE=Ds.codes,zD=kE.ERR_MISSING_ARGS,VD=kE.ERR_STREAM_DESTROYED;function D1(t){if(t)throw t}function jD(t){return t.setHeader&&typeof t.abort=="function"}function HD(t,e,n,r){r=UD(r);var i=!1;t.on("close",function(){i=!0}),jh===void 0&&(jh=wm),jh(t,{readable:e,writable:n},function(o){if(o)return r(o);i=!0,r()});var s=!1;return function(o){if(!i&&!s){if(s=!0,jD(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();r(o||new VD("pipe"))}}}function B1(t){t()}function $D(t,e){return t.pipe(e)}function WD(t){return!t.length||typeof t[t.length-1]!="function"?D1:t.pop()}function qD(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=WD(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new zD("streams");var i,s=e.map(function(o,l){var a=l<e.length-1,u=l>0;return HD(o,a,u,function(c){i||(i=c),c&&s.forEach(B1),!a&&(s.forEach(B1),r(i))})});return e.reduce($D)}var KD=qD;(function(t,e){e=t.exports=wE(),e.Stream=e,e.Readable=e,e.Writable=mE(),e.Duplex=Bo(),e.Transform=SE,e.PassThrough=FD,e.finished=wm,e.pipeline=KD})(Ap,Ap.exports);var _E=Ap.exports;/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let P1;var EE=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:de):t=>(P1||(P1=Promise.resolve())).then(t).catch(e=>setTimeout(()=>{throw e},0));function L1(t,e){for(const n in e)Object.defineProperty(t,n,{value:e[n],enumerable:!0,configurable:!0});return t}function GD(t,e,n){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");n||(n={}),typeof e=="object"&&(n=e,e=""),e&&(n.code=e);try{return L1(t,n)}catch{n.message=t.message,n.stack=t.stack;const i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),L1(new i,n)}}var JD=GD;/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const YD=eE("simple-peer"),CE=KM,F1=rE,QD=_E,Hh=EE,ge=JD,{Buffer:ZD}=Ms,$h=64*1024,XD=5*1e3,eB=5*1e3;function U1(t){return t.replace(/a=ice-options:trickle\s\n/g,"")}function tB(t){console.warn(t)}class Ts extends QD.Duplex{constructor(e){if(e=Object.assign({allowHalfOpen:!1},e),super(e),this._id=F1(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||F1(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||Ts.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},Ts.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(n=>n),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||XD,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&typeof e.wrtc=="object"?e.wrtc:CE(),!this._wrtc)throw ge(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(n){this.destroy(ge(n,"ERR_PC_CONSTRUCTOR"));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=n=>{this._onIceCandidate(n)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(n=>{this.destroy(ge(n,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=n=>{this._setupData(n)},this.streams&&this.streams.forEach(n=>{this.addStream(n)}),this._pc.ontrack=n=>{this._onTrack(n)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(!this.destroying){if(this.destroyed)throw ge(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof e=="string")try{e=JSON.parse(e)}catch{e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(n=>{this._addIceCandidate(n)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(n=>{this.destroy(ge(n,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.destroy(ge(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(e){const n=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(n).catch(r=>{!n.address||n.address.endsWith(".local")?tB("Ignoring unsupported ICE candidate."):this.destroy(ge(r,"ERR_ADD_ICE_CANDIDATE"))})}send(e){if(!this.destroying){if(this.destroyed)throw ge(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(e)}}addTransceiver(e,n){if(!this.destroying){if(this.destroyed)throw ge(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,n),this._needsNegotiation()}catch(r){this.destroy(ge(r,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:e,init:n}})}}addStream(e){if(!this.destroying){if(this.destroyed)throw ge(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),e.getTracks().forEach(n=>{this.addTrack(n,e)})}}addTrack(e,n){if(this.destroying)return;if(this.destroyed)throw ge(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const r=this._senderMap.get(e)||new Map;let i=r.get(n);if(!i)i=this._pc.addTrack(e,n),r.set(n,i),this._senderMap.set(e,r),this._needsNegotiation();else throw i.removed?ge(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):ge(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(e,n,r){if(this.destroying)return;if(this.destroyed)throw ge(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const i=this._senderMap.get(e),s=i?i.get(r):null;if(!s)throw ge(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");n&&this._senderMap.set(n,i),s.replaceTrack!=null?s.replaceTrack(n):this.destroy(ge(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,n){if(this.destroying)return;if(this.destroyed)throw ge(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const r=this._senderMap.get(e),i=r?r.get(n):null;if(!i)throw ge(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{i.removed=!0,this._pc.removeTrack(i)}catch(s){s.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(i):this.destroy(ge(s,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){if(!this.destroying){if(this.destroyed)throw ge(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),e.getTracks().forEach(n=>{this.removeTrack(n,e)})}}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,Hh(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw ge(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(e){this._destroy(e,()=>{})}_destroy(e,n){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",e&&(e.message||e)),Hh(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),n()}))}_setupData(e){if(!e.channel)return this.destroy(ge(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=$h),this.channelName=this._channel.label,this._channel.onmessage=r=>{this._onChannelMessage(r)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=r=>{const i=r.error instanceof Error?r.error:new Error(`Datachannel error: ${r.message} ${r.filename}:${r.lineno}:${r.colno}`);this.destroy(ge(i,"ERR_DATA_CHANNEL"))};let n=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(n&&this._onChannelClose(),n=!0):n=!1},eB)}_read(){}_write(e,n,r){if(this.destroyed)return r(ge(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(i){return this.destroy(ge(i,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>$h?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=r):r(null)}else this._debug("write before connect"),this._chunk=e,this._cb=r}_onFinish(){if(this.destroyed)return;const e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=U1(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const n=()=>{if(this.destroyed)return;const s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp})},r=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?n():this.once("_iceComplete",n))},i=s=>{this.destroy(ge(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(r).catch(i)}).catch(e=>{this.destroy(ge(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{!e.mid&&e.sender.track&&!e.requested&&(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=U1(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const n=()=>{if(this.destroyed)return;const s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp}),this.initiator||this._requestMissingTransceivers()},r=()=>{this.destroyed||(this.trickle||this._iceComplete?n():this.once("_iceComplete",n))},i=s=>{this.destroy(ge(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(r).catch(i)}).catch(e=>{this.destroy(ge(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(ge(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const e=this._pc.iceConnectionState,n=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,n),this.emit("iceStateChange",e,n),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.destroy(ge(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.destroy(ge(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(e){const n=r=>(Object.prototype.toString.call(r.values)==="[object Array]"&&r.values.forEach(i=>{Object.assign(r,i)}),r);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(r=>{const i=[];r.forEach(s=>{i.push(n(s))}),e(null,i)},r=>e(r)):this._pc.getStats.length>0?this._pc.getStats(r=>{if(this.destroyed)return;const i=[];r.result().forEach(s=>{const o={};s.names().forEach(l=>{o[l]=s.stat(l)}),o.id=s.id,o.type=s.type,o.timestamp=s.timestamp,i.push(n(o))}),e(null,i)},r=>e(r)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const e=()=>{this.destroyed||this.getStats((n,r)=>{if(this.destroyed)return;n&&(r=[]);const i={},s={},o={};let l=!1;r.forEach(u=>{(u.type==="remotecandidate"||u.type==="remote-candidate")&&(i[u.id]=u),(u.type==="localcandidate"||u.type==="local-candidate")&&(s[u.id]=u),(u.type==="candidatepair"||u.type==="candidate-pair")&&(o[u.id]=u)});const a=u=>{l=!0;let c=s[u.localCandidateId];c&&(c.ip||c.address)?(this.localAddress=c.ip||c.address,this.localPort=Number(c.port)):c&&c.ipAddress?(this.localAddress=c.ipAddress,this.localPort=Number(c.portNumber)):typeof u.googLocalAddress=="string"&&(c=u.googLocalAddress.split(":"),this.localAddress=c[0],this.localPort=Number(c[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let f=i[u.remoteCandidateId];f&&(f.ip||f.address)?(this.remoteAddress=f.ip||f.address,this.remotePort=Number(f.port)):f&&f.ipAddress?(this.remoteAddress=f.ipAddress,this.remotePort=Number(f.portNumber)):typeof u.googRemoteAddress=="string"&&(f=u.googRemoteAddress.split(":"),this.remoteAddress=f[0],this.remotePort=Number(f[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(r.forEach(u=>{u.type==="transport"&&u.selectedCandidatePairId&&a(o[u.selectedCandidatePairId]),(u.type==="googCandidatePair"&&u.googActiveConnection==="true"||(u.type==="candidatepair"||u.type==="candidate-pair")&&u.selected)&&a(u)}),!l&&(!Object.keys(o).length||Object.keys(s).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(c){return this.destroy(ge(c,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const u=this._cb;this._cb=null,u(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>$h||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(this.destroyed)return;let n=e.data;n instanceof ArrayBuffer&&(n=ZD.from(n)),this.push(n)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const e=this._cb;this._cb=null,e(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(n=>{this._debug("on track"),this.emit("track",e.track,n),this._remoteTracks.push({track:e.track,stream:n}),!this._remoteStreams.some(r=>r.id===n.id)&&(this._remoteStreams.push(n),Hh(()=>{this._debug("on stream"),this.emit("stream",n)}))})}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],YD.apply(null,e)}}Ts.WEBRTC_SUPPORT=!!CE();Ts.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};Ts.channelConfig={};var nB=Ts;const rB=zc(nB);/*! simple-websocket. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const iB=eE("simple-websocket"),sB=rE,oB=_E,z1=EE,Ml=Wo,fl=typeof Ml!="function"?WebSocket:Ml,V1=64*1024;class bE extends oB.Duplex{constructor(e={}){if(typeof e=="string"&&(e={url:e}),e=Object.assign({allowHalfOpen:!1},e),super(e),e.url==null&&e.socket==null)throw new Error("Missing required `url` or `socket` option");if(e.url!=null&&e.socket!=null)throw new Error("Must specify either `url` or `socket` option, not both");if(this._id=sB(4).toString("hex").slice(0,7),this._debug("new websocket: %o",e),this.connected=!1,this.destroyed=!1,this._chunk=null,this._cb=null,this._interval=null,e.socket)this.url=e.socket.url,this._ws=e.socket,this.connected=e.socket.readyState===fl.OPEN;else{this.url=e.url;try{typeof Ml=="function"?this._ws=new fl(e.url,null,{...e,encoding:void 0}):this._ws=new fl(e.url)}catch(n){z1(()=>this.destroy(n));return}}this._ws.binaryType="arraybuffer",e.socket&&this.connected?z1(()=>this._handleOpen()):this._ws.onopen=()=>this._handleOpen(),this._ws.onmessage=n=>this._handleMessage(n),this._ws.onclose=()=>this._handleClose(),this._ws.onerror=n=>this._handleError(n),this._handleFinishBound=()=>this._handleFinish(),this.once("finish",this._handleFinishBound)}send(e){this._ws.send(e)}destroy(e){this._destroy(e,()=>{})}_destroy(e,n){if(!this.destroyed){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this.connected=!1,this.destroyed=!0,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._handleFinishBound&&this.removeListener("finish",this._handleFinishBound),this._handleFinishBound=null,this._ws){const r=this._ws,i=()=>{r.onclose=null};if(r.readyState===fl.CLOSED)i();else try{r.onclose=i,r.close()}catch{i()}r.onopen=null,r.onmessage=null,r.onerror=()=>{}}this._ws=null,e&&this.emit("error",e),this.emit("close"),n()}}_read(){}_write(e,n,r){if(this.destroyed)return r(new Error("cannot write after socket is destroyed"));if(this.connected){try{this.send(e)}catch(i){return this.destroy(i)}typeof Ml!="function"&&this._ws.bufferedAmount>V1?(this._debug("start backpressure: bufferedAmount %d",this._ws.bufferedAmount),this._cb=r):r(null)}else this._debug("write before connect"),this._chunk=e,this._cb=r}_handleOpen(){if(!(this.connected||this.destroyed)){if(this.connected=!0,this._chunk){try{this.send(this._chunk)}catch(n){return this.destroy(n)}this._chunk=null,this._debug('sent chunk from "write before connect"');const e=this._cb;this._cb=null,e(null)}typeof Ml!="function"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}}_handleMessage(e){if(this.destroyed)return;let n=e.data;n instanceof ArrayBuffer&&(n=Buffer.from(n)),this.push(n)}_handleClose(){this.destroyed||(this._debug("on close"),this.destroy())}_handleError(e){this.destroy(new Error(`Error connecting to ${this.url}`))}_handleFinish(){if(this.destroyed)return;const e=()=>{setTimeout(()=>this.destroy(),1e3)};this.connected?e():this.once("connect",e)}_onInterval(){if(!this._cb||!this._ws||this._ws.bufferedAmount>V1)return;this._debug("ending backpressure: bufferedAmount %d",this._ws.bufferedAmount);const e=this._cb;this._cb=null,e(null)}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],iB.apply(null,e)}}bE.WEBSOCKET_SUPPORT=!!fl;var lB=bE;const aB=zc(lB);var xE={},TE={},Sm={},Gr={};Object.defineProperty(Gr,"__esModule",{value:!0});const IE=Ms,ns={INVALID_ENCODING:"Invalid encoding provided. Please specify a valid encoding the internal Node.js Buffer supports.",INVALID_SMARTBUFFER_SIZE:"Invalid size provided. Size must be a valid integer greater than zero.",INVALID_SMARTBUFFER_BUFFER:"Invalid Buffer provided in SmartBufferOptions.",INVALID_SMARTBUFFER_OBJECT:"Invalid SmartBufferOptions object supplied to SmartBuffer constructor or factory methods.",INVALID_OFFSET:"An invalid offset value was provided.",INVALID_OFFSET_NON_NUMBER:"An invalid offset value was provided. A numeric value is required.",INVALID_LENGTH:"An invalid length value was provided.",INVALID_LENGTH_NON_NUMBER:"An invalid length value was provived. A numeric value is required.",INVALID_TARGET_OFFSET:"Target offset is beyond the bounds of the internal SmartBuffer data.",INVALID_TARGET_LENGTH:"Specified length value moves cursor beyong the bounds of the internal SmartBuffer data.",INVALID_READ_BEYOND_BOUNDS:"Attempted to read beyond the bounds of the managed data.",INVALID_WRITE_BEYOND_BOUNDS:"Attempted to write beyond the bounds of the managed data."};Gr.ERRORS=ns;function uB(t){if(!IE.Buffer.isEncoding(t))throw new Error(ns.INVALID_ENCODING)}Gr.checkEncoding=uB;function OE(t){return typeof t=="number"&&isFinite(t)&&dB(t)}Gr.isFiniteInteger=OE;function RE(t,e){if(typeof t=="number"){if(!OE(t)||t<0)throw new Error(e?ns.INVALID_OFFSET:ns.INVALID_LENGTH)}else throw new Error(e?ns.INVALID_OFFSET_NON_NUMBER:ns.INVALID_LENGTH_NON_NUMBER)}function cB(t){RE(t,!1)}Gr.checkLengthValue=cB;function fB(t){RE(t,!0)}Gr.checkOffsetValue=fB;function hB(t,e){if(t<0||t>e.length)throw new Error(ns.INVALID_TARGET_OFFSET)}Gr.checkTargetOffset=hB;function dB(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function pB(t){if(typeof BigInt>"u")throw new Error("Platform does not support JS BigInt type.");if(typeof IE.Buffer.prototype[t]>"u")throw new Error(`Platform does not support Buffer.prototype.${t}.`)}Gr.bigIntAndBufferInt64Check=pB;Object.defineProperty(Sm,"__esModule",{value:!0});const he=Gr,j1=4096,gB="utf8";class vm{constructor(e){if(this.length=0,this._encoding=gB,this._writeOffset=0,this._readOffset=0,vm.isSmartBufferOptions(e))if(e.encoding&&(he.checkEncoding(e.encoding),this._encoding=e.encoding),e.size)if(he.isFiniteInteger(e.size)&&e.size>0)this._buff=Buffer.allocUnsafe(e.size);else throw new Error(he.ERRORS.INVALID_SMARTBUFFER_SIZE);else if(e.buff)if(Buffer.isBuffer(e.buff))this._buff=e.buff,this.length=e.buff.length;else throw new Error(he.ERRORS.INVALID_SMARTBUFFER_BUFFER);else this._buff=Buffer.allocUnsafe(j1);else{if(typeof e<"u")throw new Error(he.ERRORS.INVALID_SMARTBUFFER_OBJECT);this._buff=Buffer.allocUnsafe(j1)}}static fromSize(e,n){return new this({size:e,encoding:n})}static fromBuffer(e,n){return new this({buff:e,encoding:n})}static fromOptions(e){return new this(e)}static isSmartBufferOptions(e){const n=e;return n&&(n.encoding!==void 0||n.size!==void 0||n.buff!==void 0)}readInt8(e){return this._readNumberValue(Buffer.prototype.readInt8,1,e)}readInt16BE(e){return this._readNumberValue(Buffer.prototype.readInt16BE,2,e)}readInt16LE(e){return this._readNumberValue(Buffer.prototype.readInt16LE,2,e)}readInt32BE(e){return this._readNumberValue(Buffer.prototype.readInt32BE,4,e)}readInt32LE(e){return this._readNumberValue(Buffer.prototype.readInt32LE,4,e)}readBigInt64BE(e){return he.bigIntAndBufferInt64Check("readBigInt64BE"),this._readNumberValue(Buffer.prototype.readBigInt64BE,8,e)}readBigInt64LE(e){return he.bigIntAndBufferInt64Check("readBigInt64LE"),this._readNumberValue(Buffer.prototype.readBigInt64LE,8,e)}writeInt8(e,n){return this._writeNumberValue(Buffer.prototype.writeInt8,1,e,n),this}insertInt8(e,n){return this._insertNumberValue(Buffer.prototype.writeInt8,1,e,n)}writeInt16BE(e,n){return this._writeNumberValue(Buffer.prototype.writeInt16BE,2,e,n)}insertInt16BE(e,n){return this._insertNumberValue(Buffer.prototype.writeInt16BE,2,e,n)}writeInt16LE(e,n){return this._writeNumberValue(Buffer.prototype.writeInt16LE,2,e,n)}insertInt16LE(e,n){return this._insertNumberValue(Buffer.prototype.writeInt16LE,2,e,n)}writeInt32BE(e,n){return this._writeNumberValue(Buffer.prototype.writeInt32BE,4,e,n)}insertInt32BE(e,n){return this._insertNumberValue(Buffer.prototype.writeInt32BE,4,e,n)}writeInt32LE(e,n){return this._writeNumberValue(Buffer.prototype.writeInt32LE,4,e,n)}insertInt32LE(e,n){return this._insertNumberValue(Buffer.prototype.writeInt32LE,4,e,n)}writeBigInt64BE(e,n){return he.bigIntAndBufferInt64Check("writeBigInt64BE"),this._writeNumberValue(Buffer.prototype.writeBigInt64BE,8,e,n)}insertBigInt64BE(e,n){return he.bigIntAndBufferInt64Check("writeBigInt64BE"),this._insertNumberValue(Buffer.prototype.writeBigInt64BE,8,e,n)}writeBigInt64LE(e,n){return he.bigIntAndBufferInt64Check("writeBigInt64LE"),this._writeNumberValue(Buffer.prototype.writeBigInt64LE,8,e,n)}insertBigInt64LE(e,n){return he.bigIntAndBufferInt64Check("writeBigInt64LE"),this._insertNumberValue(Buffer.prototype.writeBigInt64LE,8,e,n)}readUInt8(e){return this._readNumberValue(Buffer.prototype.readUInt8,1,e)}readUInt16BE(e){return this._readNumberValue(Buffer.prototype.readUInt16BE,2,e)}readUInt16LE(e){return this._readNumberValue(Buffer.prototype.readUInt16LE,2,e)}readUInt32BE(e){return this._readNumberValue(Buffer.prototype.readUInt32BE,4,e)}readUInt32LE(e){return this._readNumberValue(Buffer.prototype.readUInt32LE,4,e)}readBigUInt64BE(e){return he.bigIntAndBufferInt64Check("readBigUInt64BE"),this._readNumberValue(Buffer.prototype.readBigUInt64BE,8,e)}readBigUInt64LE(e){return he.bigIntAndBufferInt64Check("readBigUInt64LE"),this._readNumberValue(Buffer.prototype.readBigUInt64LE,8,e)}writeUInt8(e,n){return this._writeNumberValue(Buffer.prototype.writeUInt8,1,e,n)}insertUInt8(e,n){return this._insertNumberValue(Buffer.prototype.writeUInt8,1,e,n)}writeUInt16BE(e,n){return this._writeNumberValue(Buffer.prototype.writeUInt16BE,2,e,n)}insertUInt16BE(e,n){return this._insertNumberValue(Buffer.prototype.writeUInt16BE,2,e,n)}writeUInt16LE(e,n){return this._writeNumberValue(Buffer.prototype.writeUInt16LE,2,e,n)}insertUInt16LE(e,n){return this._insertNumberValue(Buffer.prototype.writeUInt16LE,2,e,n)}writeUInt32BE(e,n){return this._writeNumberValue(Buffer.prototype.writeUInt32BE,4,e,n)}insertUInt32BE(e,n){return this._insertNumberValue(Buffer.prototype.writeUInt32BE,4,e,n)}writeUInt32LE(e,n){return this._writeNumberValue(Buffer.prototype.writeUInt32LE,4,e,n)}insertUInt32LE(e,n){return this._insertNumberValue(Buffer.prototype.writeUInt32LE,4,e,n)}writeBigUInt64BE(e,n){return he.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._writeNumberValue(Buffer.prototype.writeBigUInt64BE,8,e,n)}insertBigUInt64BE(e,n){return he.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._insertNumberValue(Buffer.prototype.writeBigUInt64BE,8,e,n)}writeBigUInt64LE(e,n){return he.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._writeNumberValue(Buffer.prototype.writeBigUInt64LE,8,e,n)}insertBigUInt64LE(e,n){return he.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._insertNumberValue(Buffer.prototype.writeBigUInt64LE,8,e,n)}readFloatBE(e){return this._readNumberValue(Buffer.prototype.readFloatBE,4,e)}readFloatLE(e){return this._readNumberValue(Buffer.prototype.readFloatLE,4,e)}writeFloatBE(e,n){return this._writeNumberValue(Buffer.prototype.writeFloatBE,4,e,n)}insertFloatBE(e,n){return this._insertNumberValue(Buffer.prototype.writeFloatBE,4,e,n)}writeFloatLE(e,n){return this._writeNumberValue(Buffer.prototype.writeFloatLE,4,e,n)}insertFloatLE(e,n){return this._insertNumberValue(Buffer.prototype.writeFloatLE,4,e,n)}readDoubleBE(e){return this._readNumberValue(Buffer.prototype.readDoubleBE,8,e)}readDoubleLE(e){return this._readNumberValue(Buffer.prototype.readDoubleLE,8,e)}writeDoubleBE(e,n){return this._writeNumberValue(Buffer.prototype.writeDoubleBE,8,e,n)}insertDoubleBE(e,n){return this._insertNumberValue(Buffer.prototype.writeDoubleBE,8,e,n)}writeDoubleLE(e,n){return this._writeNumberValue(Buffer.prototype.writeDoubleLE,8,e,n)}insertDoubleLE(e,n){return this._insertNumberValue(Buffer.prototype.writeDoubleLE,8,e,n)}readString(e,n){let r;typeof e=="number"?(he.checkLengthValue(e),r=Math.min(e,this.length-this._readOffset)):(n=e,r=this.length-this._readOffset),typeof n<"u"&&he.checkEncoding(n);const i=this._buff.slice(this._readOffset,this._readOffset+r).toString(n||this._encoding);return this._readOffset+=r,i}insertString(e,n,r){return he.checkOffsetValue(n),this._handleString(e,!0,n,r)}writeString(e,n,r){return this._handleString(e,!1,n,r)}readStringNT(e){typeof e<"u"&&he.checkEncoding(e);let n=this.length;for(let i=this._readOffset;i<this.length;i++)if(this._buff[i]===0){n=i;break}const r=this._buff.slice(this._readOffset,n);return this._readOffset=n+1,r.toString(e||this._encoding)}insertStringNT(e,n,r){return he.checkOffsetValue(n),this.insertString(e,n,r),this.insertUInt8(0,n+e.length),this}writeStringNT(e,n,r){return this.writeString(e,n,r),this.writeUInt8(0,typeof n=="number"?n+e.length:this.writeOffset),this}readBuffer(e){typeof e<"u"&&he.checkLengthValue(e);const n=typeof e=="number"?e:this.length,r=Math.min(this.length,this._readOffset+n),i=this._buff.slice(this._readOffset,r);return this._readOffset=r,i}insertBuffer(e,n){return he.checkOffsetValue(n),this._handleBuffer(e,!0,n)}writeBuffer(e,n){return this._handleBuffer(e,!1,n)}readBufferNT(){let e=this.length;for(let r=this._readOffset;r<this.length;r++)if(this._buff[r]===0){e=r;break}const n=this._buff.slice(this._readOffset,e);return this._readOffset=e+1,n}insertBufferNT(e,n){return he.checkOffsetValue(n),this.insertBuffer(e,n),this.insertUInt8(0,n+e.length),this}writeBufferNT(e,n){return typeof n<"u"&&he.checkOffsetValue(n),this.writeBuffer(e,n),this.writeUInt8(0,typeof n=="number"?n+e.length:this._writeOffset),this}clear(){return this._writeOffset=0,this._readOffset=0,this.length=0,this}remaining(){return this.length-this._readOffset}get readOffset(){return this._readOffset}set readOffset(e){he.checkOffsetValue(e),he.checkTargetOffset(e,this),this._readOffset=e}get writeOffset(){return this._writeOffset}set writeOffset(e){he.checkOffsetValue(e),he.checkTargetOffset(e,this),this._writeOffset=e}get encoding(){return this._encoding}set encoding(e){he.checkEncoding(e),this._encoding=e}get internalBuffer(){return this._buff}toBuffer(){return this._buff.slice(0,this.length)}toString(e){const n=typeof e=="string"?e:this._encoding;return he.checkEncoding(n),this._buff.toString(n,0,this.length)}destroy(){return this.clear(),this}_handleString(e,n,r,i){let s=this._writeOffset,o=this._encoding;typeof r=="number"?s=r:typeof r=="string"&&(he.checkEncoding(r),o=r),typeof i=="string"&&(he.checkEncoding(i),o=i);const l=Buffer.byteLength(e,o);return n?this.ensureInsertable(l,s):this._ensureWriteable(l,s),this._buff.write(e,s,l,o),n?this._writeOffset+=l:typeof r=="number"?this._writeOffset=Math.max(this._writeOffset,s+l):this._writeOffset+=l,this}_handleBuffer(e,n,r){const i=typeof r=="number"?r:this._writeOffset;return n?this.ensureInsertable(e.length,i):this._ensureWriteable(e.length,i),e.copy(this._buff,i),n?this._writeOffset+=e.length:typeof r=="number"?this._writeOffset=Math.max(this._writeOffset,i+e.length):this._writeOffset+=e.length,this}ensureReadable(e,n){let r=this._readOffset;if(typeof n<"u"&&(he.checkOffsetValue(n),r=n),r<0||r+e>this.length)throw new Error(he.ERRORS.INVALID_READ_BEYOND_BOUNDS)}ensureInsertable(e,n){he.checkOffsetValue(n),this._ensureCapacity(this.length+e),n<this.length&&this._buff.copy(this._buff,n+e,n,this._buff.length),n+e>this.length?this.length=n+e:this.length+=e}_ensureWriteable(e,n){const r=typeof n=="number"?n:this._writeOffset;this._ensureCapacity(r+e),r+e>this.length&&(this.length=r+e)}_ensureCapacity(e){const n=this._buff.length;if(e>n){let r=this._buff,i=n*3/2+1;i<e&&(i=e),this._buff=Buffer.allocUnsafe(i),r.copy(this._buff,0,0,n)}}_readNumberValue(e,n,r){this.ensureReadable(n,r);const i=e.call(this._buff,typeof r=="number"?r:this._readOffset);return typeof r>"u"&&(this._readOffset+=n),i}_insertNumberValue(e,n,r,i){return he.checkOffsetValue(i),this.ensureInsertable(n,i),e.call(this._buff,r,i),this._writeOffset+=n,this}_writeNumberValue(e,n,r,i){if(typeof i=="number"){if(i<0)throw new Error(he.ERRORS.INVALID_WRITE_BEYOND_BOUNDS);he.checkOffsetValue(i)}const s=typeof i=="number"?i:this._writeOffset;return this._ensureWriteable(n,s),e.call(this._buff,r,s),typeof i=="number"?this._writeOffset=Math.max(this._writeOffset,s+n):this._writeOffset+=n,this}}Sm.SmartBuffer=vm;var xe={};Object.defineProperty(xe,"__esModule",{value:!0});xe.SOCKS5_NO_ACCEPTABLE_AUTH=xe.SOCKS5_CUSTOM_AUTH_END=xe.SOCKS5_CUSTOM_AUTH_START=xe.SOCKS_INCOMING_PACKET_SIZES=xe.SocksClientState=xe.Socks5Response=xe.Socks5HostType=xe.Socks5Auth=xe.Socks4Response=xe.SocksCommand=xe.ERRORS=xe.DEFAULT_TIMEOUT=void 0;const mB=3e4;xe.DEFAULT_TIMEOUT=mB;const yB={InvalidSocksCommand:"An invalid SOCKS command was provided. Valid options are connect, bind, and associate.",InvalidSocksCommandForOperation:"An invalid SOCKS command was provided. Only a subset of commands are supported for this operation.",InvalidSocksCommandChain:"An invalid SOCKS command was provided. Chaining currently only supports the connect command.",InvalidSocksClientOptionsDestination:"An invalid destination host was provided.",InvalidSocksClientOptionsExistingSocket:"An invalid existing socket was provided. This should be an instance of stream.Duplex.",InvalidSocksClientOptionsProxy:"Invalid SOCKS proxy details were provided.",InvalidSocksClientOptionsTimeout:"An invalid timeout value was provided. Please enter a value above 0 (in ms).",InvalidSocksClientOptionsProxiesLength:"At least two socks proxies must be provided for chaining.",InvalidSocksClientOptionsCustomAuthRange:"Custom auth must be a value between 0x80 and 0xFE.",InvalidSocksClientOptionsCustomAuthOptions:"When a custom_auth_method is provided, custom_auth_request_handler, custom_auth_response_size, and custom_auth_response_handler must also be provided and valid.",NegotiationError:"Negotiation error",SocketClosed:"Socket closed",ProxyConnectionTimedOut:"Proxy connection timed out",InternalError:"SocksClient internal error (this should not happen)",InvalidSocks4HandshakeResponse:"Received invalid Socks4 handshake response",Socks4ProxyRejectedConnection:"Socks4 Proxy rejected connection",InvalidSocks4IncomingConnectionResponse:"Socks4 invalid incoming connection response",Socks4ProxyRejectedIncomingBoundConnection:"Socks4 Proxy rejected incoming bound connection",InvalidSocks5InitialHandshakeResponse:"Received invalid Socks5 initial handshake response",InvalidSocks5IntiailHandshakeSocksVersion:"Received invalid Socks5 initial handshake (invalid socks version)",InvalidSocks5InitialHandshakeNoAcceptedAuthType:"Received invalid Socks5 initial handshake (no accepted authentication type)",InvalidSocks5InitialHandshakeUnknownAuthType:"Received invalid Socks5 initial handshake (unknown authentication type)",Socks5AuthenticationFailed:"Socks5 Authentication failed",InvalidSocks5FinalHandshake:"Received invalid Socks5 final handshake response",InvalidSocks5FinalHandshakeRejected:"Socks5 proxy rejected connection",InvalidSocks5IncomingConnectionResponse:"Received invalid Socks5 incoming connection response",Socks5ProxyRejectedIncomingBoundConnection:"Socks5 Proxy rejected incoming bound connection"};xe.ERRORS=yB;const wB={Socks5InitialHandshakeResponse:2,Socks5UserPassAuthenticationResponse:2,Socks5ResponseHeader:5,Socks5ResponseIPv4:10,Socks5ResponseIPv6:22,Socks5ResponseHostname:t=>t+7,Socks4Response:8};xe.SOCKS_INCOMING_PACKET_SIZES=wB;var H1;(function(t){t[t.connect=1]="connect",t[t.bind=2]="bind",t[t.associate=3]="associate"})(H1||(xe.SocksCommand=H1={}));var $1;(function(t){t[t.Granted=90]="Granted",t[t.Failed=91]="Failed",t[t.Rejected=92]="Rejected",t[t.RejectedIdent=93]="RejectedIdent"})($1||(xe.Socks4Response=$1={}));var W1;(function(t){t[t.NoAuth=0]="NoAuth",t[t.GSSApi=1]="GSSApi",t[t.UserPass=2]="UserPass"})(W1||(xe.Socks5Auth=W1={}));const SB=128;xe.SOCKS5_CUSTOM_AUTH_START=SB;const vB=254;xe.SOCKS5_CUSTOM_AUTH_END=vB;const kB=255;xe.SOCKS5_NO_ACCEPTABLE_AUTH=kB;var q1;(function(t){t[t.Granted=0]="Granted",t[t.Failure=1]="Failure",t[t.NotAllowed=2]="NotAllowed",t[t.NetworkUnreachable=3]="NetworkUnreachable",t[t.HostUnreachable=4]="HostUnreachable",t[t.ConnectionRefused=5]="ConnectionRefused",t[t.TTLExpired=6]="TTLExpired",t[t.CommandNotSupported=7]="CommandNotSupported",t[t.AddressNotSupported=8]="AddressNotSupported"})(q1||(xe.Socks5Response=q1={}));var K1;(function(t){t[t.IPv4=1]="IPv4",t[t.Hostname=3]="Hostname",t[t.IPv6=4]="IPv6"})(K1||(xe.Socks5HostType=K1={}));var G1;(function(t){t[t.Created=0]="Created",t[t.Connecting=1]="Connecting",t[t.Connected=2]="Connected",t[t.SentInitialHandshake=3]="SentInitialHandshake",t[t.ReceivedInitialHandshakeResponse=4]="ReceivedInitialHandshakeResponse",t[t.SentAuthentication=5]="SentAuthentication",t[t.ReceivedAuthenticationResponse=6]="ReceivedAuthenticationResponse",t[t.SentFinalHandshake=7]="SentFinalHandshake",t[t.ReceivedFinalResponse=8]="ReceivedFinalResponse",t[t.BoundWaitingForConnection=9]="BoundWaitingForConnection",t[t.Established=10]="Established",t[t.Disconnected=11]="Disconnected",t[t.Error=99]="Error"})(G1||(xe.SocksClientState=G1={}));var On={},Is={};Object.defineProperty(Is,"__esModule",{value:!0});Is.shuffleArray=Is.SocksClientError=void 0;class _B extends Error{constructor(e,n){super(e),this.options=n}}Is.SocksClientError=_B;function EB(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}}Is.shuffleArray=EB;var km={},Da={},Os={};Object.defineProperty(Os,"__esModule",{value:!0});Os.isCorrect=Os.isInSubnet=void 0;function CB(t){return this.subnetMask<t.subnetMask?!1:this.mask(t.subnetMask)===t.mask()}Os.isInSubnet=CB;function bB(t){return function(){return this.addressMinusSuffix!==this.correctForm()?!1:this.subnetMask===t&&!this.parsedSubnet?!0:this.parsedSubnet===String(this.subnetMask)}}Os.isCorrect=bB;var Gn={};Object.defineProperty(Gn,"__esModule",{value:!0});Gn.RE_SUBNET_STRING=Gn.RE_ADDRESS=Gn.GROUPS=Gn.BITS=void 0;Gn.BITS=32;Gn.GROUPS=4;Gn.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g;Gn.RE_SUBNET_STRING=/\/\d{1,2}$/;var qo={};Object.defineProperty(qo,"__esModule",{value:!0});qo.AddressError=void 0;class xB extends Error{constructor(e,n){super(e),this.name="AddressError",n!==null&&(this.parseMessage=n)}}qo.AddressError=xB;var AE={exports:{}};(function(t,e){(function(){var n,r=0xdeadbeefcafe,i=(r&16777215)==15715070;function s(w,S,E){w!=null&&(typeof w=="number"?this.fromNumber(w,S,E):S==null&&typeof w!="string"?this.fromString(w,256):this.fromString(w,S))}function o(){return new s(null)}function l(w,S,E,N,U,$){for(;--$>=0;){var G=S*this[w++]+E[N]+U;U=Math.floor(G/67108864),E[N++]=G&67108863}return U}function a(w,S,E,N,U,$){for(var G=S&32767,Z=S>>15;--$>=0;){var Ne=this[w]&32767,st=this[w++]>>15,vn=Z*Ne+st*G;Ne=G*Ne+((vn&32767)<<15)+E[N]+(U&1073741823),U=(Ne>>>30)+(vn>>>15)+Z*st+(U>>>30),E[N++]=Ne&1073741823}return U}function u(w,S,E,N,U,$){for(var G=S&16383,Z=S>>14;--$>=0;){var Ne=this[w]&16383,st=this[w++]>>14,vn=Z*Ne+st*G;Ne=G*Ne+((vn&16383)<<14)+E[N]+U,U=(Ne>>28)+(vn>>14)+Z*st,E[N++]=Ne&268435455}return U}var c=typeof navigator<"u";c&&i&&navigator.appName=="Microsoft Internet Explorer"?(s.prototype.am=a,n=30):c&&i&&navigator.appName!="Netscape"?(s.prototype.am=l,n=26):(s.prototype.am=u,n=28),s.prototype.DB=n,s.prototype.DM=(1<<n)-1,s.prototype.DV=1<<n;var f=52;s.prototype.FV=Math.pow(2,f),s.prototype.F1=f-n,s.prototype.F2=2*n-f;var h="0123456789abcdefghijklmnopqrstuvwxyz",p=new Array,m,v;for(m=48,v=0;v<=9;++v)p[m++]=v;for(m=97,v=10;v<36;++v)p[m++]=v;for(m=65,v=10;v<36;++v)p[m++]=v;function C(w){return h.charAt(w)}function y(w,S){var E=p[w.charCodeAt(S)];return E??-1}function _(w){for(var S=this.t-1;S>=0;--S)w[S]=this[S];w.t=this.t,w.s=this.s}function x(w){this.t=1,this.s=w<0?-1:0,w>0?this[0]=w:w<-1?this[0]=w+this.DV:this.t=0}function O(w){var S=o();return S.fromInt(w),S}function R(w,S){var E;if(S==16)E=4;else if(S==8)E=3;else if(S==256)E=8;else if(S==2)E=1;else if(S==32)E=5;else if(S==4)E=2;else{this.fromRadix(w,S);return}this.t=0,this.s=0;for(var N=w.length,U=!1,$=0;--N>=0;){var G=E==8?w[N]&255:y(w,N);if(G<0){w.charAt(N)=="-"&&(U=!0);continue}U=!1,$==0?this[this.t++]=G:$+E>this.DB?(this[this.t-1]|=(G&(1<<this.DB-$)-1)<<$,this[this.t++]=G>>this.DB-$):this[this.t-1]|=G<<$,$+=E,$>=this.DB&&($-=this.DB)}E==8&&w[0]&128&&(this.s=-1,$>0&&(this[this.t-1]|=(1<<this.DB-$)-1<<$)),this.clamp(),U&&s.ZERO.subTo(this,this)}function P(){for(var w=this.s&this.DM;this.t>0&&this[this.t-1]==w;)--this.t}function F(w){if(this.s<0)return"-"+this.negate().toString(w);var S;if(w==16)S=4;else if(w==8)S=3;else if(w==2)S=1;else if(w==32)S=5;else if(w==4)S=2;else return this.toRadix(w);var E=(1<<S)-1,N,U=!1,$="",G=this.t,Z=this.DB-G*this.DB%S;if(G-- >0)for(Z<this.DB&&(N=this[G]>>Z)>0&&(U=!0,$=C(N));G>=0;)Z<S?(N=(this[G]&(1<<Z)-1)<<S-Z,N|=this[--G]>>(Z+=this.DB-S)):(N=this[G]>>(Z-=S)&E,Z<=0&&(Z+=this.DB,--G)),N>0&&(U=!0),U&&($+=C(N));return U?$:"0"}function V(){var w=o();return s.ZERO.subTo(this,w),w}function z(){return this.s<0?this.negate():this}function Q(w){var S=this.s-w.s;if(S!=0)return S;var E=this.t;if(S=E-w.t,S!=0)return this.s<0?-S:S;for(;--E>=0;)if((S=this[E]-w[E])!=0)return S;return 0}function ye(w){var S=1,E;return(E=w>>>16)!=0&&(w=E,S+=16),(E=w>>8)!=0&&(w=E,S+=8),(E=w>>4)!=0&&(w=E,S+=4),(E=w>>2)!=0&&(w=E,S+=2),(E=w>>1)!=0&&(w=E,S+=1),S}function nt(){return this.t<=0?0:this.DB*(this.t-1)+ye(this[this.t-1]^this.s&this.DM)}function We(w,S){var E;for(E=this.t-1;E>=0;--E)S[E+w]=this[E];for(E=w-1;E>=0;--E)S[E]=0;S.t=this.t+w,S.s=this.s}function rt(w,S){for(var E=w;E<this.t;++E)S[E-w]=this[E];S.t=Math.max(this.t-w,0),S.s=this.s}function Kt(w,S){var E=w%this.DB,N=this.DB-E,U=(1<<N)-1,$=Math.floor(w/this.DB),G=this.s<<E&this.DM,Z;for(Z=this.t-1;Z>=0;--Z)S[Z+$+1]=this[Z]>>N|G,G=(this[Z]&U)<<E;for(Z=$-1;Z>=0;--Z)S[Z]=0;S[$]=G,S.t=this.t+$+1,S.s=this.s,S.clamp()}function vt(w,S){S.s=this.s;var E=Math.floor(w/this.DB);if(E>=this.t){S.t=0;return}var N=w%this.DB,U=this.DB-N,$=(1<<N)-1;S[0]=this[E]>>N;for(var G=E+1;G<this.t;++G)S[G-E-1]|=(this[G]&$)<<U,S[G-E]=this[G]>>N;N>0&&(S[this.t-E-1]|=(this.s&$)<<U),S.t=this.t-E,S.clamp()}function qe(w,S){for(var E=0,N=0,U=Math.min(w.t,this.t);E<U;)N+=this[E]-w[E],S[E++]=N&this.DM,N>>=this.DB;if(w.t<this.t){for(N-=w.s;E<this.t;)N+=this[E],S[E++]=N&this.DM,N>>=this.DB;N+=this.s}else{for(N+=this.s;E<w.t;)N-=w[E],S[E++]=N&this.DM,N>>=this.DB;N-=w.s}S.s=N<0?-1:0,N<-1?S[E++]=this.DV+N:N>0&&(S[E++]=N),S.t=E,S.clamp()}function K(w,S){var E=this.abs(),N=w.abs(),U=E.t;for(S.t=U+N.t;--U>=0;)S[U]=0;for(U=0;U<N.t;++U)S[U+E.t]=E.am(0,N[U],S,U,0,E.t);S.s=0,S.clamp(),this.s!=w.s&&s.ZERO.subTo(S,S)}function te(w){for(var S=this.abs(),E=w.t=2*S.t;--E>=0;)w[E]=0;for(E=0;E<S.t-1;++E){var N=S.am(E,S[E],w,2*E,0,1);(w[E+S.t]+=S.am(E+1,2*S[E],w,2*E+1,N,S.t-E-1))>=S.DV&&(w[E+S.t]-=S.DV,w[E+S.t+1]=1)}w.t>0&&(w[w.t-1]+=S.am(E,S[E],w,2*E,0,1)),w.s=0,w.clamp()}function re(w,S,E){var N=w.abs();if(!(N.t<=0)){var U=this.abs();if(U.t<N.t){S!=null&&S.fromInt(0),E!=null&&this.copyTo(E);return}E==null&&(E=o());var $=o(),G=this.s,Z=w.s,Ne=this.DB-ye(N[N.t-1]);Ne>0?(N.lShiftTo(Ne,$),U.lShiftTo(Ne,E)):(N.copyTo($),U.copyTo(E));var st=$.t,vn=$[st-1];if(vn!=0){var ln=vn*(1<<this.F1)+(st>1?$[st-2]>>this.F2:0),Cr=this.FV/ln,Fa=(1<<this.F1)/ln,Un=1<<this.F2,zn=E.t,Ua=zn-st,Qr=S??o();for($.dlShiftTo(Ua,Qr),E.compareTo(Qr)>=0&&(E[E.t++]=1,E.subTo(Qr,E)),s.ONE.dlShiftTo(st,Qr),Qr.subTo($,$);$.t<st;)$[$.t++]=0;for(;--Ua>=0;){var Tf=E[--zn]==vn?this.DM:Math.floor(E[zn]*Cr+(E[zn-1]+Un)*Fa);if((E[zn]+=$.am(0,Tf,E,Ua,0,st))<Tf)for($.dlShiftTo(Ua,Qr),E.subTo(Qr,E);E[zn]<--Tf;)E.subTo(Qr,E)}S!=null&&(E.drShiftTo(st,S),G!=Z&&s.ZERO.subTo(S,S)),E.t=st,E.clamp(),Ne>0&&E.rShiftTo(Ne,E),G<0&&s.ZERO.subTo(E,E)}}}function se(w){var S=o();return this.abs().divRemTo(w,null,S),this.s<0&&S.compareTo(s.ZERO)>0&&w.subTo(S,S),S}function oe(w){this.m=w}function ht(w){return w.s<0||w.compareTo(this.m)>=0?w.mod(this.m):w}function kt(w){return w}function Sn(w){w.divRemTo(this.m,null,w)}function D(w,S,E){w.multiplyTo(S,E),this.reduce(E)}function M(w,S){w.squareTo(S),this.reduce(S)}oe.prototype.convert=ht,oe.prototype.revert=kt,oe.prototype.reduce=Sn,oe.prototype.mulTo=D,oe.prototype.sqrTo=M;function W(){if(this.t<1)return 0;var w=this[0];if(!(w&1))return 0;var S=w&3;return S=S*(2-(w&15)*S)&15,S=S*(2-(w&255)*S)&255,S=S*(2-((w&65535)*S&65535))&65535,S=S*(2-w*S%this.DV)%this.DV,S>0?this.DV-S:-S}function ee(w){this.m=w,this.mp=w.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<w.DB-15)-1,this.mt2=2*w.t}function ce(w){var S=o();return w.abs().dlShiftTo(this.m.t,S),S.divRemTo(this.m,null,S),w.s<0&&S.compareTo(s.ZERO)>0&&this.m.subTo(S,S),S}function T(w){var S=o();return w.copyTo(S),this.reduce(S),S}function I(w){for(;w.t<=this.mt2;)w[w.t++]=0;for(var S=0;S<this.m.t;++S){var E=w[S]&32767,N=E*this.mpl+((E*this.mph+(w[S]>>15)*this.mpl&this.um)<<15)&w.DM;for(E=S+this.m.t,w[E]+=this.m.am(0,N,w,S,0,this.m.t);w[E]>=w.DV;)w[E]-=w.DV,w[++E]++}w.clamp(),w.drShiftTo(this.m.t,w),w.compareTo(this.m)>=0&&w.subTo(this.m,w)}function j(w,S){w.squareTo(S),this.reduce(S)}function Y(w,S,E){w.multiplyTo(S,E),this.reduce(E)}ee.prototype.convert=ce,ee.prototype.revert=T,ee.prototype.reduce=I,ee.prototype.mulTo=Y,ee.prototype.sqrTo=j;function Ie(){return(this.t>0?this[0]&1:this.s)==0}function fe(w,S){if(w>4294967295||w<1)return s.ONE;var E=o(),N=o(),U=S.convert(this),$=ye(w)-1;for(U.copyTo(E);--$>=0;)if(S.sqrTo(E,N),(w&1<<$)>0)S.mulTo(N,U,E);else{var G=E;E=N,N=G}return S.revert(E)}function Se(w,S){var E;return w<256||S.isEven()?E=new oe(S):E=new ee(S),this.exp(w,E)}s.prototype.copyTo=_,s.prototype.fromInt=x,s.prototype.fromString=R,s.prototype.clamp=P,s.prototype.dlShiftTo=We,s.prototype.drShiftTo=rt,s.prototype.lShiftTo=Kt,s.prototype.rShiftTo=vt,s.prototype.subTo=qe,s.prototype.multiplyTo=K,s.prototype.squareTo=te,s.prototype.divRemTo=re,s.prototype.invDigit=W,s.prototype.isEven=Ie,s.prototype.exp=fe,s.prototype.toString=F,s.prototype.negate=V,s.prototype.abs=z,s.prototype.compareTo=Q,s.prototype.bitLength=nt,s.prototype.mod=se,s.prototype.modPowInt=Se,s.ZERO=O(0),s.ONE=O(1);function ir(){var w=o();return this.copyTo(w),w}function Jr(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function ji(){return this.t==0?this.s:this[0]<<24>>24}function Yr(){return this.t==0?this.s:this[0]<<16>>16}function Nt(w){return Math.floor(Math.LN2*this.DB/Math.log(w))}function _r(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Hi(w){if(w==null&&(w=10),this.signum()==0||w<2||w>36)return"0";var S=this.chunkSize(w),E=Math.pow(w,S),N=O(E),U=o(),$=o(),G="";for(this.divRemTo(N,U,$);U.signum()>0;)G=(E+$.intValue()).toString(w).substr(1)+G,U.divRemTo(N,U,$);return $.intValue().toString(w)+G}function Gt(w,S){this.fromInt(0),S==null&&(S=10);for(var E=this.chunkSize(S),N=Math.pow(S,E),U=!1,$=0,G=0,Z=0;Z<w.length;++Z){var Ne=y(w,Z);if(Ne<0){w.charAt(Z)=="-"&&this.signum()==0&&(U=!0);continue}G=S*G+Ne,++$>=E&&(this.dMultiply(N),this.dAddOffset(G,0),$=0,G=0)}$>0&&(this.dMultiply(Math.pow(S,$)),this.dAddOffset(G,0)),U&&s.ZERO.subTo(this,this)}function Er(w,S,E){if(typeof S=="number")if(w<2)this.fromInt(1);else for(this.fromNumber(w,E),this.testBit(w-1)||this.bitwiseTo(s.ONE.shiftLeft(w-1),ue,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(S);)this.dAddOffset(2,0),this.bitLength()>w&&this.subTo(s.ONE.shiftLeft(w-1),this);else{var N=new Array,U=w&7;N.length=(w>>3)+1,S.nextBytes(N),U>0?N[0]&=(1<<U)-1:N[0]=0,this.fromString(N,256)}}function k(){var w=this.t,S=new Array;S[0]=this.s;var E=this.DB-w*this.DB%8,N,U=0;if(w-- >0)for(E<this.DB&&(N=this[w]>>E)!=(this.s&this.DM)>>E&&(S[U++]=N|this.s<<this.DB-E);w>=0;)E<8?(N=(this[w]&(1<<E)-1)<<8-E,N|=this[--w]>>(E+=this.DB-8)):(N=this[w]>>(E-=8)&255,E<=0&&(E+=this.DB,--w)),N&128&&(N|=-256),U==0&&(this.s&128)!=(N&128)&&++U,(U>0||N!=this.s)&&(S[U++]=N);return S}function d(w){return this.compareTo(w)==0}function g(w){return this.compareTo(w)<0?this:w}function b(w){return this.compareTo(w)>0?this:w}function A(w,S,E){var N,U,$=Math.min(w.t,this.t);for(N=0;N<$;++N)E[N]=S(this[N],w[N]);if(w.t<this.t){for(U=w.s&this.DM,N=$;N<this.t;++N)E[N]=S(this[N],U);E.t=this.t}else{for(U=this.s&this.DM,N=$;N<w.t;++N)E[N]=S(U,w[N]);E.t=w.t}E.s=S(this.s,w.s),E.clamp()}function B(w,S){return w&S}function L(w){var S=o();return this.bitwiseTo(w,B,S),S}function ue(w,S){return w|S}function Be(w){var S=o();return this.bitwiseTo(w,ue,S),S}function be(w,S){return w^S}function Pe(w){var S=o();return this.bitwiseTo(w,be,S),S}function ke(w,S){return w&~S}function WE(w){var S=o();return this.bitwiseTo(w,ke,S),S}function qE(){for(var w=o(),S=0;S<this.t;++S)w[S]=this.DM&~this[S];return w.t=this.t,w.s=~this.s,w}function KE(w){var S=o();return w<0?this.rShiftTo(-w,S):this.lShiftTo(w,S),S}function GE(w){var S=o();return w<0?this.lShiftTo(-w,S):this.rShiftTo(w,S),S}function JE(w){if(w==0)return-1;var S=0;return w&65535||(w>>=16,S+=16),w&255||(w>>=8,S+=8),w&15||(w>>=4,S+=4),w&3||(w>>=2,S+=2),w&1||++S,S}function YE(){for(var w=0;w<this.t;++w)if(this[w]!=0)return w*this.DB+JE(this[w]);return this.s<0?this.t*this.DB:-1}function QE(w){for(var S=0;w!=0;)w&=w-1,++S;return S}function ZE(){for(var w=0,S=this.s&this.DM,E=0;E<this.t;++E)w+=QE(this[E]^S);return w}function XE(w){var S=Math.floor(w/this.DB);return S>=this.t?this.s!=0:(this[S]&1<<w%this.DB)!=0}function eC(w,S){var E=s.ONE.shiftLeft(w);return this.bitwiseTo(E,S,E),E}function tC(w){return this.changeBit(w,ue)}function nC(w){return this.changeBit(w,ke)}function rC(w){return this.changeBit(w,be)}function iC(w,S){for(var E=0,N=0,U=Math.min(w.t,this.t);E<U;)N+=this[E]+w[E],S[E++]=N&this.DM,N>>=this.DB;if(w.t<this.t){for(N+=w.s;E<this.t;)N+=this[E],S[E++]=N&this.DM,N>>=this.DB;N+=this.s}else{for(N+=this.s;E<w.t;)N+=w[E],S[E++]=N&this.DM,N>>=this.DB;N+=w.s}S.s=N<0?-1:0,N>0?S[E++]=N:N<-1&&(S[E++]=this.DV+N),S.t=E,S.clamp()}function sC(w){var S=o();return this.addTo(w,S),S}function oC(w){var S=o();return this.subTo(w,S),S}function lC(w){var S=o();return this.multiplyTo(w,S),S}function aC(){var w=o();return this.squareTo(w),w}function uC(w){var S=o();return this.divRemTo(w,S,null),S}function cC(w){var S=o();return this.divRemTo(w,null,S),S}function fC(w){var S=o(),E=o();return this.divRemTo(w,S,E),new Array(S,E)}function hC(w){this[this.t]=this.am(0,w-1,this,0,0,this.t),++this.t,this.clamp()}function dC(w,S){if(w!=0){for(;this.t<=S;)this[this.t++]=0;for(this[S]+=w;this[S]>=this.DV;)this[S]-=this.DV,++S>=this.t&&(this[this.t++]=0),++this[S]}}function Ko(){}function Em(w){return w}function pC(w,S,E){w.multiplyTo(S,E)}function gC(w,S){w.squareTo(S)}Ko.prototype.convert=Em,Ko.prototype.revert=Em,Ko.prototype.mulTo=pC,Ko.prototype.sqrTo=gC;function mC(w){return this.exp(w,new Ko)}function yC(w,S,E){var N=Math.min(this.t+w.t,S);for(E.s=0,E.t=N;N>0;)E[--N]=0;var U;for(U=E.t-this.t;N<U;++N)E[N+this.t]=this.am(0,w[N],E,N,0,this.t);for(U=Math.min(w.t,S);N<U;++N)this.am(0,w[N],E,N,0,S-N);E.clamp()}function wC(w,S,E){--S;var N=E.t=this.t+w.t-S;for(E.s=0;--N>=0;)E[N]=0;for(N=Math.max(S-this.t,0);N<w.t;++N)E[this.t+N-S]=this.am(S-N,w[N],E,0,0,this.t+N-S);E.clamp(),E.drShiftTo(1,E)}function $i(w){this.r2=o(),this.q3=o(),s.ONE.dlShiftTo(2*w.t,this.r2),this.mu=this.r2.divide(w),this.m=w}function SC(w){if(w.s<0||w.t>2*this.m.t)return w.mod(this.m);if(w.compareTo(this.m)<0)return w;var S=o();return w.copyTo(S),this.reduce(S),S}function vC(w){return w}function kC(w){for(w.drShiftTo(this.m.t-1,this.r2),w.t>this.m.t+1&&(w.t=this.m.t+1,w.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);w.compareTo(this.r2)<0;)w.dAddOffset(1,this.m.t+1);for(w.subTo(this.r2,w);w.compareTo(this.m)>=0;)w.subTo(this.m,w)}function _C(w,S){w.squareTo(S),this.reduce(S)}function EC(w,S,E){w.multiplyTo(S,E),this.reduce(E)}$i.prototype.convert=SC,$i.prototype.revert=vC,$i.prototype.reduce=kC,$i.prototype.mulTo=EC,$i.prototype.sqrTo=_C;function CC(w,S){var E=w.bitLength(),N,U=O(1),$;if(E<=0)return U;E<18?N=1:E<48?N=3:E<144?N=4:E<768?N=5:N=6,E<8?$=new oe(S):S.isEven()?$=new $i(S):$=new ee(S);var G=new Array,Z=3,Ne=N-1,st=(1<<N)-1;if(G[1]=$.convert(this),N>1){var vn=o();for($.sqrTo(G[1],vn);Z<=st;)G[Z]=o(),$.mulTo(vn,G[Z-2],G[Z]),Z+=2}var ln=w.t-1,Cr,Fa=!0,Un=o(),zn;for(E=ye(w[ln])-1;ln>=0;){for(E>=Ne?Cr=w[ln]>>E-Ne&st:(Cr=(w[ln]&(1<<E+1)-1)<<Ne-E,ln>0&&(Cr|=w[ln-1]>>this.DB+E-Ne)),Z=N;!(Cr&1);)Cr>>=1,--Z;if((E-=Z)<0&&(E+=this.DB,--ln),Fa)G[Cr].copyTo(U),Fa=!1;else{for(;Z>1;)$.sqrTo(U,Un),$.sqrTo(Un,U),Z-=2;Z>0?$.sqrTo(U,Un):(zn=U,U=Un,Un=zn),$.mulTo(Un,G[Cr],U)}for(;ln>=0&&!(w[ln]&1<<E);)$.sqrTo(U,Un),zn=U,U=Un,Un=zn,--E<0&&(E=this.DB-1,--ln)}return $.revert(U)}function bC(w){var S=this.s<0?this.negate():this.clone(),E=w.s<0?w.negate():w.clone();if(S.compareTo(E)<0){var N=S;S=E,E=N}var U=S.getLowestSetBit(),$=E.getLowestSetBit();if($<0)return S;for(U<$&&($=U),$>0&&(S.rShiftTo($,S),E.rShiftTo($,E));S.signum()>0;)(U=S.getLowestSetBit())>0&&S.rShiftTo(U,S),(U=E.getLowestSetBit())>0&&E.rShiftTo(U,E),S.compareTo(E)>=0?(S.subTo(E,S),S.rShiftTo(1,S)):(E.subTo(S,E),E.rShiftTo(1,E));return $>0&&E.lShiftTo($,E),E}function xC(w){if(w<=0)return 0;var S=this.DV%w,E=this.s<0?w-1:0;if(this.t>0)if(S==0)E=this[0]%w;else for(var N=this.t-1;N>=0;--N)E=(S*E+this[N])%w;return E}function TC(w){var S=w.isEven();if(this.isEven()&&S||w.signum()==0)return s.ZERO;for(var E=w.clone(),N=this.clone(),U=O(1),$=O(0),G=O(0),Z=O(1);E.signum()!=0;){for(;E.isEven();)E.rShiftTo(1,E),S?((!U.isEven()||!$.isEven())&&(U.addTo(this,U),$.subTo(w,$)),U.rShiftTo(1,U)):$.isEven()||$.subTo(w,$),$.rShiftTo(1,$);for(;N.isEven();)N.rShiftTo(1,N),S?((!G.isEven()||!Z.isEven())&&(G.addTo(this,G),Z.subTo(w,Z)),G.rShiftTo(1,G)):Z.isEven()||Z.subTo(w,Z),Z.rShiftTo(1,Z);E.compareTo(N)>=0?(E.subTo(N,E),S&&U.subTo(G,U),$.subTo(Z,$)):(N.subTo(E,N),S&&G.subTo(U,G),Z.subTo($,Z))}if(N.compareTo(s.ONE)!=0)return s.ZERO;if(Z.compareTo(w)>=0)return Z.subtract(w);if(Z.signum()<0)Z.addTo(w,Z);else return Z;return Z.signum()<0?Z.add(w):Z}var Mt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],IC=(1<<26)/Mt[Mt.length-1];function OC(w){var S,E=this.abs();if(E.t==1&&E[0]<=Mt[Mt.length-1]){for(S=0;S<Mt.length;++S)if(E[0]==Mt[S])return!0;return!1}if(E.isEven())return!1;for(S=1;S<Mt.length;){for(var N=Mt[S],U=S+1;U<Mt.length&&N<IC;)N*=Mt[U++];for(N=E.modInt(N);S<U;)if(N%Mt[S++]==0)return!1}return E.millerRabin(w)}function RC(w){var S=this.subtract(s.ONE),E=S.getLowestSetBit();if(E<=0)return!1;var N=S.shiftRight(E);w=w+1>>1,w>Mt.length&&(w=Mt.length);for(var U=o(),$=0;$<w;++$){U.fromInt(Mt[Math.floor(Math.random()*Mt.length)]);var G=U.modPow(N,this);if(G.compareTo(s.ONE)!=0&&G.compareTo(S)!=0){for(var Z=1;Z++<E&&G.compareTo(S)!=0;)if(G=G.modPowInt(2,this),G.compareTo(s.ONE)==0)return!1;if(G.compareTo(S)!=0)return!1}}return!0}s.prototype.chunkSize=Nt,s.prototype.toRadix=Hi,s.prototype.fromRadix=Gt,s.prototype.fromNumber=Er,s.prototype.bitwiseTo=A,s.prototype.changeBit=eC,s.prototype.addTo=iC,s.prototype.dMultiply=hC,s.prototype.dAddOffset=dC,s.prototype.multiplyLowerTo=yC,s.prototype.multiplyUpperTo=wC,s.prototype.modInt=xC,s.prototype.millerRabin=RC,s.prototype.clone=ir,s.prototype.intValue=Jr,s.prototype.byteValue=ji,s.prototype.shortValue=Yr,s.prototype.signum=_r,s.prototype.toByteArray=k,s.prototype.equals=d,s.prototype.min=g,s.prototype.max=b,s.prototype.and=L,s.prototype.or=Be,s.prototype.xor=Pe,s.prototype.andNot=WE,s.prototype.not=qE,s.prototype.shiftLeft=KE,s.prototype.shiftRight=GE,s.prototype.getLowestSetBit=YE,s.prototype.bitCount=ZE,s.prototype.testBit=XE,s.prototype.setBit=tC,s.prototype.clearBit=nC,s.prototype.flipBit=rC,s.prototype.add=sC,s.prototype.subtract=oC,s.prototype.multiply=lC,s.prototype.divide=uC,s.prototype.remainder=cC,s.prototype.divideAndRemainder=fC,s.prototype.modPow=CC,s.prototype.modInverse=TC,s.prototype.pow=mC,s.prototype.gcd=bC,s.prototype.isProbablePrime=OC,s.prototype.square=aC,s.prototype.Barrett=$i;var La,on,it;function AC(w){on[it++]^=w&255,on[it++]^=w>>8&255,on[it++]^=w>>16&255,on[it++]^=w>>24&255,it>=xf&&(it-=xf)}function Cm(){AC(new Date().getTime())}if(on==null){on=new Array,it=0;var Fn;if(typeof window<"u"&&window.crypto){if(window.crypto.getRandomValues){var bm=new Uint8Array(32);for(window.crypto.getRandomValues(bm),Fn=0;Fn<32;++Fn)on[it++]=bm[Fn]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var xm=window.crypto.random(32);for(Fn=0;Fn<xm.length;++Fn)on[it++]=xm.charCodeAt(Fn)&255}}for(;it<xf;)Fn=Math.floor(65536*Math.random()),on[it++]=Fn>>>8,on[it++]=Fn&255;it=0,Cm()}function NC(){if(La==null){for(Cm(),La=PC(),La.init(on),it=0;it<on.length;++it)on[it]=0;it=0}return La.next()}function MC(w){var S;for(S=0;S<w.length;++S)w[S]=NC()}function Tm(){}Tm.prototype.nextBytes=MC;function bf(){this.i=0,this.j=0,this.S=new Array}function DC(w){var S,E,N;for(S=0;S<256;++S)this.S[S]=S;for(E=0,S=0;S<256;++S)E=E+this.S[S]+w[S%w.length]&255,N=this.S[S],this.S[S]=this.S[E],this.S[E]=N;this.i=0,this.j=0}function BC(){var w;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,w=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=w,this.S[w+this.S[this.i]&255]}bf.prototype.init=DC,bf.prototype.next=BC;function PC(){return new bf}var xf=256;t.exports={default:s,BigInteger:s,SecureRandom:Tm}}).call(de)})(AE);var NE=AE.exports,Ba={};(function(t){(function(){var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function n(l){return i(o(l),arguments)}function r(l,a){return n.apply(null,[l].concat(a||[]))}function i(l,a){var u=1,c=l.length,f,h="",p,m,v,C,y,_,x,O;for(p=0;p<c;p++)if(typeof l[p]=="string")h+=l[p];else if(typeof l[p]=="object"){if(v=l[p],v.keys)for(f=a[u],m=0;m<v.keys.length;m++){if(f==null)throw new Error(n('[sprintf] Cannot access property "%s" of undefined value "%s"',v.keys[m],v.keys[m-1]));f=f[v.keys[m]]}else v.param_no?f=a[v.param_no]:f=a[u++];if(e.not_type.test(v.type)&&e.not_primitive.test(v.type)&&f instanceof Function&&(f=f()),e.numeric_arg.test(v.type)&&typeof f!="number"&&isNaN(f))throw new TypeError(n("[sprintf] expecting number but found %T",f));switch(e.number.test(v.type)&&(x=f>=0),v.type){case"b":f=parseInt(f,10).toString(2);break;case"c":f=String.fromCharCode(parseInt(f,10));break;case"d":case"i":f=parseInt(f,10);break;case"j":f=JSON.stringify(f,null,v.width?parseInt(v.width):0);break;case"e":f=v.precision?parseFloat(f).toExponential(v.precision):parseFloat(f).toExponential();break;case"f":f=v.precision?parseFloat(f).toFixed(v.precision):parseFloat(f);break;case"g":f=v.precision?String(Number(f.toPrecision(v.precision))):parseFloat(f);break;case"o":f=(parseInt(f,10)>>>0).toString(8);break;case"s":f=String(f),f=v.precision?f.substring(0,v.precision):f;break;case"t":f=String(!!f),f=v.precision?f.substring(0,v.precision):f;break;case"T":f=Object.prototype.toString.call(f).slice(8,-1).toLowerCase(),f=v.precision?f.substring(0,v.precision):f;break;case"u":f=parseInt(f,10)>>>0;break;case"v":f=f.valueOf(),f=v.precision?f.substring(0,v.precision):f;break;case"x":f=(parseInt(f,10)>>>0).toString(16);break;case"X":f=(parseInt(f,10)>>>0).toString(16).toUpperCase();break}e.json.test(v.type)?h+=f:(e.number.test(v.type)&&(!x||v.sign)?(O=x?"+":"-",f=f.toString().replace(e.sign,"")):O="",y=v.pad_char?v.pad_char==="0"?"0":v.pad_char.charAt(1):" ",_=v.width-(O+f).length,C=v.width&&_>0?y.repeat(_):"",h+=v.align?O+f+C:y==="0"?O+C+f:C+O+f)}return h}var s=Object.create(null);function o(l){if(s[l])return s[l];for(var a=l,u,c=[],f=0;a;){if((u=e.text.exec(a))!==null)c.push(u[0]);else if((u=e.modulo.exec(a))!==null)c.push("%");else if((u=e.placeholder.exec(a))!==null){if(u[2]){f|=1;var h=[],p=u[2],m=[];if((m=e.key.exec(p))!==null)for(h.push(m[1]);(p=p.substring(m[0].length))!=="";)if((m=e.key_access.exec(p))!==null)h.push(m[1]);else if((m=e.index_access.exec(p))!==null)h.push(m[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");u[2]=h}else f|=2;if(f===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");c.push({placeholder:u[0],param_no:u[1],keys:u[2],sign:u[3],pad_char:u[4],align:u[5],width:u[6],precision:u[7],type:u[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");a=a.substring(u[0].length)}return s[l]=c}t.sprintf=n,t.vsprintf=r,typeof window<"u"&&(window.sprintf=n,window.vsprintf=r)})()})(Ba);var TB=de&&de.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),IB=de&&de.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ME=de&&de.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&TB(e,t,n);return IB(e,t),e};Object.defineProperty(Da,"__esModule",{value:!0});Da.Address4=void 0;const J1=ME(Os),jn=ME(Gn),Y1=qo,rl=NE,Vs=Ba;class kn{constructor(e){this.groups=jn.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=J1.isCorrect(jn.BITS),this.isInSubnet=J1.isInSubnet,this.address=e;const n=jn.RE_SUBNET_STRING.exec(e);if(n){if(this.parsedSubnet=n[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet=`/${this.subnetMask}`,this.subnetMask<0||this.subnetMask>jn.BITS)throw new Y1.AddressError("Invalid subnet mask.");e=e.replace(jn.RE_SUBNET_STRING,"")}this.addressMinusSuffix=e,this.parsedAddress=this.parse(e)}static isValid(e){try{return new kn(e),!0}catch{return!1}}parse(e){const n=e.split(".");if(!e.match(jn.RE_ADDRESS))throw new Y1.AddressError("Invalid IPv4 address.");return n}correctForm(){return this.parsedAddress.map(e=>parseInt(e,10)).join(".")}static fromHex(e){const n=e.replace(/:/g,"").padStart(8,"0"),r=[];let i;for(i=0;i<8;i+=2){const s=n.slice(i,i+2);r.push(parseInt(s,16))}return new kn(r.join("."))}static fromInteger(e){return kn.fromHex(e.toString(16))}static fromArpa(e){const r=e.replace(/(\.in-addr\.arpa)?\.$/,"").split(".").reverse().join(".");return new kn(r)}toHex(){return this.parsedAddress.map(e=>(0,Vs.sprintf)("%02x",parseInt(e,10))).join(":")}toArray(){return this.parsedAddress.map(e=>parseInt(e,10))}toGroup6(){const e=[];let n;for(n=0;n<jn.GROUPS;n+=2){const r=(0,Vs.sprintf)("%02x%02x",parseInt(this.parsedAddress[n],10),parseInt(this.parsedAddress[n+1],10));e.push((0,Vs.sprintf)("%x",parseInt(r,16)))}return e.join(":")}bigInteger(){return new rl.BigInteger(this.parsedAddress.map(e=>(0,Vs.sprintf)("%02x",parseInt(e,10))).join(""),16)}_startAddress(){return new rl.BigInteger(this.mask()+"0".repeat(jn.BITS-this.subnetMask),2)}startAddress(){return kn.fromBigInteger(this._startAddress())}startAddressExclusive(){const e=new rl.BigInteger("1");return kn.fromBigInteger(this._startAddress().add(e))}_endAddress(){return new rl.BigInteger(this.mask()+"1".repeat(jn.BITS-this.subnetMask),2)}endAddress(){return kn.fromBigInteger(this._endAddress())}endAddressExclusive(){const e=new rl.BigInteger("1");return kn.fromBigInteger(this._endAddress().subtract(e))}static fromBigInteger(e){return kn.fromInteger(parseInt(e.toString(),10))}mask(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)}getBitsBase2(e,n){return this.binaryZeroPad().slice(e,n)}reverseForm(e){e||(e={});const n=this.correctForm().split(".").reverse().join(".");return e.omitSuffix?n:(0,Vs.sprintf)("%s.in-addr.arpa.",n)}isMulticast(){return this.isInSubnet(new kn("224.0.0.0/4"))}binaryZeroPad(){return this.bigInteger().toString(2).padStart(jn.BITS,"0")}groupForV6(){const e=this.parsedAddress;return this.address.replace(jn.RE_ADDRESS,(0,Vs.sprintf)('<span class="hover-group group-v4 group-6">%s</span>.<span class="hover-group group-v4 group-7">%s</span>',e.slice(0,2).join("."),e.slice(2,4).join(".")))}}Da.Address4=kn;var kf={},Ue={};Object.defineProperty(Ue,"__esModule",{value:!0});Ue.RE_URL_WITH_PORT=Ue.RE_URL=Ue.RE_ZONE_STRING=Ue.RE_SUBNET_STRING=Ue.RE_BAD_ADDRESS=Ue.RE_BAD_CHARACTERS=Ue.TYPES=Ue.SCOPES=Ue.GROUPS=Ue.BITS=void 0;Ue.BITS=128;Ue.GROUPS=8;Ue.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"};Ue.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"};Ue.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi;Ue.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi;Ue.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/;Ue.RE_ZONE_STRING=/%.*$/;Ue.RE_URL=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/);Ue.RE_URL_WITH_PORT=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/);var Jn={};Object.defineProperty(Jn,"__esModule",{value:!0});Jn.simpleGroup=Jn.spanLeadingZeroes=Jn.spanAll=Jn.spanAllZeroes=void 0;const DE=Ba;function BE(t){return t.replace(/(0+)/g,'<span class="zero">$1</span>')}Jn.spanAllZeroes=BE;function OB(t,e=0){return t.split("").map((r,i)=>(0,DE.sprintf)('<span class="digit value-%s position-%d">%s</span>',r,i+e,BE(r))).join("")}Jn.spanAll=OB;function PE(t){return t.replace(/^(0+)/,'<span class="zero">$1</span>')}function RB(t){return t.split(":").map(n=>PE(n)).join(":")}Jn.spanLeadingZeroes=RB;function AB(t,e=0){return t.split(":").map((r,i)=>/group-v4/.test(r)?r:(0,DE.sprintf)('<span class="hover-group group-%d">%s</span>',i+e,PE(r)))}Jn.simpleGroup=AB;var Rn={},NB=de&&de.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),MB=de&&de.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),DB=de&&de.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&NB(e,t,n);return MB(e,t),e};Object.defineProperty(Rn,"__esModule",{value:!0});Rn.possibleElisions=Rn.simpleRegularExpression=Rn.ADDRESS_BOUNDARY=Rn.padGroup=Rn.groupPossibilities=void 0;const BB=DB(Ue),so=Ba;function Lc(t){return(0,so.sprintf)("(%s)",t.join("|"))}Rn.groupPossibilities=Lc;function Fu(t){return t.length<4?(0,so.sprintf)("0{0,%d}%s",4-t.length,t):t}Rn.padGroup=Fu;Rn.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]";function PB(t){const e=[];t.forEach((r,i)=>{parseInt(r,16)===0&&e.push(i)});const n=e.map(r=>t.map((i,s)=>{if(s===r){const o=s===0||s===BB.GROUPS-1?":":"";return Lc([Fu(i),o])}return Fu(i)}).join(":"));return n.push(t.map(Fu).join(":")),Lc(n)}Rn.simpleRegularExpression=PB;function LB(t,e,n){const r=e?"":":",i=n?"":":",s=[];!e&&!n&&s.push("::"),e&&n&&s.push(""),(n&&!e||!n&&e)&&s.push(":"),s.push((0,so.sprintf)("%s(:0{1,4}){1,%d}",r,t-1)),s.push((0,so.sprintf)("(0{1,4}:){1,%d}%s",t-1,i)),s.push((0,so.sprintf)("(0{1,4}:){%d}0{1,4}",t-1));for(let o=1;o<t-1;o++)for(let l=1;l<t-o;l++)s.push((0,so.sprintf)("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",l,t-l-o-1));return Lc(s)}Rn.possibleElisions=LB;var FB=de&&de.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(e,n);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,r,i)}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),UB=de&&de.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),_f=de&&de.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.prototype.hasOwnProperty.call(t,n)&&FB(e,t,n);return UB(e,t),e};Object.defineProperty(kf,"__esModule",{value:!0});kf.Address6=void 0;const Q1=_f(Os),Wh=_f(Gn),Oe=_f(Ue),qh=_f(Jn),Wi=Da,qi=Rn,Tr=qo,Dt=NE,Bt=Ba;function pu(t){if(!t)throw new Error("Assertion failed.")}function zB(t){const e=/(\d+)(\d{3})/;for(;e.test(t);)t=t.replace(e,"$1,$2");return t}function VB(t){return t=t.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2'),t=t.replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2'),t}function jB(t,e){const n=[],r=[];let i;for(i=0;i<t.length;i++)i<e[0]?n.push(t[i]):i>e[1]&&r.push(t[i]);return n.concat(["compact"]).concat(r)}function Z1(t){return(0,Bt.sprintf)("%04x",parseInt(t,16))}function X1(t){return t&255}class ot{constructor(e,n){this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=Q1.isInSubnet,this.isCorrect=Q1.isCorrect(Oe.BITS),n===void 0?this.groups=Oe.GROUPS:this.groups=n,this.address=e;const r=Oe.RE_SUBNET_STRING.exec(e);if(r){if(this.parsedSubnet=r[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet=`/${this.subnetMask}`,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>Oe.BITS)throw new Tr.AddressError("Invalid subnet mask.");e=e.replace(Oe.RE_SUBNET_STRING,"")}else if(/\//.test(e))throw new Tr.AddressError("Invalid subnet mask.");const i=Oe.RE_ZONE_STRING.exec(e);i&&(this.zone=i[0],e=e.replace(Oe.RE_ZONE_STRING,"")),this.addressMinusSuffix=e,this.parsedAddress=this.parse(this.addressMinusSuffix)}static isValid(e){try{return new ot(e),!0}catch{return!1}}static fromBigInteger(e){const n=e.toString(16).padStart(32,"0"),r=[];let i;for(i=0;i<Oe.GROUPS;i++)r.push(n.slice(i*4,(i+1)*4));return new ot(r.join(":"))}static fromURL(e){let n,r=null,i;if(e.indexOf("[")!==-1&&e.indexOf("]:")!==-1){if(i=Oe.RE_URL_WITH_PORT.exec(e),i===null)return{error:"failed to parse address with port",address:null,port:null};n=i[1],r=i[2]}else if(e.indexOf("/")!==-1){if(e=e.replace(/^[a-z0-9]+:\/\//,""),i=Oe.RE_URL.exec(e),i===null)return{error:"failed to parse address from URL",address:null,port:null};n=i[1]}else n=e;return r?(r=parseInt(r,10),(r<0||r>65536)&&(r=null)):r=null,{address:new ot(n),port:r}}static fromAddress4(e){const n=new Wi.Address4(e),r=Oe.BITS-(Wh.BITS-n.subnetMask);return new ot(`::ffff:${n.correctForm()}/${r}`)}static fromArpa(e){let n=e.replace(/(\.ip6\.arpa)?\.$/,"");const r=7;if(n.length!==63)throw new Tr.AddressError("Invalid 'ip6.arpa' form.");const i=n.split(".").reverse();for(let s=r;s>0;s--){const o=s*4;i.splice(o,0,":")}return n=i.join(""),new ot(n)}microsoftTranscription(){return(0,Bt.sprintf)("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))}mask(e=this.subnetMask){return this.getBitsBase2(0,e)}possibleSubnets(e=128){const n=Oe.BITS-this.subnetMask,r=Math.abs(e-Oe.BITS),i=n-r;return i<0?"0":zB(new Dt.BigInteger("2",10).pow(i).toString(10))}_startAddress(){return new Dt.BigInteger(this.mask()+"0".repeat(Oe.BITS-this.subnetMask),2)}startAddress(){return ot.fromBigInteger(this._startAddress())}startAddressExclusive(){const e=new Dt.BigInteger("1");return ot.fromBigInteger(this._startAddress().add(e))}_endAddress(){return new Dt.BigInteger(this.mask()+"1".repeat(Oe.BITS-this.subnetMask),2)}endAddress(){return ot.fromBigInteger(this._endAddress())}endAddressExclusive(){const e=new Dt.BigInteger("1");return ot.fromBigInteger(this._endAddress().subtract(e))}getScope(){let e=Oe.SCOPES[this.getBits(12,16).intValue()];return this.getType()==="Global unicast"&&e!=="Link local"&&(e="Global"),e||"Unknown"}getType(){for(const e of Object.keys(Oe.TYPES))if(this.isInSubnet(new ot(e)))return Oe.TYPES[e];return"Global unicast"}getBits(e,n){return new Dt.BigInteger(this.getBitsBase2(e,n),2)}getBitsBase2(e,n){return this.binaryZeroPad().slice(e,n)}getBitsBase16(e,n){const r=n-e;if(r%4!==0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(e,n).toString(16).padStart(r/4,"0")}getBitsPastSubnet(){return this.getBitsBase2(this.subnetMask,Oe.BITS)}reverseForm(e){e||(e={});const n=Math.floor(this.subnetMask/4),r=this.canonicalForm().replace(/:/g,"").split("").slice(0,n).reverse().join(".");return n>0?e.omitSuffix?r:(0,Bt.sprintf)("%s.ip6.arpa.",r):e.omitSuffix?"":"ip6.arpa."}correctForm(){let e,n=[],r=0;const i=[];for(e=0;e<this.parsedAddress.length;e++){const l=parseInt(this.parsedAddress[e],16);l===0&&r++,l!==0&&r>0&&(r>1&&i.push([e-r,e-1]),r=0)}r>1&&i.push([this.parsedAddress.length-r,this.parsedAddress.length-1]);const s=i.map(l=>l[1]-l[0]+1);if(i.length>0){const l=s.indexOf(Math.max(...s));n=jB(this.parsedAddress,i[l])}else n=this.parsedAddress;for(e=0;e<n.length;e++)n[e]!=="compact"&&(n[e]=parseInt(n[e],16).toString(16));let o=n.join(":");return o=o.replace(/^compact$/,"::"),o=o.replace(/^compact|compact$/,":"),o=o.replace(/compact/,""),o}binaryZeroPad(){return this.bigInteger().toString(2).padStart(Oe.BITS,"0")}parse4in6(e){const n=e.split(":"),i=n.slice(-1)[0].match(Wh.RE_ADDRESS);if(i){this.parsedAddress4=i[0],this.address4=new Wi.Address4(this.parsedAddress4);for(let s=0;s<this.address4.groups;s++)if(/^0[0-9]+/.test(this.address4.parsedAddress[s]))throw new Tr.AddressError("IPv4 addresses can't have leading zeroes.",e.replace(Wh.RE_ADDRESS,this.address4.parsedAddress.map(VB).join(".")));this.v4=!0,n[n.length-1]=this.address4.toGroup6(),e=n.join(":")}return e}parse(e){e=this.parse4in6(e);const n=e.match(Oe.RE_BAD_CHARACTERS);if(n)throw new Tr.AddressError((0,Bt.sprintf)("Bad character%s detected in address: %s",n.length>1?"s":"",n.join("")),e.replace(Oe.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));const r=e.match(Oe.RE_BAD_ADDRESS);if(r)throw new Tr.AddressError((0,Bt.sprintf)("Address failed regex: %s",r.join("")),e.replace(Oe.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));let i=[];const s=e.split("::");if(s.length===2){let o=s[0].split(":"),l=s[1].split(":");o.length===1&&o[0]===""&&(o=[]),l.length===1&&l[0]===""&&(l=[]);const a=this.groups-(o.length+l.length);if(!a)throw new Tr.AddressError("Error parsing groups");this.elidedGroups=a,this.elisionBegin=o.length,this.elisionEnd=o.length+this.elidedGroups,i=i.concat(o);for(let u=0;u<a;u++)i.push("0");i=i.concat(l)}else if(s.length===1)i=e.split(":"),this.elidedGroups=0;else throw new Tr.AddressError("Too many :: groups found");if(i=i.map(o=>(0,Bt.sprintf)("%x",parseInt(o,16))),i.length!==this.groups)throw new Tr.AddressError("Incorrect number of groups found");return i}canonicalForm(){return this.parsedAddress.map(Z1).join(":")}decimal(){return this.parsedAddress.map(e=>(0,Bt.sprintf)("%05d",parseInt(e,16))).join(":")}bigInteger(){return new Dt.BigInteger(this.parsedAddress.map(Z1).join(""),16)}to4(){const e=this.binaryZeroPad().split("");return Wi.Address4.fromHex(new Dt.BigInteger(e.slice(96,128).join(""),2).toString(16))}to4in6(){const e=this.to4(),r=new ot(this.parsedAddress.slice(0,6).join(":"),6).correctForm();let i="";return/:$/.test(r)||(i=":"),r+i+e.address}inspectTeredo(){const e=this.getBitsBase16(0,32),n=this.getBits(80,96).xor(new Dt.BigInteger("ffff",16)).toString(),r=Wi.Address4.fromHex(this.getBitsBase16(32,64)),i=Wi.Address4.fromHex(this.getBits(96,128).xor(new Dt.BigInteger("ffffffff",16)).toString(16)),s=this.getBits(64,80),o=this.getBitsBase2(64,80),l=s.testBit(15),a=s.testBit(14),u=s.testBit(8),c=s.testBit(9),f=new Dt.BigInteger(o.slice(2,6)+o.slice(8,16),2).toString(10);return{prefix:(0,Bt.sprintf)("%s:%s",e.slice(0,4),e.slice(4,8)),server4:r.address,client4:i.address,flags:o,coneNat:l,microsoft:{reserved:a,universalLocal:c,groupIndividual:u,nonce:f},udpPort:n}}inspect6to4(){const e=this.getBitsBase16(0,16),n=Wi.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:(0,Bt.sprintf)("%s",e.slice(0,4)),gateway:n.address}}to6to4(){if(!this.is4())return null;const e=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new ot(e)}toByteArray(){const e=this.bigInteger().toByteArray();return e.length===17&&e[0]===0?e.slice(1):e}toUnsignedByteArray(){return this.toByteArray().map(X1)}static fromByteArray(e){return this.fromUnsignedByteArray(e.map(X1))}static fromUnsignedByteArray(e){const n=new Dt.BigInteger("256",10);let r=new Dt.BigInteger("0",10),i=new Dt.BigInteger("1",10);for(let s=e.length-1;s>=0;s--)r=r.add(i.multiply(new Dt.BigInteger(e[s].toString(10),10))),i=i.multiply(n);return ot.fromBigInteger(r)}isCanonical(){return this.addressMinusSuffix===this.canonicalForm()}isLinkLocal(){return this.getBitsBase2(0,64)==="1111111010000000000000000000000000000000000000000000000000000000"}isMulticast(){return this.getType()==="Multicast"}is4(){return this.v4}isTeredo(){return this.isInSubnet(new ot("2001::/32"))}is6to4(){return this.isInSubnet(new ot("2002::/16"))}isLoopback(){return this.getType()==="Loopback"}href(e){return e===void 0?e="":e=(0,Bt.sprintf)(":%s",e),(0,Bt.sprintf)("http://[%s]%s/",this.correctForm(),e)}link(e){e||(e={}),e.className===void 0&&(e.className=""),e.prefix===void 0&&(e.prefix="/#address="),e.v4===void 0&&(e.v4=!1);let n=this.correctForm;return e.v4&&(n=this.to4in6),e.className?(0,Bt.sprintf)('<a href="%1$s%2$s" class="%3$s">%2$s</a>',e.prefix,n.call(this),e.className):(0,Bt.sprintf)('<a href="%1$s%2$s">%2$s</a>',e.prefix,n.call(this))}group(){if(this.elidedGroups===0)return qh.simpleGroup(this.address).join(":");pu(typeof this.elidedGroups=="number"),pu(typeof this.elisionBegin=="number");const e=[],[n,r]=this.address.split("::");n.length?e.push(...qh.simpleGroup(n)):e.push("");const i=["hover-group"];for(let s=this.elisionBegin;s<this.elisionBegin+this.elidedGroups;s++)i.push((0,Bt.sprintf)("group-%d",s));return e.push((0,Bt.sprintf)('<span class="%s"></span>',i.join(" "))),r.length?e.push(...qh.simpleGroup(r,this.elisionEnd)):e.push(""),this.is4()&&(pu(this.address4 instanceof Wi.Address4),e.pop(),e.push(this.address4.groupForV6())),e.join(":")}regularExpressionString(e=!1){let n=[];const r=new ot(this.correctForm());if(r.elidedGroups===0)n.push((0,qi.simpleRegularExpression)(r.parsedAddress));else if(r.elidedGroups===Oe.GROUPS)n.push((0,qi.possibleElisions)(Oe.GROUPS));else{const i=r.address.split("::");i[0].length&&n.push((0,qi.simpleRegularExpression)(i[0].split(":"))),pu(typeof r.elidedGroups=="number"),n.push((0,qi.possibleElisions)(r.elidedGroups,i[0].length!==0,i[1].length!==0)),i[1].length&&n.push((0,qi.simpleRegularExpression)(i[1].split(":"))),n=[n.join(":")]}return e||(n=["(?=^|",qi.ADDRESS_BOUNDARY,"|[^\\w\\:])(",...n,")(?=[^\\w\\:]|",qi.ADDRESS_BOUNDARY,"|$)"]),n.join("")}regularExpression(e=!1){return new RegExp(this.regularExpressionString(e),"i")}}kf.Address6=ot;(function(t){var e=de&&de.__createBinding||(Object.create?function(a,u,c,f){f===void 0&&(f=c);var h=Object.getOwnPropertyDescriptor(u,c);(!h||("get"in h?!u.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return u[c]}}),Object.defineProperty(a,f,h)}:function(a,u,c,f){f===void 0&&(f=c),a[f]=u[c]}),n=de&&de.__setModuleDefault||(Object.create?function(a,u){Object.defineProperty(a,"default",{enumerable:!0,value:u})}:function(a,u){a.default=u}),r=de&&de.__importStar||function(a){if(a&&a.__esModule)return a;var u={};if(a!=null)for(var c in a)c!=="default"&&Object.prototype.hasOwnProperty.call(a,c)&&e(u,a,c);return n(u,a),u};Object.defineProperty(t,"__esModule",{value:!0}),t.v6=t.AddressError=t.Address6=t.Address4=void 0;const i=Da;Object.defineProperty(t,"Address4",{enumerable:!0,get:function(){return i.Address4}});const s=kf;Object.defineProperty(t,"Address6",{enumerable:!0,get:function(){return s.Address6}});const o=qo;Object.defineProperty(t,"AddressError",{enumerable:!0,get:function(){return o.AddressError}});const l=r(Jn);t.v6={helpers:l}})(km);Object.defineProperty(On,"__esModule",{value:!0});On.ipToBuffer=On.int32ToIpv4=On.ipv4ToInt32=On.validateSocksClientChainOptions=On.validateSocksClientOptions=void 0;const Ft=Is,ut=xe,HB=Wo,Dp=km,ew=Wo;function $B(t,e=["connect","bind","associate"]){if(!ut.SocksCommand[t.command])throw new Ft.SocksClientError(ut.ERRORS.InvalidSocksCommand,t);if(e.indexOf(t.command)===-1)throw new Ft.SocksClientError(ut.ERRORS.InvalidSocksCommandForOperation,t);if(!FE(t.destination))throw new Ft.SocksClientError(ut.ERRORS.InvalidSocksClientOptionsDestination,t);if(!UE(t.proxy))throw new Ft.SocksClientError(ut.ERRORS.InvalidSocksClientOptionsProxy,t);if(LE(t.proxy,t),t.timeout&&!zE(t.timeout))throw new Ft.SocksClientError(ut.ERRORS.InvalidSocksClientOptionsTimeout,t);if(t.existing_socket&&!(t.existing_socket instanceof HB.Duplex))throw new Ft.SocksClientError(ut.ERRORS.InvalidSocksClientOptionsExistingSocket,t)}On.validateSocksClientOptions=$B;function WB(t){if(t.command!=="connect")throw new Ft.SocksClientError(ut.ERRORS.InvalidSocksCommandChain,t);if(!FE(t.destination))throw new Ft.SocksClientError(ut.ERRORS.InvalidSocksClientOptionsDestination,t);if(!(t.proxies&&Array.isArray(t.proxies)&&t.proxies.length>=2))throw new Ft.SocksClientError(ut.ERRORS.InvalidSocksClientOptionsProxiesLength,t);if(t.proxies.forEach(e=>{if(!UE(e))throw new Ft.SocksClientError(ut.ERRORS.InvalidSocksClientOptionsProxy,t);LE(e,t)}),t.timeout&&!zE(t.timeout))throw new Ft.SocksClientError(ut.ERRORS.InvalidSocksClientOptionsTimeout,t)}On.validateSocksClientChainOptions=WB;function LE(t,e){if(t.custom_auth_method!==void 0){if(t.custom_auth_method<ut.SOCKS5_CUSTOM_AUTH_START||t.custom_auth_method>ut.SOCKS5_CUSTOM_AUTH_END)throw new Ft.SocksClientError(ut.ERRORS.InvalidSocksClientOptionsCustomAuthRange,e);if(t.custom_auth_request_handler===void 0||typeof t.custom_auth_request_handler!="function")throw new Ft.SocksClientError(ut.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,e);if(t.custom_auth_response_size===void 0)throw new Ft.SocksClientError(ut.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,e);if(t.custom_auth_response_handler===void 0||typeof t.custom_auth_response_handler!="function")throw new Ft.SocksClientError(ut.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,e)}}function FE(t){return t&&typeof t.host=="string"&&typeof t.port=="number"&&t.port>=0&&t.port<=65535}function UE(t){return t&&(typeof t.host=="string"||typeof t.ipaddress=="string")&&typeof t.port=="number"&&t.port>=0&&t.port<=65535&&(t.type===4||t.type===5)}function zE(t){return typeof t=="number"&&t>0}function qB(t){return new Dp.Address4(t).toArray().reduce((n,r)=>(n<<8)+r,0)}On.ipv4ToInt32=qB;function KB(t){const e=t>>>24&255,n=t>>>16&255,r=t>>>8&255,i=t&255;return[e,n,r,i].join(".")}On.int32ToIpv4=KB;function GB(t){if(ew.isIPv4(t)){const e=new Dp.Address4(t);return Buffer.from(e.toArray())}else if(ew.isIPv6(t)){const e=new Dp.Address6(t);return Buffer.from(e.toByteArray())}else throw new Error("Invalid IP address format")}On.ipToBuffer=GB;var Ef={};Object.defineProperty(Ef,"__esModule",{value:!0});Ef.ReceiveBuffer=void 0;class JB{constructor(e=4096){this.buffer=Buffer.allocUnsafe(e),this.offset=0,this.originalSize=e}get length(){return this.offset}append(e){if(!Buffer.isBuffer(e))throw new Error("Attempted to append a non-buffer instance to ReceiveBuffer.");if(this.offset+e.length>=this.buffer.length){const n=this.buffer;this.buffer=Buffer.allocUnsafe(Math.max(this.buffer.length+this.originalSize,this.buffer.length+e.length)),n.copy(this.buffer)}return e.copy(this.buffer,this.offset),this.offset+=e.length}peek(e){if(e>this.offset)throw new Error("Attempted to read beyond the bounds of the managed internal data.");return this.buffer.slice(0,e)}get(e){if(e>this.offset)throw new Error("Attempted to read beyond the bounds of the managed internal data.");const n=Buffer.allocUnsafe(e);return this.buffer.slice(0,e).copy(n),this.buffer.copyWithin(0,e,e+this.offset-e),this.offset-=e,n}}Ef.ReceiveBuffer=JB;(function(t){var e=de&&de.__awaiter||function(f,h,p,m){function v(C){return C instanceof p?C:new p(function(y){y(C)})}return new(p||(p=Promise))(function(C,y){function _(R){try{O(m.next(R))}catch(P){y(P)}}function x(R){try{O(m.throw(R))}catch(P){y(P)}}function O(R){R.done?C(R.value):v(R.value).then(_,x)}O((m=m.apply(f,h||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.SocksClientError=t.SocksClient=void 0;const n=ym,r=Wo,i=Sm,s=xe,o=On,l=Ef,a=Is;Object.defineProperty(t,"SocksClientError",{enumerable:!0,get:function(){return a.SocksClientError}});const u=km;class c extends n.EventEmitter{constructor(h){super(),this.options=Object.assign({},h),(0,o.validateSocksClientOptions)(h),this.setState(s.SocksClientState.Created)}static createConnection(h,p){return new Promise((m,v)=>{try{(0,o.validateSocksClientOptions)(h,["connect"])}catch(y){return typeof p=="function"?(p(y),m(y)):v(y)}const C=new c(h);C.connect(h.existing_socket),C.once("established",y=>{C.removeAllListeners(),typeof p=="function"&&p(null,y),m(y)}),C.once("error",y=>{C.removeAllListeners(),typeof p=="function"?(p(y),m(y)):v(y)})})}static createConnectionChain(h,p){return new Promise((m,v)=>e(this,void 0,void 0,function*(){try{(0,o.validateSocksClientChainOptions)(h)}catch(C){return typeof p=="function"?(p(C),m(C)):v(C)}h.randomizeChain&&(0,a.shuffleArray)(h.proxies);try{let C;for(let y=0;y<h.proxies.length;y++){const _=h.proxies[y],x=y===h.proxies.length-1?h.destination:{host:h.proxies[y+1].host||h.proxies[y+1].ipaddress,port:h.proxies[y+1].port},O=yield c.createConnection({command:"connect",proxy:_,destination:x,existing_socket:C});C=C||O.socket}typeof p=="function"?(p(null,{socket:C}),m({socket:C})):m({socket:C})}catch(C){typeof p=="function"?(p(C),m(C)):v(C)}}))}static createUDPFrame(h){const p=new i.SmartBuffer;return p.writeUInt16BE(0),p.writeUInt8(h.frameNumber||0),r.isIPv4(h.remoteHost.host)?(p.writeUInt8(s.Socks5HostType.IPv4),p.writeUInt32BE((0,o.ipv4ToInt32)(h.remoteHost.host))):r.isIPv6(h.remoteHost.host)?(p.writeUInt8(s.Socks5HostType.IPv6),p.writeBuffer((0,o.ipToBuffer)(h.remoteHost.host))):(p.writeUInt8(s.Socks5HostType.Hostname),p.writeUInt8(Buffer.byteLength(h.remoteHost.host)),p.writeString(h.remoteHost.host)),p.writeUInt16BE(h.remoteHost.port),p.writeBuffer(h.data),p.toBuffer()}static parseUDPFrame(h){const p=i.SmartBuffer.fromBuffer(h);p.readOffset=2;const m=p.readUInt8(),v=p.readUInt8();let C;v===s.Socks5HostType.IPv4?C=(0,o.int32ToIpv4)(p.readUInt32BE()):v===s.Socks5HostType.IPv6?C=u.Address6.fromByteArray(Array.from(p.readBuffer(16))).canonicalForm():C=p.readString(p.readUInt8());const y=p.readUInt16BE();return{frameNumber:m,remoteHost:{host:C,port:y},data:p.readBuffer()}}setState(h){this.state!==s.SocksClientState.Error&&(this.state=h)}connect(h){this.onDataReceived=m=>this.onDataReceivedHandler(m),this.onClose=()=>this.onCloseHandler(),this.onError=m=>this.onErrorHandler(m),this.onConnect=()=>this.onConnectHandler();const p=setTimeout(()=>this.onEstablishedTimeout(),this.options.timeout||s.DEFAULT_TIMEOUT);p.unref&&typeof p.unref=="function"&&p.unref(),h?this.socket=h:this.socket=new r.Socket,this.socket.once("close",this.onClose),this.socket.once("error",this.onError),this.socket.once("connect",this.onConnect),this.socket.on("data",this.onDataReceived),this.setState(s.SocksClientState.Connecting),this.receiveBuffer=new l.ReceiveBuffer,h?this.socket.emit("connect"):(this.socket.connect(this.getSocketOptions()),this.options.set_tcp_nodelay!==void 0&&this.options.set_tcp_nodelay!==null&&this.socket.setNoDelay(!!this.options.set_tcp_nodelay)),this.prependOnceListener("established",m=>{setImmediate(()=>{if(this.receiveBuffer.length>0){const v=this.receiveBuffer.get(this.receiveBuffer.length);m.socket.emit("data",v)}m.socket.resume()})})}getSocketOptions(){return Object.assign(Object.assign({},this.options.socket_options),{host:this.options.proxy.host||this.options.proxy.ipaddress,port:this.options.proxy.port})}onEstablishedTimeout(){this.state!==s.SocksClientState.Established&&this.state!==s.SocksClientState.BoundWaitingForConnection&&this.closeSocket(s.ERRORS.ProxyConnectionTimedOut)}onConnectHandler(){this.setState(s.SocksClientState.Connected),this.options.proxy.type===4?this.sendSocks4InitialHandshake():this.sendSocks5InitialHandshake(),this.setState(s.SocksClientState.SentInitialHandshake)}onDataReceivedHandler(h){this.receiveBuffer.append(h),this.processData()}processData(){for(;this.state!==s.SocksClientState.Established&&this.state!==s.SocksClientState.Error&&this.receiveBuffer.length>=this.nextRequiredPacketBufferSize;)if(this.state===s.SocksClientState.SentInitialHandshake)this.options.proxy.type===4?this.handleSocks4FinalHandshakeResponse():this.handleInitialSocks5HandshakeResponse();else if(this.state===s.SocksClientState.SentAuthentication)this.handleInitialSocks5AuthenticationHandshakeResponse();else if(this.state===s.SocksClientState.SentFinalHandshake)this.handleSocks5FinalHandshakeResponse();else if(this.state===s.SocksClientState.BoundWaitingForConnection)this.options.proxy.type===4?this.handleSocks4IncomingConnectionResponse():this.handleSocks5IncomingConnectionResponse();else{this.closeSocket(s.ERRORS.InternalError);break}}onCloseHandler(){this.closeSocket(s.ERRORS.SocketClosed)}onErrorHandler(h){this.closeSocket(h.message)}removeInternalSocketHandlers(){this.socket.pause(),this.socket.removeListener("data",this.onDataReceived),this.socket.removeListener("close",this.onClose),this.socket.removeListener("error",this.onError),this.socket.removeListener("connect",this.onConnect)}closeSocket(h){this.state!==s.SocksClientState.Error&&(this.setState(s.SocksClientState.Error),this.socket.destroy(),this.removeInternalSocketHandlers(),this.emit("error",new a.SocksClientError(h,this.options)))}sendSocks4InitialHandshake(){const h=this.options.proxy.userId||"",p=new i.SmartBuffer;p.writeUInt8(4),p.writeUInt8(s.SocksCommand[this.options.command]),p.writeUInt16BE(this.options.destination.port),r.isIPv4(this.options.destination.host)?(p.writeBuffer((0,o.ipToBuffer)(this.options.destination.host)),p.writeStringNT(h)):(p.writeUInt8(0),p.writeUInt8(0),p.writeUInt8(0),p.writeUInt8(1),p.writeStringNT(h),p.writeStringNT(this.options.destination.host)),this.nextRequiredPacketBufferSize=s.SOCKS_INCOMING_PACKET_SIZES.Socks4Response,this.socket.write(p.toBuffer())}handleSocks4FinalHandshakeResponse(){const h=this.receiveBuffer.get(8);if(h[1]!==s.Socks4Response.Granted)this.closeSocket(`${s.ERRORS.Socks4ProxyRejectedConnection} - (${s.Socks4Response[h[1]]})`);else if(s.SocksCommand[this.options.command]===s.SocksCommand.bind){const p=i.SmartBuffer.fromBuffer(h);p.readOffset=2;const m={port:p.readUInt16BE(),host:(0,o.int32ToIpv4)(p.readUInt32BE())};m.host==="0.0.0.0"&&(m.host=this.options.proxy.ipaddress),this.setState(s.SocksClientState.BoundWaitingForConnection),this.emit("bound",{remoteHost:m,socket:this.socket})}else this.setState(s.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{socket:this.socket})}handleSocks4IncomingConnectionResponse(){const h=this.receiveBuffer.get(8);if(h[1]!==s.Socks4Response.Granted)this.closeSocket(`${s.ERRORS.Socks4ProxyRejectedIncomingBoundConnection} - (${s.Socks4Response[h[1]]})`);else{const p=i.SmartBuffer.fromBuffer(h);p.readOffset=2;const m={port:p.readUInt16BE(),host:(0,o.int32ToIpv4)(p.readUInt32BE())};this.setState(s.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:m,socket:this.socket})}}sendSocks5InitialHandshake(){const h=new i.SmartBuffer,p=[s.Socks5Auth.NoAuth];(this.options.proxy.userId||this.options.proxy.password)&&p.push(s.Socks5Auth.UserPass),this.options.proxy.custom_auth_method!==void 0&&p.push(this.options.proxy.custom_auth_method),h.writeUInt8(5),h.writeUInt8(p.length);for(const m of p)h.writeUInt8(m);this.nextRequiredPacketBufferSize=s.SOCKS_INCOMING_PACKET_SIZES.Socks5InitialHandshakeResponse,this.socket.write(h.toBuffer()),this.setState(s.SocksClientState.SentInitialHandshake)}handleInitialSocks5HandshakeResponse(){const h=this.receiveBuffer.get(2);h[0]!==5?this.closeSocket(s.ERRORS.InvalidSocks5IntiailHandshakeSocksVersion):h[1]===s.SOCKS5_NO_ACCEPTABLE_AUTH?this.closeSocket(s.ERRORS.InvalidSocks5InitialHandshakeNoAcceptedAuthType):h[1]===s.Socks5Auth.NoAuth?(this.socks5ChosenAuthType=s.Socks5Auth.NoAuth,this.sendSocks5CommandRequest()):h[1]===s.Socks5Auth.UserPass?(this.socks5ChosenAuthType=s.Socks5Auth.UserPass,this.sendSocks5UserPassAuthentication()):h[1]===this.options.proxy.custom_auth_method?(this.socks5ChosenAuthType=this.options.proxy.custom_auth_method,this.sendSocks5CustomAuthentication()):this.closeSocket(s.ERRORS.InvalidSocks5InitialHandshakeUnknownAuthType)}sendSocks5UserPassAuthentication(){const h=this.options.proxy.userId||"",p=this.options.proxy.password||"",m=new i.SmartBuffer;m.writeUInt8(1),m.writeUInt8(Buffer.byteLength(h)),m.writeString(h),m.writeUInt8(Buffer.byteLength(p)),m.writeString(p),this.nextRequiredPacketBufferSize=s.SOCKS_INCOMING_PACKET_SIZES.Socks5UserPassAuthenticationResponse,this.socket.write(m.toBuffer()),this.setState(s.SocksClientState.SentAuthentication)}sendSocks5CustomAuthentication(){return e(this,void 0,void 0,function*(){this.nextRequiredPacketBufferSize=this.options.proxy.custom_auth_response_size,this.socket.write(yield this.options.proxy.custom_auth_request_handler()),this.setState(s.SocksClientState.SentAuthentication)})}handleSocks5CustomAuthHandshakeResponse(h){return e(this,void 0,void 0,function*(){return yield this.options.proxy.custom_auth_response_handler(h)})}handleSocks5AuthenticationNoAuthHandshakeResponse(h){return e(this,void 0,void 0,function*(){return h[1]===0})}handleSocks5AuthenticationUserPassHandshakeResponse(h){return e(this,void 0,void 0,function*(){return h[1]===0})}handleInitialSocks5AuthenticationHandshakeResponse(){return e(this,void 0,void 0,function*(){this.setState(s.SocksClientState.ReceivedAuthenticationResponse);let h=!1;this.socks5ChosenAuthType===s.Socks5Auth.NoAuth?h=yield this.handleSocks5AuthenticationNoAuthHandshakeResponse(this.receiveBuffer.get(2)):this.socks5ChosenAuthType===s.Socks5Auth.UserPass?h=yield this.handleSocks5AuthenticationUserPassHandshakeResponse(this.receiveBuffer.get(2)):this.socks5ChosenAuthType===this.options.proxy.custom_auth_method&&(h=yield this.handleSocks5CustomAuthHandshakeResponse(this.receiveBuffer.get(this.options.proxy.custom_auth_response_size))),h?this.sendSocks5CommandRequest():this.closeSocket(s.ERRORS.Socks5AuthenticationFailed)})}sendSocks5CommandRequest(){const h=new i.SmartBuffer;h.writeUInt8(5),h.writeUInt8(s.SocksCommand[this.options.command]),h.writeUInt8(0),r.isIPv4(this.options.destination.host)?(h.writeUInt8(s.Socks5HostType.IPv4),h.writeBuffer((0,o.ipToBuffer)(this.options.destination.host))):r.isIPv6(this.options.destination.host)?(h.writeUInt8(s.Socks5HostType.IPv6),h.writeBuffer((0,o.ipToBuffer)(this.options.destination.host))):(h.writeUInt8(s.Socks5HostType.Hostname),h.writeUInt8(this.options.destination.host.length),h.writeString(this.options.destination.host)),h.writeUInt16BE(this.options.destination.port),this.nextRequiredPacketBufferSize=s.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHeader,this.socket.write(h.toBuffer()),this.setState(s.SocksClientState.SentFinalHandshake)}handleSocks5FinalHandshakeResponse(){const h=this.receiveBuffer.peek(5);if(h[0]!==5||h[1]!==s.Socks5Response.Granted)this.closeSocket(`${s.ERRORS.InvalidSocks5FinalHandshakeRejected} - ${s.Socks5Response[h[1]]}`);else{const p=h[3];let m,v;if(p===s.Socks5HostType.IPv4){const C=s.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv4;if(this.receiveBuffer.length<C){this.nextRequiredPacketBufferSize=C;return}v=i.SmartBuffer.fromBuffer(this.receiveBuffer.get(C).slice(4)),m={host:(0,o.int32ToIpv4)(v.readUInt32BE()),port:v.readUInt16BE()},m.host==="0.0.0.0"&&(m.host=this.options.proxy.ipaddress)}else if(p===s.Socks5HostType.Hostname){const C=h[4],y=s.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHostname(C);if(this.receiveBuffer.length<y){this.nextRequiredPacketBufferSize=y;return}v=i.SmartBuffer.fromBuffer(this.receiveBuffer.get(y).slice(5)),m={host:v.readString(C),port:v.readUInt16BE()}}else if(p===s.Socks5HostType.IPv6){const C=s.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv6;if(this.receiveBuffer.length<C){this.nextRequiredPacketBufferSize=C;return}v=i.SmartBuffer.fromBuffer(this.receiveBuffer.get(C).slice(4)),m={host:u.Address6.fromByteArray(Array.from(v.readBuffer(16))).canonicalForm(),port:v.readUInt16BE()}}this.setState(s.SocksClientState.ReceivedFinalResponse),s.SocksCommand[this.options.command]===s.SocksCommand.connect?(this.setState(s.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:m,socket:this.socket})):s.SocksCommand[this.options.command]===s.SocksCommand.bind?(this.setState(s.SocksClientState.BoundWaitingForConnection),this.nextRequiredPacketBufferSize=s.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHeader,this.emit("bound",{remoteHost:m,socket:this.socket})):s.SocksCommand[this.options.command]===s.SocksCommand.associate&&(this.setState(s.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:m,socket:this.socket}))}}handleSocks5IncomingConnectionResponse(){const h=this.receiveBuffer.peek(5);if(h[0]!==5||h[1]!==s.Socks5Response.Granted)this.closeSocket(`${s.ERRORS.Socks5ProxyRejectedIncomingBoundConnection} - ${s.Socks5Response[h[1]]}`);else{const p=h[3];let m,v;if(p===s.Socks5HostType.IPv4){const C=s.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv4;if(this.receiveBuffer.length<C){this.nextRequiredPacketBufferSize=C;return}v=i.SmartBuffer.fromBuffer(this.receiveBuffer.get(C).slice(4)),m={host:(0,o.int32ToIpv4)(v.readUInt32BE()),port:v.readUInt16BE()},m.host==="0.0.0.0"&&(m.host=this.options.proxy.ipaddress)}else if(p===s.Socks5HostType.Hostname){const C=h[4],y=s.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHostname(C);if(this.receiveBuffer.length<y){this.nextRequiredPacketBufferSize=y;return}v=i.SmartBuffer.fromBuffer(this.receiveBuffer.get(y).slice(5)),m={host:v.readString(C),port:v.readUInt16BE()}}else if(p===s.Socks5HostType.IPv6){const C=s.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv6;if(this.receiveBuffer.length<C){this.nextRequiredPacketBufferSize=C;return}v=i.SmartBuffer.fromBuffer(this.receiveBuffer.get(C).slice(4)),m={host:u.Address6.fromByteArray(Array.from(v.readBuffer(16))).canonicalForm(),port:v.readUInt16BE()}}this.setState(s.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:m,socket:this.socket})}}get socksClientOptions(){return Object.assign({},this.options)}}t.SocksClient=c})(TE);(function(t){var e=de&&de.__createBinding||(Object.create?function(r,i,s,o){o===void 0&&(o=s);var l=Object.getOwnPropertyDescriptor(i,s);(!l||("get"in l?!i.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(r,o,l)}:function(r,i,s,o){o===void 0&&(o=s),r[o]=i[s]}),n=de&&de.__exportStar||function(r,i){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,r,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(TE,t)})(xE);const YB=zc(xE),Ir={},QB=10*1e3,ZB=60*60*1e3,XB=5*60*1e3,eP=50*1e3,tw=16e3;class VE{constructor(){this.callbacks={}}on(e,n){this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n)}emit(e,n){let r=this.callbacks[e];r&&r.forEach(i=>i(n))}}class tP extends VE{constructor(e=[],n=""){super(),this.announceURLs=e,this.trackers={},this.peers={},this.msgChunks={},this.responseWaiting={},n&&this.setIdentifier(n),this._peerIdBuffer=Z_(20),this._peerId=pm(this._peerIdBuffer),this._peerIdBinary=Nl(this._peerId)}async setIdentifier(e){this.identifierString=e,this.infoHash=VM(e,"hex"),this._infoHashBuffer=Q_((await this.infoHash).toLowerCase()),this._infoHashBinary=Nl((await this.infoHash).toLowerCase())}async start(){await this.infoHash,this.on("peer",e=>{let n=!1;this.peers[e.id]||(n=!0,this.peers[e.id]={},this.responseWaiting[e.id]={}),e.on("connect",()=>{this.peers[e.id][e.channelName]=e,n&&this.emit("peerconnect",e)}),e.on("error",r=>{this._removePeer(e),console.log("Error in connection : "+r)}),e.on("close",()=>{this._removePeer(e),console.log("Connection closed with "+e.id)})}),this.on("update",e=>{const n=this.trackers[this.announceURLs.indexOf(e.announce)];this.emit("trackerconnect",n,this.getTrackerStats())}),this.on("warning",e=>{this.emit("trackerwarning",e,this.getTrackerStats())}),this._fetchPeers()}addTracker(e){if(this.announceURLs.indexOf(e)!==-1)throw new Error("Tracker already added");const n=this.announceURLs.push(e);this.trackers[n]=new Fc(this,e),this.trackers[n].announce(this._defaultAnnounceOpts())}removeTracker(e){const n=this.announceURLs.indexOf(e);if(n===-1)throw new Error("Tracker does not exist");this.trackers[n].peers=[],this.trackers[n].destroy(),delete this.trackers[n],delete this.announceURLs[n]}_removePeer(e){if(!this.peers[e.id])return!1;delete this.peers[e.id][e.channelName],Object.keys(this.peers[e.id]).length===0&&(this.emit("peerclose",e),delete this.responseWaiting[e.id],delete this.peers[e.id])}send(e,n,r=""){return new Promise((i,s)=>{const o={id:r!==""?r:Math.floor(Math.random()*1e5+1e5),msg:n};typeof n=="object"&&(o.msg=JSON.stringify(n),o.o=1);try{if(!e.connected){for(const u in this.peers[e.id])if(e=this.peers[e.id][u],e.connected)break}this.responseWaiting[e.id]||(this.responseWaiting[e.id]={}),this.responseWaiting[e.id][o.id]=i}catch(u){return s(Error("Connection to peer closed"+u))}let l=0,a="";for(;o.msg.length>0;)o.c=l,a=o.msg.slice(tw),o.msg=o.msg.slice(0,tw),a||(o.last=!0),console.log(`SENDING TO PEER: ${JSON.stringify(o)}`),e.send(JSON_MESSAGE_IDENTIFIER+JSON.stringify(o)),o.msg=a,l++;console.log(`sent a message to ${e.id}, chunks: ${l}`)})}requestMorePeers(){return new Promise(e=>{for(const n in this.trackers)this.trackers[n].announce(this._defaultAnnounceOpts());e(this.peers)})}getTrackerStats(){let e=0;for(const n in this.trackers)this.trackers[n].socket&&this.trackers[n].socket.connected&&e++;return{connected:e,total:this.announceURLs.length}}destroy(){let e;for(e in this.peers)for(const n in this.peers[e])this.peers[e][n].destroy();for(e in this.trackers)this.trackers[e].destroy()}_peerRespond(e,n){return r=>this.send(e,r,n)}_chunkHandler(e){return this.msgChunks[e.id]||(this.msgChunks[e.id]=[]),this.msgChunks[e.id][e.c]=e.msg,e.last?this.msgChunks[e.id].join(""):!1}_destroyChunks(e){delete this.msgChunks[e]}_defaultAnnounceOpts(e={}){return e.numwant==null&&(e.numwant=50),e.uploaded==null&&(e.uploaded=0),e.downloaded==null&&(e.downloaded=0),e}_fetchPeers(){for(const e in this.announceURLs)this.trackers[e]=new Fc(this,this.announceURLs[e]),this.trackers[e].announce(this._defaultAnnounceOpts())}}class nP extends VE{constructor(e,n){super(),this.client=e,this.announceUrl=n,this.interval=null,this.destroyed=!1}setInterval(e){e==null&&(e=this.DEFAULT_ANNOUNCE_INTERVAL),clearInterval(this.interval),e&&(this.interval=setInterval(()=>{this.announce(this.client._defaultAnnounceOpts())},e),this.interval.unref&&this.interval.unref())}}class Fc extends nP{constructor(e,n){super(e,n),console.log("new websocket tracker %s",n),this.peers={},this.socket=null,this.reconnecting=!1,this.retries=0,this.reconnectTimer=null,this.expectingResponse=!1,this._openSocket()}announce(e){if(this.destroyed||this.reconnecting)return;if(!this.socket.connected){this.socket.once("connect",()=>{this.announce(e)});return}const n=Object.assign({},e,{action:"announce",info_hash:this.client._infoHashBinary,peer_id:this.client._peerIdBinary});if(this._trackerId&&(n.trackerid=this._trackerId),e.event==="stopped"||e.event==="completed")this._send(n);else{const r=Math.min(e.numwant,5);this._generateOffers(r,i=>{n.numwant=r,n.offers=i,this._send(n)})}}scrape(e){if(this.destroyed||this.reconnecting)return;if(!this.socket.connected){this.socket.once("connect",()=>{this.scrape(e)});return}const r={action:"scrape",info_hash:Array.isArray(e.infoHash)&&e.infoHash.length>0?e.infoHash.map(i=>Nl(i)):e.infoHash&&Nl(e.infoHash)||this.client._infoHashBinary};this._send(r)}destroy(e=nw){if(this.destroyed)return e(null);this.destroyed=!0,clearInterval(this.interval),clearTimeout(this.reconnectTimer);for(const s in this.peers){const o=this.peers[s];clearTimeout(o.trackerTimeout),o.destroy()}if(this.peers=null,this.socket&&(this.socket.removeListener("connect",this._onSocketConnectBound),this.socket.removeListener("data",this._onSocketDataBound),this.socket.removeListener("close",this._onSocketCloseBound),this.socket.removeListener("error",this._onSocketErrorBound),this.socket=null),this._onSocketConnectBound=null,this._onSocketErrorBound=null,this._onSocketDataBound=null,this._onSocketCloseBound=null,Ir[this.announceUrl]&&(Ir[this.announceUrl].consumers-=1),Ir[this.announceUrl].consumers>0)return e();let n=Ir[this.announceUrl];delete Ir[this.announceUrl],n.on("error",nw),n.once("close",e);let r;if(!this.expectingResponse)return i();r=setTimeout(i,1e3),n.once("data",i);function i(){r&&(clearTimeout(r),r=null),n.removeListener("data",i),n.destroy(),n=null}}_openSocket(){if(this.destroyed=!1,this.peers||(this.peers={}),this._onSocketConnectBound=()=>{this._onSocketConnect()},this._onSocketErrorBound=e=>{this._onSocketError(e)},this._onSocketDataBound=e=>{this._onSocketData(e)},this._onSocketCloseBound=()=>{this._onSocketClose()},this.socket=Ir[this.announceUrl],this.socket)Ir[this.announceUrl].consumers+=1,this.socket.connected&&this._onSocketConnectBound();else{const e=new URL(this.announceUrl);let n;this.client._proxyOpts&&(n=e.protocol==="wss:"?this.client._proxyOpts.httpsAgent:this.client._proxyOpts.httpAgent,!n&&this.client._proxyOpts.socksProxy&&(n=new YB.Agent(HM(this.client._proxyOpts.socksProxy),e.protocol==="wss:"))),this.socket=Ir[this.announceUrl]=new aB({url:this.announceUrl,agent:n}),this.socket.consumers=1,this.socket.once("connect",this._onSocketConnectBound)}this.socket.on("data",this._onSocketDataBound),this.socket.once("close",this._onSocketCloseBound),this.socket.once("error",this._onSocketErrorBound)}_onSocketConnect(){this.destroyed||this.reconnecting&&(this.reconnecting=!1,this.retries=0,this.announce(this.client._defaultAnnounceOpts()))}_onSocketData(e){if(!this.destroyed){this.expectingResponse=!1;try{e=JSON.parse(PM(e))}catch{this.client.emit("warning",new Error("Invalid tracker response"));return}e.action==="announce"?this._onAnnounceResponse(e):e.action==="scrape"?this._onScrapeResponse(e):this._onSocketError(new Error(`invalid action in WS response: ${e.action}`))}}_onAnnounceResponse(e){if(e.info_hash!==this.client._infoHashBinary){console.log("ignoring websocket data from %s for %s (looking for %s: reused socket)",this.announceUrl,Us(e.info_hash),this.client.infoHash);return}if(e.peer_id&&e.peer_id===this.client._peerIdBinary)return;console.log("received %s from %s for %s",JSON.stringify(e),this.announceUrl,this.client.infoHash);const n=e["failure reason"];if(n)return this.client.emit("warning",new Error(n));const r=e["warning message"];r&&this.client.emit("warning",new Error(r));const i=e.interval||e["min interval"];i&&this.setInterval(i*1e3);const s=e["tracker id"];if(s&&(this._trackerId=s),e.complete!=null){const l=Object.assign({},e,{announce:this.announceUrl,infoHash:Us(e.info_hash)});this.client.emit("update",l)}let o;if(e.offer&&e.peer_id&&(console.log("creating peer (from remote offer)"),o=this._createPeer(),o.id=Us(e.peer_id),o.once("signal",l=>{const a={action:"announce",info_hash:this.client._infoHashBinary,peer_id:this.client._peerIdBinary,to_peer_id:e.peer_id,answer:l,offer_id:e.offer_id};this._trackerId&&(a.trackerid=this._trackerId),this._send(a)}),this.client.emit("peer",o),o.signal(e.offer)),e.answer&&e.peer_id){const l=Us(e.offer_id);o=this.peers[l],o?(o.id=Us(e.peer_id),this.client.emit("peer",o),o.signal(e.answer),clearTimeout(o.trackerTimeout),o.trackerTimeout=null,delete this.peers[l]):console.log(`got unexpected answer: ${JSON.stringify(e.answer)}`)}}_onScrapeResponse(e){e=e.files||{};const n=Object.keys(e);if(n.length===0){this.client.emit("warning",new Error("invalid scrape response"));return}n.forEach(r=>{const i=Object.assign(e[r],{announce:this.announceUrl,infoHash:Us(r)});this.client.emit("scrape",i)})}_onSocketClose(){this.destroyed||(this.destroy(),this._startReconnectTimer())}_onSocketError(e){this.destroyed||(this.destroy(),this.client.emit("warning",e),this._startReconnectTimer())}_startReconnectTimer(){const e=Math.floor(Math.random()*XB)+Math.min(Math.pow(2,this.retries)*QB,ZB);this.reconnecting=!0,clearTimeout(this.reconnectTimer),this.reconnectTimer=setTimeout(()=>{this.retries++,this._openSocket()},e),this.reconnectTimer.unref&&this.reconnectTimer.unref(),console.log("reconnecting socket in %s ms",e)}_send(e){if(this.destroyed)return;this.expectingResponse=!0;const n=JSON.stringify(e);console.log("send %s",n),this.socket.send(n)}_generateOffers(e,n){const r=this,i=[];console.log("generating %s offers",e);for(let l=0;l<e;++l)s();o();function s(){const l=pm(Z_(20));console.log("creating peer (from _generateOffers)");const a=r.peers[l]=r._createPeer({initiator:!0});a.once("signal",u=>{i.push({offer:u,offer_id:Nl(l)}),o()}),a.trackerTimeout=setTimeout(()=>{console.log("tracker timeout: destroying peer"),a.trackerTimeout=null,delete r.peers[l],a.destroy()},eP),a.trackerTimeout.unref&&a.trackerTimeout.unref()}function o(){i.length===e&&(console.log("generated %s offers",e),n(i))}}_createPeer(e){const n=this;e=Object.assign({trickle:!1,config:n.client._rtcConfig,wrtc:n.client._wrtc},e);const r=new rB(e);return r.once("error",i),r.once("connect",s),r;function i(o){n.client.emit("warning",new Error(`Connection error: ${o.message}`)),r.destroy()}function s(){r.removeListener("error",i),r.removeListener("connect",s)}}}Fc.prototype.DEFAULT_ANNOUNCE_INTERVAL=30*1e3;Fc._socketPool=Ir;function nw(){}const jE=0,_m=1,HE=2,rP=(t,e)=>{ie(t,jE);const n=UI(e);Xe(t,n)},iP=(t,e,n)=>{ie(t,_m),Xe(t,BI(e,n))},sP=(t,e,n)=>iP(e,n,Ct(t)),$E=(t,e,n)=>{try{NI(e,Ct(t),n)}catch(r){console.error("Caught error while handling a Yjs update",r)}},oP=(t,e)=>{ie(t,HE),Xe(t,e)},lP=$E,aP=(t,e,n,r)=>{const i=le(t);switch(i){case jE:sP(t,e,n);break;case _m:$E(t,n,r);break;case HE:lP(t,n,r);break;default:throw new Error("Unknown message type")}return i},uP=0,cP=(t,e,n)=>{switch(le(t)){case uP:n(e,Ei(t))}},fP="elec-e7320-collab-tool-project",hP=["wss://tracker.webtorrent.dev"],Uc=0,dP=3,Cf=1,pP=2,Pa=[];Pa[Uc]=(t,e,n,r,i)=>{ie(t,Uc);const s=aP(e,t,n.doc,n);r&&s===_m&&!n.synced&&(n.synced=!0)};Pa[dP]=(t,e,n,r,i)=>{ie(t,Cf),Xe(t,um(n.awareness,Array.from(n.awareness.getStates().keys())))};Pa[Cf]=(t,e,n,r,i)=>{gA(n.awareness,Ct(e),n)};Pa[pP]=(t,e,n,r,i)=>{cP(e,n.doc,(s,o)=>gP(o))};const rw=3e4,gP=t=>console.warn(`Permission denied to access the document.
${t}`),mP=(t,e,n)=>{const r=Ui(e),i=mr(),s=le(r),o=t.messageHandlers[s];return o?o(i,r,t,n,s):console.error("Unable to compute message"),i},yP=t=>{t.shouldConnect&&t.p2pt!==null&&(t.connecting=!0,t.connected=!1,t.synced=!1,t.p2pt.on("trackerwarning",(e,n)=>{t.emit("connection-error",[e,t])}),t.p2pt.on("peerclose",e=>{t.remotePeers=t.remotePeers.filter(({id:r})=>e.id!=r),t.remotePeers.length===0&&(t.emit("connection-close",["connection-close",t]),t.connecting=!1,t.connected=!1,t.synced=!1,am(t.awareness,Array.from(t.awareness.getStates().keys()).filter(r=>r!==t.doc.clientID),t),t.emit("status",[{status:"disconnected"}]))}),t.p2pt.on("peerconnect",async e=>{e.on("data",r=>{if(!r){console.log(`received undefined message, skipping. Peer: ${e.id}`);return}t.lastMessageReceived=Ni();const i=mP(t,new Uint8Array(r),!0);Sv(i)>1&&t.sendToPeers(Ot(i))}),t.remotePeers.push(e),t.lastMessageReceived=Ni(),t.connecting=!1,t.connected=!0,t.emit("status",[{status:"connected"}]);const n=mr();if(ie(n,Uc),rP(n,t.doc),t.sendToPeers(Ot(n)),t.awareness.getLocalState()!==null){const r=mr();ie(r,Cf),Xe(r,um(t.awareness,[t.doc.clientID])),t.sendToPeers(Ot(r))}}),t.p2pt.on("trackerconnect",(e,n)=>{console.log(`Connected to tracker ${e?e.announceUrl:"null"}, connected: ${n?n.connected:"null"}, total: ${n?n.total:"null"}`)}),t.emit("status",[{status:"connecting"}]),t.p2pt.start())};class wP extends Og{constructor(e,n){super();const r=`${fP}/${e}`;this.p2pt=new tP(hP,r),this.roomname=e,this.doc=n,this.awareness=new pA(n),this.connected=!1,this.connecting=!1,this.messageHandlers=Pa.slice(),this.remotePeers=[],this._synced=!1,this.lastMessageReceived=0,this.shouldConnect=!0,this._updateHandler=(i,s)=>{if(s!==this){const o=mr();ie(o,Uc),oP(o,i),this.sendToPeers(Ot(o))}},this.doc.on("update",this._updateHandler),this._awarenessUpdateHandler=({added:i,updated:s,removed:o},l)=>{const a=i.concat(s).concat(o),u=mr();ie(u,Cf),Xe(u,um(this.awareness,a)),this.sendToPeers(Ot(u))},this._exitHandler=()=>{am(this.awareness,[n.clientID],"app closed")},Mi&&typeof process<"u"&&process.on("exit",this._exitHandler),this.awareness.on("update",this._awarenessUpdateHandler),this._checkInterval=setInterval(()=>{this.connected&&rw<Ni()-this.lastMessageReceived&&console.log("No awareness update is being received")},rw/10),this.connect()}sendToPeers(e){this.remotePeers.forEach(n=>n.send(e))}get synced(){return this._synced}set synced(e){this._synced!==e&&(this._synced=e,this.emit("synced",[e]),this.emit("sync",[e]))}destroy(){clearInterval(this._checkInterval),this.disconnect(),Mi&&typeof process<"u"&&process.off("exit",this._exitHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.doc.off("update",this._updateHandler),super.destroy()}disconnect(){this.shouldConnect=!1,this.p2pt.destroy()}connect(){this.shouldConnect=!0,console.log("is connected?",this.connected),this.connected||yP(this)}}function SP({channel:t,username:e}){const n=rs.useRef(null),r=new jo,i=new wP(t,r);i.awareness.setLocalStateField("user",{name:e});const s=r.getXmlFragment("prosemirror");return rs.useEffect(()=>{console.log(n.current);const o=n.current;new fA(o,{state:ro.create({schema:a1,plugins:[EA(s),FA(i.awareness),jA(),wp({"Mod-z":UA,"Mod-y":l1,"Mod-Shift-z":l1})].concat(NM({schema:a1}))})})},[]),Jt.jsx("div",{ref:n})}function vP({setCurrentUsername:t,setCurrentChannel:e,handleChannelJoin:n}){return Jt.jsxs("form",{onSubmit:n,children:[Jt.jsxs("label",{children:[" Username:",Jt.jsx("input",{type:"text",name:"usernameInput",id:"usernameInput",onChange:r=>t(r.target.value)})]}),Jt.jsxs("label",{children:[" Channel name:",Jt.jsx("input",{type:"text",name:"channelInput",id:"channelInput",onChange:r=>e(r.target.value)})]}),Jt.jsx("input",{type:"submit",value:"Join channel"})]})}function kP(){const[t,e]=rs.useState(""),[n,r]=rs.useState(""),[i,s]=rs.useState(!0),o=l=>{l.preventDefault(),s(!1)};return Jt.jsx(Jt.Fragment,{children:i?Jt.jsx(vP,{setCurrentUsername:e,setCurrentChannel:r,handleChannelJoin:o}):Jt.jsx(Jt.Fragment,{children:Jt.jsx(SP,{channel:n,username:t})})})}Kh.createRoot(document.getElementById("root")).render(Jt.jsx(kP,{}));
